Opal.modules.json=function(Opal){var self,$module=Opal.module,$klass=Opal.klass,$send=Opal.send,$Object=Opal.Object,$eqeqeq=Opal.eqeqeq,$defs=Opal.defs,$truthy=Opal.truthy,$def=Opal.def,$return_val=Opal.return_val,$nesting=[],nil=Opal.nil,$$$=Opal.$$$;return Opal.add_stubs("raise,new,push,[]=,[],create_id,json_create,const_get,attr_accessor,create_id=,===,parse,generate,from_object,merge,to_json,responds_to?,to_io,write,to_s,to_a,strftime"),function($base,$parent_nesting){var $a,self=$module($base,"JSON"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);$klass($nesting[0],$$("StandardError"),"JSONError"),$klass($nesting[0],$$("JSONError"),"ParserError");var $hasOwn=Opal.hasOwnProperty;function $parse(source){try{return JSON.parse(source)}catch(e){self.$raise($$$($$("JSON"),"ParserError"),e.message)}}function to_opal(value,options){var klass,arr,hash,i,ii,k;switch(typeof value){case"string":case"number":return value;case"boolean":return!!value;case"undefined":return nil;case"object":if(!value)return nil;if(value.$$is_array){for(arr=Opal.hash_get(options,"array_class").$new(),i=0,ii=value.length;i<ii;i++)arr.$push(to_opal(value[i],options));return arr}for(k in hash=Opal.hash_get(options,"object_class").$new(),value)$hasOwn.call(value,k)&&($a=[k,to_opal(value[k],options)],$send(hash,"[]=",$a));return Opal.hash_get(options,"parse")||(klass=hash["$[]"]($$("JSON").$create_id()))==nil?hash:$Object.$const_get(klass).$json_create(hash)}}(function(self,$parent_nesting){self.$attr_accessor("create_id")})(Opal.get_singleton_class(self)),self["$create_id="]("json_class"),$defs(self,"$[]",(function(value,options){return null==options&&(options=new Map),$eqeqeq($$("String"),value)?this.$parse(value,options):this.$generate(value,options)}),-2),$defs(self,"$parse",(function(source,options){return null==options&&(options=new Map),this.$from_object($parse(source),options.$merge(new Map([["parse",!0]])))}),-2),$defs(self,"$parse!",(function(source,options){return null==options&&(options=new Map),this.$parse(source,options)}),-2),$defs(self,"$load",(function(source,options){return null==options&&(options=new Map),this.$from_object($parse(source),options)}),-2),$defs(self,"$from_object",(function(js_object,options){return null==options&&(options=new Map),$truthy(options["$[]"]("object_class"))||options["$[]="]("object_class",$$("Hash")),$truthy(options["$[]"]("array_class"))||options["$[]="]("array_class",$$("Array")),to_opal(js_object,options)}),-2),$defs(self,"$generate",(function(obj,options){return null==options&&(options=new Map),obj.$to_json(options)}),-2),$defs(self,"$dump",(function(obj,io,limit){var string;return null==io&&(io=nil),null==limit&&(limit=nil),string=this.$generate(obj),$truthy(io)?($truthy(io["$responds_to?"]("to_io"))&&(io=io.$to_io()),io.$write(string),io):string}),-2)}($nesting[0],$nesting),self=$klass($nesting[0],null,"Object"),$def(self,"$to_json",(function(){return this.$to_s().$to_json()})),function($base){var self=$module($base,"Enumerable");$def(self,"$to_json",(function(){return this.$to_a().$to_json()}))}($nesting[0]),function($base,$super){var self=$klass($base,null,"Array");$def(self,"$to_json",(function(){for(var result=[],i=0,length=this.length;i<length;i++)result.push(this[i].$to_json());return"["+result.join(",")+"]"}))}($nesting[0]),function($base,$super){var self=$klass($base,null,"Boolean");$def(self,"$to_json",(function(){return 1==this?"true":"false"}))}($nesting[0]),function($base,$super){var self=$klass($base,null,"Hash");$def(self,"$to_json",(function(){var result=[];return Opal.hash_each(this,!1,(function(key,value){return result.push(key.$to_s().$to_json()+":"+value.$to_json()),[!1,!1]})),"{"+result.join(",")+"}"}))}($nesting[0]),function($base,$super){var self=$klass($base,null,"NilClass");$def(self,"$to_json",$return_val("null"))}($nesting[0]),function($base,$super){var self=$klass($base,null,"Numeric");$def(self,"$to_json",(function(){return this.toString()}))}($nesting[0]),function($base,$super){var self=$klass($base,null,"String");$def(self,"$to_json",(function(){return JSON.stringify(this)}))}($nesting[0]),function($base,$super){var self=$klass($base,null,"Time");$def(self,"$to_json",(function(){return this.$strftime("%FT%T%z").$to_json()}))}($nesting[0]),function($base,$super){var self=$klass($base,null,"Date");return $def(self,"$to_json",(function(){return this.$to_s().$to_json()})),$def(self,"$as_json",(function(){return this.$to_s()}))}($nesting[0])};
