Opal.modules.thread=function(Opal){var $klass=Opal.klass,$truthy=Opal.truthy,$defs=Opal.defs,$slice=Opal.slice,$def=Opal.def,$send=Opal.send,$hash2=Opal.hash2,$Opal=Opal.Opal,$alias=Opal.alias,$return_ivar=Opal.return_ivar,$const_set=Opal.const_set,$assign_ivar_val=Opal.assign_ivar_val,$nesting=[],$$=Opal.$r($nesting),nil=Opal.nil,$$$=Opal.$$$;return Opal.add_stubs("allocate,core_initialize!,current,raise,[],coerce_key_name,[]=,key?,keys,private,coerce_to!,clear,empty?,size,shift,push,each,to_proc,pop,=~,last_match,to_i,inspect,attr_reader,path,locked?,lock,unlock"),$klass($nesting[0],$$("StandardError"),"ThreadError"),function($base,$super,$parent_nesting){var self=$klass($base,null,"Thread"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting),$proto=self.$$prototype;$proto.fiber_locals=$proto.thread_locals=nil,$defs(self,"$current",(function(){return null==this.current&&(this.current=nil),$truthy(this.current)||(this.current=this.$allocate(),this.current["$core_initialize!"]()),this.current})),$defs(self,"$list",(function(){return[this.$current()]})),$def(self,"$initialize",(function($a){var self=this;return $slice(arguments),self.$raise($$("NotImplementedError"),"Thread creation not available")}),-1),$def(self,"$[]",(function(key){return this.fiber_locals["$[]"](this.$coerce_key_name(key))})),$def(self,"$[]=",(function(key,value){var $a;return $a=[this.$coerce_key_name(key),value],$send(this.fiber_locals,"[]=",$a),$a[$a.length-1]})),$def(self,"$key?",(function(key){return this.fiber_locals["$key?"](this.$coerce_key_name(key))})),$def(self,"$keys",(function(){return this.fiber_locals.$keys()})),$def(self,"$thread_variable_get",(function(key){return this.thread_locals["$[]"](this.$coerce_key_name(key))})),$def(self,"$thread_variable_set",(function(key,value){var $a;return $a=[this.$coerce_key_name(key),value],$send(this.thread_locals,"[]=",$a),$a[$a.length-1]})),$def(self,"$thread_variable?",(function(key){return this.thread_locals["$key?"](this.$coerce_key_name(key))})),$def(self,"$thread_variables",(function(){return this.thread_locals.$keys()})),self.$private(),$def(self,"$core_initialize!",(function(){return this.thread_locals=$hash2([],{}),this.fiber_locals=$hash2([],{})})),$def(self,"$coerce_key_name",(function(key){return $Opal["$coerce_to!"](key,$$("String"),"to_s")})),function($base,$super,$parent_nesting){var self=$klass($base,null,"Queue"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);self.$$prototype.storage=nil,$def(self,"$initialize",(function(){return this.$clear()})),$def(self,"$clear",(function(){return this.storage=[]})),$def(self,"$empty?",(function(){return this.storage["$empty?"]()})),$def(self,"$size",(function(){return this.storage.$size()})),$def(self,"$pop",(function(non_block){return null==non_block&&(non_block=!1),$truthy(this["$empty?"]())&&($truthy(non_block)&&this.$raise($$("ThreadError"),"Queue empty"),this.$raise($$("ThreadError"),"Deadlock")),this.storage.$shift()}),-1),$def(self,"$push",(function(value){return this.storage.$push(value)})),$def(self,"$each",(function $$each(){var block=$$each.$$p||nil;return $$each.$$p=null,$send(this.storage,"each",[],block.$to_proc())})),$alias(self,"<<","push"),$alias(self,"deq","pop"),$alias(self,"enq","push"),$alias(self,"length","size"),$alias(self,"shift","pop")}($nesting[0],0,$nesting),function($base,$super,$parent_nesting){var $nesting=[$klass($base,null,"Backtrace")].concat($parent_nesting);(function($base,$super,$parent_nesting){var self=$klass($base,null,"Location"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting),$proto=self.$$prototype;$proto.label=$proto.str=nil,$def(self,"$initialize",(function(str){var $ret_or_1;return this.str=str,str["$=~"](/^(.*?):(\d+):(\d+):in `(.*?)'$/),this.path=$$("Regexp").$last_match(1),this.label=$$("Regexp").$last_match(4),this.lineno=$$("Regexp").$last_match(2).$to_i(),this.label["$=~"](/(\w+)$/),this.base_label=$truthy($ret_or_1=$$("Regexp").$last_match(1))?$ret_or_1:this.label})),$def(self,"$to_s",$return_ivar("str")),$def(self,"$inspect",(function(){return this.str.$inspect()})),self.$attr_reader("base_label","label","lineno","path"),$alias(self,"absolute_path","path")})($nesting[0],0,$nesting)}($nesting[0],0,$nesting)}($nesting[0],0,$nesting),$const_set($nesting[0],"Queue",$$$($$("Thread"),"Queue")),function($base,$super,$parent_nesting){var self=$klass($base,null,"Mutex"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);return self.$$prototype.locked=nil,$def(self,"$initialize",$assign_ivar_val("locked",!1)),$def(self,"$lock",(function(){return $truthy(this.locked)&&this.$raise($$("ThreadError"),"Deadlock"),this.locked=!0,this})),$def(self,"$locked?",$return_ivar("locked")),$def(self,"$owned?",$return_ivar("locked")),$def(self,"$try_lock",(function(){return!$truthy(this["$locked?"]())&&(this.$lock(),!0)})),$def(self,"$unlock",(function(){return $truthy(this.locked)||this.$raise($$("ThreadError"),"Mutex not locked"),this.locked=!1,this})),$def(self,"$synchronize",(function $$synchronize(){var $yield=$$synchronize.$$p||nil,self=this;return $$synchronize.$$p=null,self.$lock(),function(){try{return Opal.yieldX($yield,[])}finally{self.$unlock()}}()}))}($nesting[0],0,$nesting)},Opal.modules.stringio=function(Opal){var $klass=Opal.klass,$defs=Opal.defs,$send2=Opal.send2,$find_super=Opal.find_super,$def=Opal.def,$eqeqeq=Opal.eqeqeq,$truthy=Opal.truthy,$rb_ge=Opal.rb_ge,$rb_gt=Opal.rb_gt,$rb_plus=Opal.rb_plus,$rb_minus=Opal.rb_minus,$return_ivar=Opal.return_ivar,$eqeq=Opal.eqeq,$alias=Opal.alias,$nesting=[],$$=Opal.$r($nesting),nil=Opal.nil,$$$=Opal.$$$;return Opal.add_stubs("new,call,close,attr_accessor,check_readable,==,length,===,>=,raise,>,+,-,seek,check_writable,String,[],eof?,write,read,tell"),function($base,$super,$parent_nesting){var self=$klass($base,$super,"StringIO"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting),$proto=self.$$prototype;return $proto.position=$proto.string=nil,$defs(self,"$open",(function $$open(string,mode){var res,block=$$open.$$p||nil,io=nil;return $$open.$$p=null,null==string&&(string=""),null==mode&&(mode=nil),io=this.$new(string,mode),res=block.$call(io),io.$close(),res}),-1),self.$attr_accessor("string"),$def(self,"$initialize",(function $$initialize(string,mode){return $$initialize.$$p=null,null==string&&(string=""),null==mode&&(mode="rw"),this.string=string,this.position=0,$send2(this,$find_super(this,"initialize",$$initialize,!1,!0),"initialize",[nil,mode],null)}),-1),$def(self,"$eof?",(function(){return this.$check_readable(),this.position["$=="](this.string.$length())})),$def(self,"$seek",(function(pos,whence){var $ret_or_1;return null==whence&&(whence=$$$($$("IO"),"SEEK_SET")),this.read_buffer="",$eqeqeq($$$($$("IO"),"SEEK_SET"),$ret_or_1=whence)?($truthy($rb_ge(pos,0))||this.$raise($$$($$("Errno"),"EINVAL")),this.position=pos):$eqeqeq($$$($$("IO"),"SEEK_CUR"),$ret_or_1)?$truthy($rb_gt($rb_plus(this.position,pos),this.string.$length()))?this.position=this.string.$length():this.position=$rb_plus(this.position,pos):$eqeqeq($$$($$("IO"),"SEEK_END"),$ret_or_1)&&($truthy($rb_gt(pos,this.string.$length()))?this.position=0:this.position=$rb_minus(this.position,pos)),0}),-2),$def(self,"$tell",$return_ivar("position")),$def(self,"$rewind",(function(){return this.$seek(0)})),$def(self,"$write",(function(string){var before=nil,after=nil;return this.$check_writable(),this.read_buffer="",string=this.$String(string),$eqeq(this.string.$length(),this.position)?(this.string=$rb_plus(this.string,string),this.position=$rb_plus(this.position,string.$length())):(before=this.string["$[]"](Opal.Range.$new(0,$rb_minus(this.position,1),!1)),after=this.string["$[]"](Opal.Range.$new($rb_plus(this.position,string.$length()),-1,!1)),this.string=$rb_plus($rb_plus(before,string),after),this.position=$rb_plus(this.position,string.$length()))})),$def(self,"$read",(function(length,outbuf){var string,str=nil;return null==length&&(length=nil),null==outbuf&&(outbuf=nil),this.$check_readable(),$truthy(this["$eof?"]())?nil:(string=$truthy(length)?(str=this.string["$[]"](this.position,length),this.position=$rb_plus(this.position,length),$truthy($rb_gt(this.position,this.string.$length()))&&(this.position=this.string.$length()),str):(str=this.string["$[]"](Opal.Range.$new(this.position,-1,!1)),this.position=this.string.$length(),str),$truthy(outbuf)?outbuf.$write(string):string)}),-1),$def(self,"$sysread",(function(length){return this.$check_readable(),this.$read(length)})),$alias(self,"eof","eof?"),$alias(self,"pos","tell"),$alias(self,"pos=","seek"),$alias(self,"readpartial","read")}($nesting[0],$$("IO"),$nesting)},Opal.modules.prettyprint=function(Opal){var $klass=Opal.klass,$send=Opal.send,$rb_times=Opal.rb_times,$defs=Opal.defs,$truthy=Opal.truthy,$def=Opal.def,$rb_lt=Opal.rb_lt,$rb_plus=Opal.rb_plus,$rb_minus=Opal.rb_minus,$eqeqeq=Opal.eqeqeq,$assign_ivar_val=Opal.assign_ivar_val,$return_ivar=Opal.return_ivar,$slice=Opal.slice,$thrower=Opal.thrower,$return_val=Opal.return_val,$nesting=[],nil=Opal.nil;return Opal.add_stubs("dup,lambda,*,new,to_proc,flush,attr_reader,last,<,+,deq,empty?,breakables,shift,output,-,width,!,===,first,length,<<,add,break_outmost_groups,group,breakable,break?,call,text,group_sub,nest,depth,push,enq,pop,delete,each,clear,indent,current_group,newline,genspace,group_queue,[],downto,slice!,break,[]="),function($base,$super,$parent_nesting){var self=$klass($base,null,"PrettyPrint"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting),$proto=self.$$prototype;return $proto.group_stack=$proto.maxwidth=$proto.output_width=$proto.buffer_width=$proto.group_queue=$proto.buffer=$proto.output=$proto.newline=$proto.genspace=$proto.indent=nil,$defs($$("PrettyPrint"),"$format",(function $$format(output,maxwidth,newline,genspace){var $yield=$$format.$$p||nil,q=nil;return $$format.$$p=null,null==output&&(output="".$dup()),null==maxwidth&&(maxwidth=79),null==newline&&(newline="\n"),null==genspace&&(genspace=$send(this,"lambda",[],(function(n){return null==n&&(n=nil),$rb_times(" ",n)}))),q=$send($$("PrettyPrint"),"new",[output,maxwidth,newline],genspace.$to_proc()),Opal.yield1($yield,q),q.$flush(),output}),-1),$defs($$("PrettyPrint"),"$singleline_format",(function $$singleline_format(output,maxwidth,newline,genspace){var q,$yield=$$singleline_format.$$p||nil;return $$singleline_format.$$p=null,null==output&&(output="".$dup()),null==maxwidth&&(maxwidth=nil),null==newline&&(newline=nil),null==genspace&&(genspace=nil),q=$$("SingleLine").$new(output),Opal.yield1($yield,q),output}),-1),$def(self,"$initialize",(function $$initialize(output,maxwidth,newline){var $ret_or_1,root_group,genspace=$$initialize.$$p||nil;return $$initialize.$$p=null,null==output&&(output="".$dup()),null==maxwidth&&(maxwidth=79),null==newline&&(newline="\n"),this.output=output,this.maxwidth=maxwidth,this.newline=newline,this.genspace=$truthy($ret_or_1=genspace)?$ret_or_1:$send(this,"lambda",[],(function(n){return null==n&&(n=nil),$rb_times(" ",n)})),this.output_width=0,this.buffer_width=0,this.buffer=[],root_group=$$("Group").$new(0),this.group_stack=[root_group],this.group_queue=$$("GroupQueue").$new(root_group),this.indent=0}),-1),self.$attr_reader("output"),self.$attr_reader("maxwidth"),self.$attr_reader("newline"),self.$attr_reader("genspace"),self.$attr_reader("indent"),self.$attr_reader("group_queue"),$def(self,"$current_group",(function(){return this.group_stack.$last()})),$def(self,"$break_outmost_groups",(function(){for(var group=nil,data=nil,$ret_or_1=nil,text=nil;$truthy($rb_lt(this.maxwidth,$rb_plus(this.output_width,this.buffer_width)));){if(!$truthy(group=this.group_queue.$deq()))return nil;for(;!$truthy(group.$breakables()["$empty?"]());)data=this.buffer.$shift(),this.output_width=data.$output(this.output,this.output_width),this.buffer_width=$rb_minus(this.buffer_width,data.$width());for(;$truthy($truthy($ret_or_1=this.buffer["$empty?"]()["$!"]())?$$("Text")["$==="](this.buffer.$first()):$ret_or_1);)text=this.buffer.$shift(),this.output_width=text.$output(this.output,this.output_width),this.buffer_width=$rb_minus(this.buffer_width,text.$width())}})),$def(self,"$text",(function(obj,width){var text=nil;return null==width&&(width=obj.$length()),$truthy(this.buffer["$empty?"]())?(this.output["$<<"](obj),this.output_width=$rb_plus(this.output_width,width)):(text=this.buffer.$last(),$eqeqeq($$("Text"),text)||(text=$$("Text").$new(),this.buffer["$<<"](text)),text.$add(obj,width),this.buffer_width=$rb_plus(this.buffer_width,width),this.$break_outmost_groups())}),-2),$def(self,"$fill_breakable",(function(sep,width){return null==sep&&(sep=" "),null==width&&(width=sep.$length()),$send(this,"group",[],(function $$3(){return(null==$$3.$$s?this:$$3.$$s).$breakable(sep,width)}),{$$s:this})}),-1),$def(self,"$breakable",(function(sep,width){var group=nil;return null==sep&&(sep=" "),null==width&&(width=sep.$length()),group=this.group_stack.$last(),$truthy(group["$break?"]())?(this.$flush(),this.output["$<<"](this.newline),this.output["$<<"](this.genspace.$call(this.indent)),this.output_width=this.indent,this.buffer_width=0):(this.buffer["$<<"]($$("Breakable").$new(sep,width,this)),this.buffer_width=$rb_plus(this.buffer_width,width),this.$break_outmost_groups())}),-1),$def(self,"$group",(function $$group(indent,open_obj,close_obj,open_width,close_width){var $yield=$$group.$$p||nil;return $$group.$$p=null,null==indent&&(indent=0),null==open_obj&&(open_obj=""),null==close_obj&&(close_obj=""),null==open_width&&(open_width=open_obj.$length()),null==close_width&&(close_width=close_obj.$length()),this.$text(open_obj,open_width),$send(this,"group_sub",[],(function $$4(){return $send(null==$$4.$$s?this:$$4.$$s,"nest",[indent],(function(){return Opal.yieldX($yield,[])}))}),{$$s:this}),this.$text(close_obj,close_width)}),-1),$def(self,"$group_sub",(function $$group_sub(){var $yield=$$group_sub.$$p||nil,self=this,group=nil;return $$group_sub.$$p=null,group=$$("Group").$new($rb_plus(self.group_stack.$last().$depth(),1)),self.group_stack.$push(group),self.group_queue.$enq(group),function(){try{return Opal.yieldX($yield,[])}finally{self.group_stack.$pop(),$truthy(group.$breakables()["$empty?"]())&&self.group_queue.$delete(group)}}()})),$def(self,"$nest",(function $$nest(indent){var $yield=$$nest.$$p||nil,self=this;return $$nest.$$p=null,self.indent=$rb_plus(self.indent,indent),function(){try{return Opal.yieldX($yield,[])}finally{self.indent=$rb_minus(self.indent,indent)}}()})),$def(self,"$flush",(function(){return $send(this.buffer,"each",[],(function $$6(data){var self=null==$$6.$$s?this:$$6.$$s;return null==self.output&&(self.output=nil),null==self.output_width&&(self.output_width=nil),null==data&&(data=nil),self.output_width=data.$output(self.output,self.output_width)}),{$$s:this}),this.buffer.$clear(),this.buffer_width=0})),function($base,$super){var self=$klass($base,null,"Text"),$proto=self.$$prototype;$proto.objs=$proto.width=nil,$def(self,"$initialize",(function(){return this.objs=[],this.width=0})),self.$attr_reader("width"),$def(self,"$output",(function(out,output_width){return $send(this.objs,"each",[],(function(obj){return null==obj&&(obj=nil),out["$<<"](obj)})),$rb_plus(output_width,this.width)})),$def(self,"$add",(function(obj,width){return this.objs["$<<"](obj),this.width=$rb_plus(this.width,width)}))}($nesting[0]),function($base,$super){var self=$klass($base,null,"Breakable"),$proto=self.$$prototype;$proto.group=$proto.pp=$proto.indent=$proto.obj=$proto.width=nil,$def(self,"$initialize",(function(sep,width,q){return this.obj=sep,this.width=width,this.pp=q,this.indent=q.$indent(),this.group=q.$current_group(),this.group.$breakables().$push(this)})),self.$attr_reader("obj"),self.$attr_reader("width"),self.$attr_reader("indent"),$def(self,"$output",(function(out,output_width){return this.group.$breakables().$shift(),$truthy(this.group["$break?"]())?(out["$<<"](this.pp.$newline()),out["$<<"](this.pp.$genspace().$call(this.indent)),this.indent):($truthy(this.group.$breakables()["$empty?"]())&&this.pp.$group_queue().$delete(this.group),out["$<<"](this.obj),$rb_plus(output_width,this.width))}))}($nesting[0]),function($base,$super){var self=$klass($base,null,"Group");$def(self,"$initialize",(function(depth){return this.depth=depth,this.breakables=[],this.break=!1})),self.$attr_reader("depth"),self.$attr_reader("breakables"),$def(self,"$break",$assign_ivar_val("break",!0)),$def(self,"$break?",$return_ivar("break")),$def(self,"$first?",(function(){var $a;return!$truthy(($a=this.first,null!=$a&&$a!==nil?"instance-variable":nil))&&(this.first=!1,!0)}))}($nesting[0]),function($base,$super){var self=$klass($base,null,"GroupQueue");self.$$prototype.queue=nil,$def(self,"$initialize",(function($a){var groups,self=this;return groups=$slice(arguments),self.queue=[],$send(groups,"each",[],(function $$9(g){return null==g&&(g=nil),(null==$$9.$$s?this:$$9.$$s).$enq(g)}),{$$s:self})}),-1),$def(self,"$enq",(function(group){var depth;for(depth=group.$depth();!$truthy($rb_lt(depth,this.queue.$length()));)this.queue["$<<"]([]);return this.queue["$[]"](depth)["$<<"](group)})),$def(self,"$deq",(function(){try{var $t_return=$thrower("return");return $send(this.queue,"each",[],(function(gs){return null==gs&&(gs=nil),$send($rb_minus(gs.$length(),1),"downto",[0],(function(i){var group=nil;if(null==i&&(i=nil),$truthy(gs["$[]"](i).$breakables()["$empty?"]()))return nil;(group=gs["$slice!"](i,1).$first()).$break(),$t_return.$throw(group)}),{$$ret:$t_return}),$send(gs,"each",[],(function(group){return null==group&&(group=nil),group.$break()})),gs.$clear()})),nil}catch($e){if($e===$t_return)return $e.$v;throw $e}})),$def(self,"$delete",(function(group){return this.queue["$[]"](group.$depth()).$delete(group)}))}($nesting[0]),function($base,$super){var self=$klass($base,null,"SingleLine"),$proto=self.$$prototype;return $proto.output=$proto.first=nil,$def(self,"$initialize",(function(output,maxwidth,newline){return null==maxwidth&&(maxwidth=nil),null==newline&&(newline=nil),this.output=output,this.first=[!0]}),-2),$def(self,"$text",(function(obj,width){return null==width&&(width=nil),this.output["$<<"](obj)}),-2),$def(self,"$breakable",(function(sep,width){return null==sep&&(sep=" "),null==width&&(width=nil),this.output["$<<"](sep)}),-1),$def(self,"$nest",(function $$nest(indent){var $yield=$$nest.$$p||nil;return $$nest.$$p=null,Opal.yieldX($yield,[])})),$def(self,"$group",(function $$group(indent,open_obj,close_obj,open_width,close_width){var $yield=$$group.$$p||nil;return $$group.$$p=null,null==indent&&(indent=nil),null==open_obj&&(open_obj=""),null==close_obj&&(close_obj=""),null==open_width&&(open_width=nil),null==close_width&&(close_width=nil),this.first.$push(!0),this.output["$<<"](open_obj),Opal.yieldX($yield,[]),this.output["$<<"](close_obj),this.first.$pop()}),-1),$def(self,"$flush",$return_val(nil)),$def(self,"$first?",(function(){var result;return result=this.first["$[]"](-1),this.first["$[]="](-1,!1),result}))}($nesting[0])}($nesting[0],0,$nesting)},Opal.modules.pp=function(Opal){var $klass=Opal.klass,$gvars=Opal.gvars,$send=Opal.send,$defs=Opal.defs,$slice=Opal.slice,$to_a=Opal.to_a,$module=Opal.module,$eqeq=Opal.eqeq,$hash2=Opal.hash2,$def=Opal.def,$truthy=Opal.truthy,$rb_plus=Opal.rb_plus,$eqeqeq=Opal.eqeqeq,$neqeq=Opal.neqeq,$not=Opal.not,$rb_gt=Opal.rb_gt,$rb_le=Opal.rb_le,self=Opal.top,$nesting=[],$$=Opal.$r($nesting),nil=Opal.nil,$$$=Opal.$$$;return Opal.add_stubs("require,new,guard_inspect_key,pp,flush,<<,bind_call,instance_method,to_proc,attr_accessor,==,[],current,[]=,compare_by_identity,include?,delete,text,is_a?,__getobj__,check_inspect_key,group,pretty_print_cycle,push_inspect_key,pretty_print,sharing_detection,pop_inspect_key,+,name,class,chomp,breakable,lambda,comma_breakable,__send__,call,object_address_group,seplist,pretty_print_instance_variables,===,to_s,instance_eval,include,!=,owner,inspect,respond_to?,!,pp_object,sort,instance_variables,raise,singleline_pp,dup,empty?,pp_hash,each,keys,sprintf,mcall,begin,exclude_end?,end,lines,>,size,named_captures,regexp,object_group,class_eval,string,<=,first,module_function"),self.$require("thread"),self.$require("stringio"),self.$require("prettyprint"),function($base,$super,$parent_nesting){var self=$klass($base,$super,"PP"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);$defs($$("PP"),"$pp",(function(obj,out,width){var q=nil;return null==$gvars.stdout&&($gvars.stdout=nil),null==out&&(out=$gvars.stdout),null==width&&(width=79),q=$$("PP").$new(out,width),$send(q,"guard_inspect_key",[],(function(){return q.$pp(obj)})),q.$flush(),out["$<<"]("\n")}),-2),$defs($$("PP"),"$singleline_pp",(function(obj,out){var q=nil;return null==$gvars.stdout&&($gvars.stdout=nil),null==out&&(out=$gvars.stdout),q=$$("SingleLine").$new(out),$send(q,"guard_inspect_key",[],(function(){return q.$pp(obj)})),q.$flush(),out}),-2),$defs($$("PP"),"$mcall",(function $$mcall(obj,mod,meth,$a){var args,block=$$mcall.$$p||nil;return $$mcall.$$p=null,args=$slice(arguments,3),$send(mod.$instance_method(meth),"bind_call",[obj].concat($to_a(args)),block.$to_proc())}),-4),self.sharing_detection=!1,function(self,$parent_nesting){self.$attr_accessor("sharing_detection")}(Opal.get_singleton_class(self)),function($base,$parent_nesting){var self=$module($base,"PPMethods"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);$def(self,"$guard_inspect_key",(function $$guard_inspect_key(){var $a,save,$yield=$$guard_inspect_key.$$p||nil;return $$guard_inspect_key.$$p=null,$eqeq($$("Thread").$current()["$[]"]("__recursive_key__"),nil)&&$$("Thread").$current()["$[]="]("__recursive_key__",$hash2([],{}).$compare_by_identity()),$eqeq($$("Thread").$current()["$[]"]("__recursive_key__")["$[]"]("inspect"),nil)&&$$("Thread").$current()["$[]"]("__recursive_key__")["$[]="]("inspect",$hash2([],{}).$compare_by_identity()),save=$$("Thread").$current()["$[]"]("__recursive_key__")["$[]"]("inspect"),function(){try{return $$("Thread").$current()["$[]"]("__recursive_key__")["$[]="]("inspect",$hash2([],{}).$compare_by_identity()),Opal.yieldX($yield,[])}finally{$a=["inspect",save],$send($$("Thread").$current()["$[]"]("__recursive_key__"),"[]=",$a)}}()})),$def(self,"$check_inspect_key",(function(id){var $ret_or_1,$ret_or_2;return $truthy($ret_or_1=$truthy($ret_or_2=$$("Thread").$current()["$[]"]("__recursive_key__"))?$$("Thread").$current()["$[]"]("__recursive_key__")["$[]"]("inspect"):$ret_or_2)?$$("Thread").$current()["$[]"]("__recursive_key__")["$[]"]("inspect")["$include?"](id):$ret_or_1})),$def(self,"$push_inspect_key",(function(id){var $a;return $a=[id,!0],$send($$("Thread").$current()["$[]"]("__recursive_key__")["$[]"]("inspect"),"[]=",$a),$a[$a.length-1]})),$def(self,"$pop_inspect_key",(function(id){return $$("Thread").$current()["$[]"]("__recursive_key__")["$[]"]("inspect").$delete(id)})),$def(self,"$pp",(function(obj){var self=this;return null===obj?(self.$text("null"),nil):void 0===obj?(self.$text("undefined"),nil):void 0===obj.$$class?(self.$text(Object.prototype.toString.apply(obj)),nil):($truthy($$$("::","Delegator","skip_raise")?"constant":nil)&&$truthy(obj["$is_a?"]($$$("Delegator")))&&(obj=obj.$__getobj__()),$truthy(self.$check_inspect_key(obj))?($send(self,"group",[],(function $$3(){var self=null==$$3.$$s?this:$$3.$$s;return obj.$pretty_print_cycle(self)}),{$$s:self}),nil):function(){try{return self.$push_inspect_key(obj),$send(self,"group",[],(function $$4(){var self=null==$$4.$$s?this:$$4.$$s;return obj.$pretty_print(self)}),{$$s:self})}finally{$truthy($$("PP").$sharing_detection())||self.$pop_inspect_key(obj)}}())}),-1),$def(self,"$object_group",(function $$object_group(obj){var block=$$object_group.$$p||nil;return $$object_group.$$p=null,$send(this,"group",[1,$rb_plus("#<",obj.$class().$name()),">"],block.$to_proc())})),$def(self,"$object_address_group",(function $$object_address_group(obj){var block=$$object_address_group.$$p||nil,str=nil;return $$object_address_group.$$p=null,str=(str=$$("Kernel").$instance_method("to_s").$bind_call(obj)).$chomp(">"),$send(this,"group",[1,str,">"],block.$to_proc())})),$def(self,"$comma_breakable",(function(){return this.$text(","),this.$breakable()})),$def(self,"$seplist",(function $$seplist(list,sep,iter_method){var $ret_or_1,$yield=$$seplist.$$p||nil,first=nil;return $$seplist.$$p=null,null==sep&&(sep=nil),null==iter_method&&(iter_method="each"),sep=$truthy($ret_or_1=sep)?$ret_or_1:$send(this,"lambda",[],(function $$5(){return(null==$$5.$$s?this:$$5.$$s).$comma_breakable()}),{$$s:this}),first=!0,$send(list,"__send__",[iter_method],(function($a){var v;return v=$slice(arguments),$truthy(first)?first=!1:sep.$call(),Opal.yieldX($yield,$to_a(v))}),-1)}),-2),$def(self,"$pp_object",(function(obj){return $send(this,"object_address_group",[obj],(function $$7(){var self=null==$$7.$$s?this:$$7.$$s;return $send(self,"seplist",[obj.$pretty_print_instance_variables(),$send(self,"lambda",[],(function $$8(){return(null==$$8.$$s?this:$$8.$$s).$text(",")}),{$$s:self})],(function $$9(v){var self=null==$$9.$$s?this:$$9.$$s;return null==v&&(v=nil),self.$breakable(),$eqeqeq($$("Symbol"),v)&&(v=v.$to_s()),self.$text(v),self.$text("="),$send(self,"group",[1],(function $$10(){var self=null==$$10.$$s?this:$$10.$$s;return self.$breakable(""),self.$pp(obj.$instance_eval(v))}),{$$s:self})}),{$$s:self})}),{$$s:this})})),$def(self,"$pp_hash",(function(obj){return $send(this,"group",[1,"{","}"],(function $$11(){var self=null==$$11.$$s?this:$$11.$$s;return $send(self,"seplist",[obj,nil,"each_pair"],(function $$12(k,v){var self=null==$$12.$$s?this:$$12.$$s;return null==k&&(k=nil),null==v&&(v=nil),$send(self,"group",[],(function $$13(){var self=null==$$13.$$s?this:$$13.$$s;return self.$pp(k),self.$text("=>"),$send(self,"group",[1],(function $$14(){var self=null==$$14.$$s?this:$$14.$$s;return self.$breakable(""),self.$pp(v)}),{$$s:self})}),{$$s:self})}),{$$s:self})}),{$$s:this})}))}($nesting[0],$nesting),self.$include($$("PPMethods")),function($base,$super,$parent_nesting){var self=$klass($base,$super,"SingleLine"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);self.$include($$("PPMethods"))}($nesting[0],$$$($$("PrettyPrint"),"SingleLine"),$nesting),function($base,$parent_nesting){var self=$module($base,"ObjectMixin"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);$def(self,"$pretty_print",(function(q){var umethod_method=nil,inspect_method=nil;umethod_method=$$("Object").$instance_method("method");try{inspect_method=umethod_method.$bind_call(this,"inspect")}catch($err){if(!Opal.rescue($err,[$$("NameError")]))throw $err;Opal.pop_exception()}return $truthy(inspect_method)&&$neqeq(inspect_method.$owner(),$$("Kernel"))||$not(inspect_method)&&$truthy(this["$respond_to?"]("inspect"))?q.$text(this.$inspect()):q.$pp_object(this)})),$def(self,"$pretty_print_cycle",(function(q){return $send(q,"object_address_group",[this],(function(){return q.$breakable(),q.$text("...")}))})),$def(self,"$pretty_print_instance_variables",(function(){return this.$instance_variables().$sort()})),$def(self,"$pretty_print_inspect",(function(){return $eqeq($$("Object").$instance_method("method").$bind_call(this,"pretty_print").$owner(),$$$($$("PP"),"ObjectMixin"))&&this.$raise("pretty_print is not overridden for "+this.$class()),$$("PP").$singleline_pp(this,"".$dup())}))}($nesting[0],$nesting)}($nesting[0],$$("PrettyPrint"),$nesting),function($base,$super){var self=$klass($base,null,"Array");$def(self,"$pretty_print",(function(q){return $send(q,"group",[1,"[","]"],(function $$16(){return $send(q,"seplist",[null==$$16.$$s?this:$$16.$$s],(function(v){return null==v&&(v=nil),q.$pp(v)}))}),{$$s:this})})),$def(self,"$pretty_print_cycle",(function(q){return q.$text($truthy(this["$empty?"]())?"[]":"[...]")}))}($nesting[0]),function($base,$super){var self=$klass($base,null,"Hash");$def(self,"$pretty_print",(function(q){return q.$pp_hash(this)})),$def(self,"$pretty_print_cycle",(function(q){return q.$text($truthy(this["$empty?"]())?"{}":"{...}")}))}($nesting[0]),function(self,$parent_nesting){var $nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);$def(self,"$pretty_print",(function(q){var h;return h=$hash2([],{}),$send($$("ENV").$keys().$sort(),"each",[],(function(k){var $a;return null==k&&(k=nil),$a=[k,$$("ENV")["$[]"](k)],$send(h,"[]=",$a),$a[$a.length-1]})),q.$pp_hash(h)}))}(Opal.get_singleton_class($$("ENV")),$nesting),function($base,$super,$parent_nesting){var self=$klass($base,null,"Struct"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);$def(self,"$pretty_print",(function(q){return $send(q,"group",[1,this.$sprintf("#<struct %s",$$("PP").$mcall(this,$$("Kernel"),"class").$name()),">"],(function $$19(){var self=null==$$19.$$s?this:$$19.$$s;return $send(q,"seplist",[$$("PP").$mcall(self,$$("Struct"),"members"),$send(self,"lambda",[],(function(){return q.$text(",")}))],(function $$21(member){var self=null==$$21.$$s?this:$$21.$$s;return null==member&&(member=nil),q.$breakable(),q.$text(member.$to_s()),q.$text("="),$send(q,"group",[1],(function $$22(){var self=null==$$22.$$s?this:$$22.$$s;return q.$breakable(""),q.$pp(self["$[]"](member))}),{$$s:self})}),{$$s:self})}),{$$s:this})})),$def(self,"$pretty_print_cycle",(function(q){return q.$text(this.$sprintf("#<struct %s:...>",$$("PP").$mcall(this,$$("Kernel"),"class").$name()))}))}($nesting[0],0,$nesting),function($base,$super){var self=$klass($base,null,"Range");$def(self,"$pretty_print",(function(q){return q.$pp(this.$begin()),q.$breakable(""),q.$text($truthy(this["$exclude_end?"]())?"...":".."),q.$breakable(""),$truthy(this.$end())?q.$pp(this.$end()):nil}))}($nesting[0]),function($base,$super){var self=$klass($base,null,"String");$def(self,"$pretty_print",(function(q){var lines=nil;return lines=this.$lines(),$truthy($rb_gt(lines.$size(),1))?$send(q,"group",[0,"",""],(function $$23(){return $send(q,"seplist",[lines,$send(null==$$23.$$s?this:$$23.$$s,"lambda",[],(function(){return q.$text(" +"),q.$breakable()}))],(function(v){return null==v&&(v=nil),q.$pp(v)}))}),{$$s:this}):q.$text(this.$inspect())}))}($nesting[0]),function($base,$super){var self=$klass($base,null,"MatchData");$def(self,"$pretty_print",(function(q){var nc=nil;return nc=[],$send(this.$regexp().$named_captures(),"each",[],(function(name,indexes){return null==name&&(name=nil),null==indexes&&(indexes=nil),$send(indexes,"each",[],(function(i){var $a;return null==i&&(i=nil),$send(nc,"[]=",$a=[i,name]),$a[$a.length-1]}))})),$send(q,"object_group",[this],(function $$28(){var self=null==$$28.$$s?this:$$28.$$s;return q.$breakable(),$send(q,"seplist",[Opal.Range.$new(0,self.$size(),!0),$send(self,"lambda",[],(function(){return q.$breakable()}))],(function $$30(i){var self=null==$$30.$$s?this:$$30.$$s;return null==i&&(i=nil),$eqeq(i,0)||($truthy(nc["$[]"](i))?q.$text(nc["$[]"](i)):q.$pp(i),q.$text(":")),q.$pp(self["$[]"](i))}),{$$s:self})}),{$$s:this})}))}($nesting[0]),function($base,$super,$parent_nesting){var self=$klass($base,$super,"Object"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);self.$include($$$($$("PP"),"ObjectMixin"))}($nesting[0],$$("BasicObject"),$nesting),$send([$$("Numeric"),$$("Symbol"),$$("FalseClass"),$$("TrueClass"),$$("NilClass"),$$("Module")],"each",[],(function $$31(c){return null==c&&(c=nil),$send(c,"class_eval",[],(function $$32(){return $def(null==$$32.$$s?this:$$32.$$s,"$pretty_print_cycle",(function(q){return q.$text(this.$inspect())}))}),{$$s:null==$$31.$$s?this:$$31.$$s})}),{$$s:self}),$send([$$("Numeric"),$$("FalseClass"),$$("TrueClass"),$$("Module")],"each",[],(function $$33(c){return null==c&&(c=nil),$send(c,"class_eval",[],(function $$34(){return $def(null==$$34.$$s?this:$$34.$$s,"$pretty_print",(function(q){return q.$text(this.$inspect())}))}),{$$s:null==$$33.$$s?this:$$33.$$s})}),{$$s:self}),function($base,$parent_nesting){var self=$module($base,"Kernel"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);return $def(self,"$pretty_inspect",(function(){return $$("PP").$pp(this,$$("StringIO").$new()).$string()})),$def(self,"$pp",(function($a){var $post_args,objs;return $post_args=$slice(arguments),$send(objs=$post_args,"each",[],(function(obj){return null==obj&&(obj=nil),$$("PP").$pp(obj)})),$truthy($rb_le(objs.$size(),1))?objs.$first():objs}),-1),self.$module_function("pp")}($nesting[0],$nesting)};
