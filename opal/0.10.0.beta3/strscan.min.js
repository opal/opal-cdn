Opal.modules["strscan"]=function(Opal){var self=Opal.top,$scope=Opal,nil=Opal.nil,$breaker=Opal.breaker,$slice=Opal.slice,$klass=Opal.klass;Opal.add_stubs(["$attr_reader","$anchor","$scan_until","$length","$size","$rest","$pos=","$private"]);return function($base,$super){function $StringScanner(){}var self=$StringScanner=$klass($base,$super,"StringScanner",$StringScanner);var def=self.$$proto,$scope=self.$$scope,TMP_1,TMP_2,TMP_3,TMP_4,TMP_5,TMP_6,TMP_7,TMP_8,TMP_9,TMP_10,TMP_11,TMP_12,TMP_13,TMP_14,TMP_15,TMP_16,TMP_17,TMP_18,TMP_19,TMP_20,TMP_21,TMP_22,TMP_23,TMP_24;def.pos=def.string=def.working=def.matched=def.prev_pos=def.match=nil;self.$attr_reader("pos");self.$attr_reader("matched");Opal.defn(self,"$initialize",TMP_1=function ːinitialize(string){var self=this;self.string=string;self.pos=0;self.matched=nil;self.working=string;return self.match=[]},TMP_1.$$arity=1);self.$attr_reader("string");Opal.defn(self,"$beginning_of_line?",TMP_2=function(){var self=this;return self.pos===0||self.string.charAt(self.pos-1)==="\n"},TMP_2.$$arity=0);Opal.alias(self,"bol?","beginning_of_line?");Opal.defn(self,"$scan",TMP_3=function ːscan(pattern){var self=this;pattern=self.$anchor(pattern);var result=pattern.exec(self.working);if(result==null){return self.matched=nil}else if(typeof result==="object"){self.prev_pos=self.pos;self.pos+=result[0].length;self.working=self.working.substring(result[0].length);self.matched=result[0];self.match=result;return result[0]}else if(typeof result==="string"){self.pos+=result.length;self.working=self.working.substring(result.length);return result}else{return nil}},TMP_3.$$arity=1);Opal.defn(self,"$scan_until",TMP_4=function ːscan_until(pattern){var self=this;pattern=self.$anchor(pattern);var pos=self.pos,working=self.working,result;while(true){result=pattern.exec(working);pos+=1;working=working.substr(1);if(result==null){if(working.length===0){return self.matched=nil}continue}self.matched=self.string.substr(self.pos,pos-self.pos-1+result[0].length);self.prev_pos=pos-1;self.pos=pos;self.working=working.substr(result[0].length);return self.matched}},TMP_4.$$arity=1);Opal.defn(self,"$[]",TMP_5=function(idx){var self=this;var match=self.match;if(idx<0){idx+=match.length}if(idx<0||idx>=match.length){return nil}if(match[idx]==null){return nil}return match[idx]},TMP_5.$$arity=1);Opal.defn(self,"$check",TMP_6=function ːcheck(pattern){var self=this;pattern=self.$anchor(pattern);var result=pattern.exec(self.working);if(result==null){return self.matched=nil}return self.matched=result[0]},TMP_6.$$arity=1);Opal.defn(self,"$check_until",TMP_7=function ːcheck_until(pattern){var self=this;var prev_pos=self.prev_pos,pos=self.pos;var result=self.$scan_until(pattern);if(result!==nil){self.matched=result.substr(-1);self.working=self.string.substr(pos)}self.prev_pos=prev_pos;self.pos=pos;return result},TMP_7.$$arity=1);Opal.defn(self,"$peek",TMP_8=function ːpeek(length){var self=this;return self.working.substring(0,length)},TMP_8.$$arity=1);Opal.defn(self,"$eos?",TMP_9=function(){var self=this;return self.working.length===0},TMP_9.$$arity=0);Opal.defn(self,"$exist?",TMP_10=function(pattern){var self=this;var result=pattern.exec(self.working);if(result==null){return nil}else if(result.index==0){return 0}else{return result.index+1}},TMP_10.$$arity=1);Opal.defn(self,"$skip",TMP_11=function ːskip(pattern){var self=this;pattern=self.$anchor(pattern);var result=pattern.exec(self.working);if(result==null){return self.matched=nil}else{var match_str=result[0];var match_len=match_str.length;self.matched=match_str;self.prev_pos=self.pos;self.pos+=match_len;self.working=self.working.substring(match_len);return match_len}},TMP_11.$$arity=1);Opal.defn(self,"$skip_until",TMP_12=function ːskip_until(pattern){var self=this;var result=self.$scan_until(pattern);if(result===nil){return nil}else{self.matched=result.substr(-1);return result.length}},TMP_12.$$arity=1);Opal.defn(self,"$get_byte",TMP_13=function ːget_byte(){var self=this;var result=nil;if(self.pos<self.string.length){self.prev_pos=self.pos;self.pos+=1;result=self.matched=self.working.substring(0,1);self.working=self.working.substring(1)}else{self.matched=nil}return result},TMP_13.$$arity=0);Opal.alias(self,"getch","get_byte");Opal.defn(self,"$match?",TMP_14=function(pattern){var self=this;pattern=self.$anchor(pattern);var result=pattern.exec(self.working);if(result==null){return nil}else{self.prev_pos=self.pos;return result[0].length}},TMP_14.$$arity=1);Opal.defn(self,"$pos=",TMP_15=function(pos){var self=this;if(pos<0){pos+=self.string.$length()}self.pos=pos;return self.working=self.string.slice(pos)},TMP_15.$$arity=1);Opal.defn(self,"$post_match",TMP_16=function ːpost_match(){var self=this;if(self.matched===nil){return nil}return self.string.substr(self.pos)},TMP_16.$$arity=0);Opal.defn(self,"$pre_match",TMP_17=function ːpre_match(){var self=this;if(self.matched===nil){return nil}return self.string.substr(0,self.prev_pos)},TMP_17.$$arity=0);Opal.defn(self,"$reset",TMP_18=function ːreset(){var self=this;self.working=self.string;self.matched=nil;return self.pos=0},TMP_18.$$arity=0);Opal.defn(self,"$rest",TMP_19=function ːrest(){var self=this;return self.working},TMP_19.$$arity=0);Opal.defn(self,"$rest?",TMP_20=function(){var self=this;return self.working.length!==0},TMP_20.$$arity=0);Opal.defn(self,"$rest_size",TMP_21=function ːrest_size(){var self=this;return self.$rest().$size()},TMP_21.$$arity=0);Opal.defn(self,"$terminate",TMP_22=function ːterminate(){var $a,$b,self=this;self.match=nil;return $a=[self.string.$length()],$b=self,$b["$pos="].apply($b,$a),$a[$a.length-1]},TMP_22.$$arity=0);Opal.defn(self,"$unscan",TMP_23=function ːunscan(){var self=this;self.pos=self.prev_pos;self.prev_pos=nil;self.match=nil;return self},TMP_23.$$arity=0);self.$private();return(Opal.defn(self,"$anchor",TMP_24=function ːanchor(pattern){var self=this;return new RegExp("^(?:"+pattern.toString().substr(1,pattern.toString().length-2)+")")},TMP_24.$$arity=1),nil)&&"anchor"}($scope.base,null)};
