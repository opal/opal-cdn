Opal.modules.forwardable=function(Opal){var self,$module=Opal.module,$send=Opal.send,$truthy=Opal.truthy,$def=Opal.def,$slice=Opal.slice,$to_a=Opal.to_a,$alias=Opal.alias,$nesting=[],nil=Opal.nil;return Opal.add_stubs("each,respond_to?,def_instance_delegator,include?,start_with?,to_s,define_method,__send__,instance_variable_get,to_proc,instance_delegate,def_instance_delegators,def_single_delegator,define_singleton_method,single_delegate,def_single_delegators"),self=$module($nesting[0],"Forwardable"),$def(self,"$instance_delegate",(function(hash){return $send(hash,"each",[],(function $$1(methods,accessor){var self=null==$$1.$$s?this:$$1.$$s;return null==methods&&(methods=nil),null==accessor&&(accessor=nil),$truthy(methods["$respond_to?"]("each"))||(methods=[methods]),$send(methods,"each",[],(function $$2(method){return null==method&&(method=nil),(null==$$2.$$s?this:$$2.$$s).$def_instance_delegator(accessor,method)}),{$$s:self})}),{$$s:this})})),$def(self,"$def_instance_delegators",(function(accessor,$a){var $post_args,self=this;return $post_args=$slice(arguments,1),$send($post_args,"each",[],(function $$3(method){var self=null==$$3.$$s?this:$$3.$$s;return null==method&&(method=nil),$truthy(["__send__","__id__"]["$include?"](method))?nil:self.$def_instance_delegator(accessor,method)}),{$$s:self})}),-2),$def(self,"$def_instance_delegator",(function $$def_instance_delegator(accessor,method,ali){return $$def_instance_delegator.$$p=null,null==ali&&(ali=method),$truthy(accessor.$to_s()["$start_with?"]("@"))?$send(this,"define_method",[ali],(function $$4($a){var args,block=$$4.$$p||nil,self=null==$$4.$$s?this:$$4.$$s;return $$4.$$p=null,args=$slice(arguments),$send(self.$instance_variable_get(accessor),"__send__",[method].concat($to_a(args)),block.$to_proc())}),{$$arity:-1,$$s:this}):$send(this,"define_method",[ali],(function $$5($a){var args,block=$$5.$$p||nil,self=null==$$5.$$s?this:$$5.$$s;return $$5.$$p=null,args=$slice(arguments),$send(self.$__send__(accessor),"__send__",[method].concat($to_a(args)),block.$to_proc())}),{$$arity:-1,$$s:this})}),-3),$alias(self,"delegate","instance_delegate"),$alias(self,"def_delegators","def_instance_delegators"),$alias(self,"def_delegator","def_instance_delegator"),function($base){var self=$module($base,"SingleForwardable");return $def(self,"$single_delegate",(function(hash){return $send(hash,"each",[],(function $$6(methods,accessor){var self=null==$$6.$$s?this:$$6.$$s;return null==methods&&(methods=nil),null==accessor&&(accessor=nil),$truthy(methods["$respond_to?"]("each"))||(methods=[methods]),$send(methods,"each",[],(function $$7(method){return null==method&&(method=nil),(null==$$7.$$s?this:$$7.$$s).$def_single_delegator(accessor,method)}),{$$s:self})}),{$$s:this})})),$def(self,"$def_single_delegators",(function(accessor,$a){var $post_args,self=this;return $post_args=$slice(arguments,1),$send($post_args,"each",[],(function $$8(method){var self=null==$$8.$$s?this:$$8.$$s;return null==method&&(method=nil),$truthy(["__send__","__id__"]["$include?"](method))?nil:self.$def_single_delegator(accessor,method)}),{$$s:self})}),-2),$def(self,"$def_single_delegator",(function $$def_single_delegator(accessor,method,ali){return $$def_single_delegator.$$p=null,null==ali&&(ali=method),$truthy(accessor.$to_s()["$start_with?"]("@"))?$send(this,"define_singleton_method",[ali],(function $$9($a){var args,block=$$9.$$p||nil,self=null==$$9.$$s?this:$$9.$$s;return $$9.$$p=null,args=$slice(arguments),$send(self.$instance_variable_get(accessor),"__send__",[method].concat($to_a(args)),block.$to_proc())}),{$$arity:-1,$$s:this}):$send(this,"define_singleton_method",[ali],(function $$10($a){var args,block=$$10.$$p||nil,self=null==$$10.$$s?this:$$10.$$s;return $$10.$$p=null,args=$slice(arguments),$send(self.$__send__(accessor),"__send__",[method].concat($to_a(args)),block.$to_proc())}),{$$arity:-1,$$s:this})}),-3),$alias(self,"delegate","single_delegate"),$alias(self,"def_delegators","def_single_delegators"),$alias(self,"def_delegator","def_single_delegator")}($nesting[0])},Opal.modules["date/infinity"]=function(Opal){var $klass=Opal.klass,$def=Opal.def,$return_val=Opal.return_val,$eqeqeq=Opal.eqeqeq,$to_ary=Opal.to_ary,$send2=Opal.send2,$find_super=Opal.find_super,$eqeq=Opal.eqeq,$truthy=Opal.truthy,$rb_gt=Opal.rb_gt,$nesting=[],nil=Opal.nil,$$$=Opal.$$$;return Opal.add_stubs("include,<=>,attr_reader,nonzero?,d,zero?,new,class,-@,+@,===,coerce,==,>"),function($base,$super,$parent_nesting){var $nesting=[$klass($base,null,"Date")].concat($parent_nesting),$$=Opal.$r($nesting);return function($base,$super,$parent_nesting){var self=$klass($base,$super,"Infinity"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);return self.$$prototype.d=nil,self.$include($$("Comparable")),$def(self,"$initialize",(function(d){return null==d&&(d=1),this.d=d["$<=>"](0)}),-1),self.$attr_reader("d"),$def(self,"$zero?",$return_val(!1)),$def(self,"$finite?",$return_val(!1)),$def(self,"$infinite?",(function(){return this.$d()["$nonzero?"]()})),$def(self,"$nan?",(function(){return this.$d()["$zero?"]()})),$def(self,"$abs",(function(){return this.$class().$new()})),$def(self,"$-@",(function(){return this.$class().$new(this.$d()["$-@"]())})),$def(self,"$+@",(function(){return this.$class().$new(this.$d()["$+@"]())})),$def(self,"$<=>",(function(other){var $a,$b,$ret_or_1,l=nil,r=nil;if($eqeqeq($$("Infinity"),$ret_or_1=other))return this.$d()["$<=>"](other.$d());if($eqeqeq($$("Numeric"),$ret_or_1))return this.$d();try{return $b=other.$coerce(this),l=null==($a=$to_ary($b))[0]?nil:$a[0],r=null==$a[1]?nil:$a[1],l["$<=>"](r)}catch($err){if(!Opal.rescue($err,[$$("NoMethodError")]))throw $err;try{return nil}finally{Opal.pop_exception()}}})),$def(self,"$coerce",(function $$coerce(other){var $yield=$$coerce.$$p||nil;return $$coerce.$$p=null,$eqeqeq($$("Numeric"),other)?[this.$d()["$-@"](),this.$d()]:$send2(this,$find_super(this,"coerce",$$coerce,!1,!0),"coerce",[other],$yield)})),$def(self,"$to_f",(function(){return $eqeq(this.d,0)?0:$truthy($rb_gt(this.d,0))?$$$($$("Float"),"INFINITY"):$$$($$("Float"),"INFINITY")["$-@"]()}))}($nesting[0],$$("Numeric"),$nesting)}($nesting[0],0,$nesting)},Opal.modules.time=function(Opal){var $klass=Opal.klass,$defs=Opal.defs,$ensure_kwargs=Opal.ensure_kwargs,$hash_get=Opal.hash_get,$send=Opal.send,$eqeqeq=Opal.eqeqeq,$truthy=Opal.truthy,$rb_gt=Opal.rb_gt,$rb_plus=Opal.rb_plus,$alias=Opal.alias,$def=Opal.def,$return_self=Opal.return_self,self=Opal.top,$nesting=[],nil=Opal.nil,$$$=Opal.$$$;return Opal.add_stubs("define_method,===,new_offset,utc,year,month,day,getutc,strftime,>,+,def_formatter,rfc2822,xmlschema,wrap,require"),function($base,$super,$parent_nesting){var self=$klass($base,null,"Time"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);$defs(self,"$parse",(function(str){var d=Date.parse(str);return d!=d&&(str=str.replace(/^(\d+)([\./])(\d+)([\./])?(\d+)?/,(function(matched_sub,c1,c2,c3,c4,c5,offset,orig_string){return c2===c4&&c5?c1+"-"+c3+"-"+c5:c3&&!c4?c1+"-"+c3+"-01":matched_sub})),d=Date.parse(str)),new Date(d)})),$defs(self,"$def_formatter",(function(name,format,$kwargs){var on_utc,utc_tz,tz_format,fractions,on;return $kwargs=$ensure_kwargs($kwargs),null==(on_utc=$hash_get($kwargs,"on_utc"))&&(on_utc=!1),null==(utc_tz=$hash_get($kwargs,"utc_tz"))&&(utc_tz=nil),null==(tz_format=$hash_get($kwargs,"tz_format"))&&(tz_format=nil),null==(fractions=$hash_get($kwargs,"fractions"))&&(fractions=!1),null==(on=$hash_get($kwargs,"on"))&&(on=this),$send(on,"define_method",[name],(function $$1(fdigits){var $ret_or_1,self=null==$$1.$$s?this:$$1.$$s,$ret_or_2=nil,date=nil,str=nil;return null==fdigits&&(fdigits=0),$eqeqeq($truthy($ret_or_2=$$$("::","DateTime","skip_raise")?"constant":nil)?$$$("DateTime"):$ret_or_2,$ret_or_1=self)?date=$truthy(on_utc)?self.$new_offset(0):self:$eqeqeq($truthy($ret_or_2=$$$("::","Date","skip_raise")?"constant":nil)?$$$("Date"):$ret_or_2,$ret_or_1)?date=$$$("Time").$utc(self.$year(),self.$month(),self.$day()):$eqeqeq($$$("Time"),$ret_or_1)&&(date=$truthy(on_utc)?self.$getutc():self),str=date.$strftime(format),$truthy(fractions)&&$truthy($rb_gt(fdigits,0))&&(str=$rb_plus(str,date.$strftime(".%"+fdigits+"N"))),$truthy(utc_tz)?str=$rb_plus(str,$truthy(self.$utc())?utc_tz:date.$strftime(tz_format)):$truthy(tz_format)&&(str=$rb_plus(str,date.$strftime(tz_format))),str}),{$$arity:-1,$$s:this})}),-3),self.$def_formatter("rfc2822","%a, %d %b %Y %T ",new Map([["utc_tz","-00:00"],["tz_format","%z"]])),$alias(self,"rfc822","rfc2822"),self.$def_formatter("httpdate","%a, %d %b %Y %T GMT",new Map([["on_utc",!0]])),self.$def_formatter("xmlschema","%FT%T",new Map([["utc_tz","Z"],["tz_format","%:z"],["fractions",!0]])),$alias(self,"iso8601","xmlschema"),$def(self,"$to_date",(function(){return $$("Date").$wrap(this)})),$def(self,"$to_datetime",(function(){return $$("DateTime").$wrap(this)})),$def(self,"$to_time",$return_self)}($nesting[0],0,$nesting),self.$require("date")},Opal.modules["date/date_time"]=function(Opal){var $klass=Opal.klass,$def=Opal.def,$alias=Opal.alias,$rb_divide=Opal.rb_divide,$rb_times=Opal.rb_times,$rb_plus=Opal.rb_plus,$rb_minus=Opal.rb_minus,$truthy=Opal.truthy,$return_self=Opal.return_self,$nesting=[],$$=Opal.$r($nesting),nil=Opal.nil,$$$=Opal.$$$;return Opal.add_stubs("wrap,now,parse,new,def_delegators,min,sec,/,usec,sec_fraction,gmt_offset,*,+,-,is_a?,clone,_parse_offset,dup,year,month,day"),function($base,$super,$parent_nesting){var self=$klass($base,$super,"DateTime"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);return self.$$prototype.date=nil,function(self,$parent_nesting){var $nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);$def(self,"$now",(function(){return this.$wrap($$("Time").$now())})),$def(self,"$parse",(function(str){return this.$wrap($$("Time").$parse(str))}))}(Opal.get_singleton_class(self),$nesting),$def(self,"$initialize",(function(year,month,day,hours,minutes,seconds,offset,start){return null==year&&(year=-4712),null==month&&(month=1),null==day&&(day=1),null==hours&&(hours=0),null==minutes&&(minutes=0),null==seconds&&(seconds=0),null==offset&&(offset=0),null==start&&(start=$$("ITALY")),1582===year&&10===month&&day>4&&day<15&&(day=4),this.date=$$("Time").$new(year,month,day,hours,minutes,seconds,offset),this.start=start}),-1),self.$def_delegators("@date","min","hour","sec"),$alias(self,"minute","min"),$alias(self,"second","sec"),$def(self,"$sec_fraction",(function(){return $rb_divide(this.date.$usec(),$$$("Rational").$new(1e6,1))})),$alias(self,"second_fraction","sec_fraction"),$def(self,"$offset",(function(){return $rb_divide(this.date.$gmt_offset(),$rb_times(24,$$$("Rational").$new(3600,1)))})),$def(self,"$+",(function(other){return $$$("DateTime").$wrap($rb_plus(this.date,other))})),$def(self,"$-",(function(other){var result=nil;return Opal.is_a(other,$$$("Date"))&&(other=other.date),result=$rb_minus(this.date,other),$truthy(result["$is_a?"]($$$("Time")))?$$$("DateTime").$wrap(result):result})),$def(self,"$new_offset",(function(offset){var new_date=nil;return new_date=this.$clone(),offset=$$("Time").$_parse_offset(offset),new_date.date.timezone=offset,new_date})),$def(self,"$to_datetime",$return_self),$def(self,"$to_time",(function(){return this.date.$dup()})),$def(self,"$to_date",(function(){return $$("Date").$new(this.$year(),this.$month(),this.$day())}))}($nesting[0],$$("Date"),$nesting)},Opal.modules["date/formatters"]=function(Opal){var $base,$super,self,$klass=Opal.klass,$slice=Opal.slice,$extract_kwargs=Opal.extract_kwargs,$ensure_kwargs=Opal.ensure_kwargs,$kwrestargs=Opal.kwrestargs,$send=Opal.send,$to_a=Opal.to_a,$defs=Opal.defs,$alias=Opal.alias,$nesting=[],$$=Opal.$r($nesting);Opal.nil;return Opal.add_stubs("def_formatter,asctime,iso8601,rfc2822,xmlschema"),function($base,$super,$parent_nesting){var self=$klass($base,null,"Date"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);$defs(self,"$def_formatter",(function($a,$b){var $post_args,$kwargs,args,kwargs,self=this;return $post_args=$slice(arguments),$kwargs=$extract_kwargs($post_args),$kwargs=$ensure_kwargs($kwargs),args=$post_args,kwargs=$kwrestargs($kwargs,{}),$send($$("Time"),"def_formatter",$to_a(args).concat([Opal.to_hash(kwargs).$merge(new Map([["on",self]]))]))}),-1),self.$def_formatter("asctime","%c"),$alias(self,"ctime","asctime"),self.$def_formatter("iso8601","%F"),$alias(self,"xmlschema","iso8601"),self.$def_formatter("rfc3339","%FT%T%:z"),self.$def_formatter("rfc2822","%a, %-d %b %Y %T %z"),$alias(self,"rfc822","rfc2822"),self.$def_formatter("httpdate","%a, %d %b %Y %T GMT",new Map([["utc",!0]])),self.$def_formatter("jisx0301","%J"),$alias(self,"to_s","iso8601")}($nesting[0],0,$nesting),$base=$nesting[0],$super=$$("Date"),(self=$klass($base,$super,"DateTime")).$def_formatter("xmlschema","%FT%T",new Map([["fractions",!0],["tz_format","%:z"]])),$alias(self,"iso8601","xmlschema"),$alias(self,"rfc3339","xmlschema"),self.$def_formatter("jisx0301","%JT%T",new Map([["fractions",!0],["tz_format","%:z"]])),$alias(self,"to_s","xmlschema"),self.$def_formatter("zone","%:z")},Opal.modules.date=function(Opal){var $klass=Opal.klass,$const_set=Opal.const_set,$rb_plus=Opal.rb_plus,$def=Opal.def,$send=Opal.send,$alias=Opal.alias,$rb_minus=Opal.rb_minus,$return_self=Opal.return_self,$return_ivar=Opal.return_ivar,$truthy=Opal.truthy,$rb_lt=Opal.rb_lt,$rb_times=Opal.rb_times,$defs=Opal.defs,self=Opal.top,$nesting=[],nil=Opal.nil,$$$=Opal.$$$;return Opal.add_stubs("require,include,extend,new,-@,+,allocate,join,compact,map,to_proc,downcase,wrap,raise,attr_reader,<=>,jd,===,<<,prev_month,dup,def_delegators,day,month,clone,prev_day,next_day,_days_in_month,class,-,year,prev_year,to_s,strftime,to_i,<,*,reverse,step,abs,each,==,next"),self.$require("forwardable"),self.$require("date/infinity"),self.$require("time"),function($base,$super,$parent_nesting){var self=$klass($base,null,"Date"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting),$proto=self.$$prototype;$proto.date=$proto.start=nil,self.$include($$("Comparable")),self.$extend($$("Forwardable")),$const_set($nesting[0],"JULIAN",$$("Infinity").$new()),$const_set($nesting[0],"GREGORIAN",$$("Infinity").$new()["$-@"]()),$const_set($nesting[0],"ITALY",2299161),$const_set($nesting[0],"ENGLAND",2361222),$const_set($nesting[0],"MONTHNAMES",$rb_plus([nil],["January","February","March","April","May","June","July","August","September","October","November","December"])),$const_set($nesting[0],"ABBR_MONTHNAMES",["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"]),$const_set($nesting[0],"DAYNAMES",["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]),$const_set($nesting[0],"ABBR_DAYNAMES",["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]),function(self,$parent_nesting){var $nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);$def(self,"$wrap",(function(native$){var instance=nil;return(instance=this.$allocate()).start=$$("ITALY"),instance.date=native$,instance})),$def(self,"$parse",(function(string,comp){null==comp&&(comp=!0);var current_date=new Date,current_day=current_date.getDate(),current_month=current_date.getMonth(),current_year=current_date.getFullYear(),current_wday=current_date.getDay(),full_month_name_regexp=$$("MONTHNAMES").$compact().$join("|");function match1(match){return match[1]}function match2(match){return match[2]}function match3(match){return match[3]}function match4(match){return match[4]}function fromShortYear(fn){return function(match){var short_year=fn(match);return short_year+=short_year>=69?1900:2e3}}function fromMonthAbbr(fn){return function(match){var abbr=fn(match).toLowerCase();return $$("ABBR_MONTHNAMES").indexOf(abbr)+1}}function toInt(fn){return function(match){var value=fn(match);return parseInt(value,10)}}function fromFullMonthName(fn){return function(match){var month_name=fn(match);return $send($$("MONTHNAMES").$compact(),"map",[],"downcase".$to_proc()).indexOf(month_name.$downcase())+1}}var fn,rule,i,match,rules=[{regexp:/^(\d{2})$/,year:current_year,month:current_month,day:toInt(match1)},{regexp:/^(\d{3})$/,year:current_year,month:0,day:toInt(match1)},{regexp:/^(\d{2})(\d{2})$/,year:current_year,month:toInt(match1),day:toInt(match2)},{regexp:/^(\d{2})(\d{3})$/,year:fromShortYear(toInt(match1)),month:0,day:toInt(match2)},{regexp:/^(\d{2})(\d{2})(\d{2})$/,year:fromShortYear(toInt(match1)),month:toInt(match2),day:toInt(match3)},{regexp:/^(\d{4})(\d{3})$/,year:toInt(match1),month:0,day:toInt(match2)},{regexp:/^(\d{4})(\d{2})(\d{2})$/,year:toInt(match1),month:toInt(match2),day:toInt(match3)},{regexp:/^([a-z]{3})[\s\.\/\-](\d{3,4})$/,year:toInt(match2),month:fromMonthAbbr(match1),day:1},{regexp:/^(\d{1,2})[\s\.\/\-]([a-z]{3})[\s\.\/\-](\d{3,4})$/i,year:toInt(match3),month:fromMonthAbbr(match2),day:toInt(match1)},{regexp:/^([a-z]{3})[\s\.\/\-](\d{1,2})[\s\.\/\-](\d{3,4})$/i,year:toInt(match3),month:fromMonthAbbr(match1),day:toInt(match2)},{regexp:/^(\d{3,4})[\s\.\/\-]([a-z]{3})[\s\.\/\-](\d{1,2})$/i,year:toInt(match1),month:fromMonthAbbr(match2),day:toInt(match3)},{regexp:/^(\-?\d{3,4})[\s\.\/\-](\d{1,2})[\s\.\/\-](\d{1,2})$/,year:toInt(match1),month:toInt(match2),day:toInt(match3)},{regexp:/^(\d{2})[\s\.\/\-](\d{1,2})[\s\.\/\-](\d{1,2})$/,year:(fn=toInt(match1),function(match){var value=fn(match);return comp?value+2e3:value}),month:toInt(match2),day:toInt(match3)},{regexp:/^(\d{1,2})[\s\.\/\-](\d{1,2})[\s\.\/\-](\-?\d{3,4})$/,year:toInt(match3),month:toInt(match2),day:toInt(match1)},{regexp:new RegExp("^("+$$("DAYNAMES").$join("|")+")$","i"),year:current_year,month:current_month,day:function(fn){return function(match){var dayname=fn(match),wday=$send($$("DAYNAMES"),"map",[],"downcase".$to_proc()).indexOf(dayname.$downcase());return current_day-current_wday+wday}}(match1)},{regexp:new RegExp("^("+full_month_name_regexp+")[\\s\\.\\/\\-](\\d{1,2})(th|nd|rd)[\\s\\.\\/\\-](\\-?\\d{3,4})$","i"),year:toInt(match4),month:fromFullMonthName(match1),day:toInt(match2)},{regexp:new RegExp("^("+full_month_name_regexp+")[\\s\\.\\/\\-](\\d{1,2})(th|nd|rd)","i"),year:current_year,month:fromFullMonthName(match1),day:toInt(match2)},{regexp:new RegExp("^(\\d{1,2})(th|nd|rd)[\\s\\.\\/\\-]("+full_month_name_regexp+")[\\s\\.\\/\\-](\\-?\\d{3,4})$","i"),year:toInt(match4),month:fromFullMonthName(match3),day:toInt(match1)},{regexp:new RegExp("^(\\-?\\d{3,4})[\\s\\.\\/\\-]("+full_month_name_regexp+")[\\s\\.\\/\\-](\\d{1,2})(th|nd|rd)$","i"),year:toInt(match1),month:fromFullMonthName(match2),day:toInt(match3)}];for(i=0;i<rules.length;i++)if(match=(rule=rules[i]).regexp.exec(string)){var year=rule.year;"function"==typeof year&&(year=year(match));var month=rule.month;"function"==typeof month&&(month=month(match)-1);var day=rule.day;"function"==typeof day&&(day=day(match));var result=new Date(year,month,day);return year>=0&&year<=1970&&result.setFullYear(year),this.$wrap(result)}return this.$raise($$("ArgumentError"),"invalid date")}),-2),$def(self,"$today",(function(){return this.$wrap(new Date)})),$def(self,"$gregorian_leap?",(function(year){return new Date(year,1,29).getMonth()-1==0})),$alias(self,"civil","new")}(Opal.get_singleton_class(self),$nesting),$def(self,"$initialize",(function(year,month,day,start){return null==year&&(year=-4712),null==month&&(month=1),null==day&&(day=1),null==start&&(start=$$("ITALY")),1582===year&&10===month&&day>4&&day<15&&(day=4),this.date=new Date(year,month-1,day),this.start=start}),-1),self.$attr_reader("start"),$def(self,"$<=>",(function(other){if(other.$$is_number)return this.$jd()["$<=>"](other);if($$$("Date")["$==="](other)){var a=this.date,b=other.date;return Opal.is_a(this,$$$("DateTime"))||a.setHours(0,0,0,0),Opal.is_a(other,$$$("DateTime"))||b.setHours(0,0,0,0),a<b?-1:a>b?1:0}return nil})),$def(self,"$>>",(function(n){return n.$$is_number||this.$raise($$$("TypeError")),this["$<<"](n["$-@"]())})),$def(self,"$<<",(function(n){return n.$$is_number||this.$raise($$$("TypeError")),this.$prev_month(n)})),$def(self,"$clone",(function(){var date=nil;return(date=$$("Date").$wrap(this.date.$dup())).start=this.start,date})),self.$def_delegators("@date","sunday?","monday?","tuesday?","wednesday?","thursday?","friday?","saturday?","day","month","year","wday","yday"),$alias(self,"mday","day"),$alias(self,"mon","month"),$def(self,"$jd",(function(){var ggg,s,a,j1,jd,mm=this.date.getMonth()+1,dd=this.date.getDate(),yy=this.date.getFullYear(),hr=12;return hr=hr+0+0,ggg=1,yy<=1585&&(ggg=0),jd=-1*Math.floor(7*(Math.floor((mm+9)/12)+yy)/4),s=1,mm-9<0&&(s=-1),a=Math.abs(mm-9),j1=Math.floor(yy+s*Math.floor(a/7)),j1=-1*Math.floor(3*(Math.floor(j1/100)+1)/4),jd=(jd=jd+Math.floor(275*mm/9)+dd+ggg*j1)+1721027+2*ggg+367*yy-.5,jd+=hr/24})),$def(self,"$julian?",(function(){return this.date<new Date(1582,9,15,12)})),$def(self,"$new_start",(function(start){var new_date=nil;return(new_date=this.$clone()).start=start,new_date})),$def(self,"$next",(function(){return $rb_plus(this,1)})),$def(self,"$-",(function(date){return date.date?Math.round((this.date-date.date)/864e5):this.$prev_day(date)})),$def(self,"$+",(function(date){return this.$next_day(date)})),$def(self,"$prev_day",(function(n){if(null==n&&(n=1),n.$$is_number){var result=this.$clone();return result.date.setDate(this.date.getDate()-n),result}this.$raise($$$("TypeError"))}),-1),$def(self,"$next_day",(function(n){return null==n&&(n=1),n.$$is_number||this.$raise($$$("TypeError")),this.$prev_day(n["$-@"]())}),-1),$def(self,"$prev_month",(function(n){null==n&&(n=1),n.$$is_number||this.$raise($$$("TypeError"));var result=this.$clone(),date=result.date,cur=date.getDate();return date.setDate(1),date.setMonth(date.getMonth()-n),date.setDate(Math.min(cur,$$("Date").$_days_in_month(date.getFullYear(),date.getMonth()))),result}),-1),$def(self,"$next_month",(function(n){return null==n&&(n=1),n.$$is_number||this.$raise($$$("TypeError")),this.$prev_month(n["$-@"]())}),-1),$def(self,"$prev_year",(function(years){return null==years&&(years=1),years.$$is_number||this.$raise($$$("TypeError")),this.$class().$new($rb_minus(this.$year(),years),this.$month(),this.$day())}),-1),$def(self,"$next_year",(function(years){return null==years&&(years=1),years.$$is_number||this.$raise($$$("TypeError")),this.$prev_year(years["$-@"]())}),-1),$def(self,"$strftime",(function(format){return null==format&&(format=""),""==format?this.$to_s():this.date.$strftime(format)}),-1),$def(self,"$to_s",(function(){var d=this.date,year=d.getFullYear(),month=d.getMonth()+1,day=d.getDate();return month<10&&(month="0"+month),day<10&&(day="0"+day),year+"-"+month+"-"+day})),$def(self,"$to_time",(function(){return $$("Time").$new(this.$year(),this.$month(),this.$day())})),$def(self,"$to_date",$return_self),$def(self,"$to_datetime",(function(){return $$("DateTime").$new(this.$year(),this.$month(),this.$day())})),$def(self,"$to_n",$return_ivar("date")),$def(self,"$step",(function $$step(limit,step){var steps,result,block=$$step.$$p||nil,steps_count=nil;return $$step.$$p=null,null==step&&(step=1),steps_count=$rb_minus(limit,this).$to_i(),steps=$truthy($rb_lt($rb_times(steps_count,step),0))?[]:$truthy($rb_lt(steps_count,0))?$send(Opal.Range.$new(0,steps_count["$-@"](),!1).$step(step.$abs()),"map",[],"-@".$to_proc()).$reverse():Opal.Range.$new(0,steps_count,!1).$step(step.$abs()),result=$send(steps,"map",[],(function $$8(i){return null==i&&(i=nil),$rb_plus(null==$$8.$$s?this:$$8.$$s,i)}),{$$s:this}),block!==nil?($send(result,"each",[],(function(i){return null==i&&(i=nil),Opal.yield1(block,i)})),this):result}),-2),$def(self,"$upto",(function $$upto(max){var block=$$upto.$$p||nil;return $$upto.$$p=null,$send(this,"step",[max,1],block.$to_proc())})),$def(self,"$downto",(function $$downto(min){var block=$$downto.$$p||nil;return $$downto.$$p=null,$send(this,"step",[min,-1],block.$to_proc())})),$def(self,"$cwday",(function(){return this.date.getDay()||7})),$def(self,"$cweek",(function(){var d=new Date(this.date);return d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7)),Math.ceil(((d-new Date(d.getFullYear(),0,1))/864e5+1)/7)})),$defs(self,"$_days_in_month",(function(year,month){return[31,year%4==0&&year%100!=0||year%400==0?29:28,31,30,31,30,31,31,30,31,30,31][month]})),$alias(self,"eql?","=="),$alias(self,"succ","next")}($nesting[0],0,$nesting),self.$require("date/date_time"),self.$require("date/formatters")},Opal.modules.time=function(Opal){var $klass=Opal.klass,$defs=Opal.defs,$ensure_kwargs=Opal.ensure_kwargs,$hash_get=Opal.hash_get,$send=Opal.send,$eqeqeq=Opal.eqeqeq,$truthy=Opal.truthy,$rb_gt=Opal.rb_gt,$rb_plus=Opal.rb_plus,$alias=Opal.alias,$def=Opal.def,$return_self=Opal.return_self,self=Opal.top,$nesting=[],nil=Opal.nil,$$$=Opal.$$$;return Opal.add_stubs("define_method,===,new_offset,utc,year,month,day,getutc,strftime,>,+,def_formatter,rfc2822,xmlschema,wrap,require"),function($base,$super,$parent_nesting){var self=$klass($base,null,"Time"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);$defs(self,"$parse",(function(str){var d=Date.parse(str);return d!=d&&(str=str.replace(/^(\d+)([\./])(\d+)([\./])?(\d+)?/,(function(matched_sub,c1,c2,c3,c4,c5,offset,orig_string){return c2===c4&&c5?c1+"-"+c3+"-"+c5:c3&&!c4?c1+"-"+c3+"-01":matched_sub})),d=Date.parse(str)),new Date(d)})),$defs(self,"$def_formatter",(function(name,format,$kwargs){var on_utc,utc_tz,tz_format,fractions,on;return $kwargs=$ensure_kwargs($kwargs),null==(on_utc=$hash_get($kwargs,"on_utc"))&&(on_utc=!1),null==(utc_tz=$hash_get($kwargs,"utc_tz"))&&(utc_tz=nil),null==(tz_format=$hash_get($kwargs,"tz_format"))&&(tz_format=nil),null==(fractions=$hash_get($kwargs,"fractions"))&&(fractions=!1),null==(on=$hash_get($kwargs,"on"))&&(on=this),$send(on,"define_method",[name],(function $$1(fdigits){var $ret_or_1,self=null==$$1.$$s?this:$$1.$$s,$ret_or_2=nil,date=nil,str=nil;return null==fdigits&&(fdigits=0),$eqeqeq($truthy($ret_or_2=$$$("::","DateTime","skip_raise")?"constant":nil)?$$$("DateTime"):$ret_or_2,$ret_or_1=self)?date=$truthy(on_utc)?self.$new_offset(0):self:$eqeqeq($truthy($ret_or_2=$$$("::","Date","skip_raise")?"constant":nil)?$$$("Date"):$ret_or_2,$ret_or_1)?date=$$$("Time").$utc(self.$year(),self.$month(),self.$day()):$eqeqeq($$$("Time"),$ret_or_1)&&(date=$truthy(on_utc)?self.$getutc():self),str=date.$strftime(format),$truthy(fractions)&&$truthy($rb_gt(fdigits,0))&&(str=$rb_plus(str,date.$strftime(".%"+fdigits+"N"))),$truthy(utc_tz)?str=$rb_plus(str,$truthy(self.$utc())?utc_tz:date.$strftime(tz_format)):$truthy(tz_format)&&(str=$rb_plus(str,date.$strftime(tz_format))),str}),{$$arity:-1,$$s:this})}),-3),self.$def_formatter("rfc2822","%a, %d %b %Y %T ",new Map([["utc_tz","-00:00"],["tz_format","%z"]])),$alias(self,"rfc822","rfc2822"),self.$def_formatter("httpdate","%a, %d %b %Y %T GMT",new Map([["on_utc",!0]])),self.$def_formatter("xmlschema","%FT%T",new Map([["utc_tz","Z"],["tz_format","%:z"],["fractions",!0]])),$alias(self,"iso8601","xmlschema"),$def(self,"$to_date",(function(){return $$("Date").$wrap(this)})),$def(self,"$to_datetime",(function(){return $$("DateTime").$wrap(this)})),$def(self,"$to_time",$return_self)}($nesting[0],0,$nesting),self.$require("date")};
