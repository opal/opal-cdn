Opal.modules.base64=function(Opal){Opal.top;var $nesting=[],nil=Opal.nil,$$=(Opal.$$$,Opal.$$),$module=Opal.module,$hash2=Opal.hash2,$truthy=Opal.truthy;return Opal.add_stubs(["$raise","$delete"]),function($base,$parent_nesting){var $Base64_decode64$1,$Base64_encode64$2,$Base64_strict_decode64$3,$Base64_strict_encode64$4,$Base64_urlsafe_decode64$5,$Base64_urlsafe_encode64$6,encode,decode,self=$module($base,"Base64"),$nesting=[self].concat($parent_nesting),chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return encode=function(input){for(var block,charCode,str=String(input),idx=0,map=chars,output="";str.charAt(0|idx)||(map="=",idx%1);output+=map.charAt(63&block>>8-idx%1*8))(charCode=str.charCodeAt(idx+=3/4))>255&&self.$raise($$($nesting,"ArgumentError"),"invalid character (failed: The string to be encoded contains characters outside of the Latin1 range.)"),block=block<<8|charCode;return output},decode=function(input){var str=String(input).replace(/=+$/,"");str.length%4==1&&self.$raise($$($nesting,"ArgumentError"),"invalid base64 (failed: The string to be decoded is not correctly encoded.)");for(var bs,buffer,bc=0,idx=0,output="";buffer=str.charAt(idx++);~buffer&&(bs=bc%4?64*bs+buffer:buffer,bc++%4)?output+=String.fromCharCode(255&bs>>(-2*bc&6)):0)buffer=chars.indexOf(buffer);return output},Opal.defs(self,"$decode64",$Base64_decode64$1=function(string){return decode(string.replace(/\r?\n/g,""))},$Base64_decode64$1.$$arity=1),Opal.defs(self,"$encode64",$Base64_encode64$2=function(string){return encode(string).replace(/(.{60})/g,"$1\n").replace(/([^\n])$/g,"$1\n")},$Base64_encode64$2.$$arity=1),Opal.defs(self,"$strict_decode64",$Base64_strict_decode64$3=function(string){return decode(string)},$Base64_strict_decode64$3.$$arity=1),Opal.defs(self,"$strict_encode64",$Base64_strict_encode64$4=function(string){return encode(string)},$Base64_strict_encode64$4.$$arity=1),Opal.defs(self,"$urlsafe_decode64",$Base64_urlsafe_decode64$5=function(string){return decode(string.replace(/\-/g,"+").replace(/_/g,"/"))},$Base64_urlsafe_decode64$5.$$arity=1),Opal.defs(self,"$urlsafe_encode64",$Base64_urlsafe_encode64$6=function(string,$kwargs){var padding,str=nil;if(null==$kwargs)$kwargs=$hash2([],{});else if(!$kwargs.$$is_hash)throw Opal.ArgumentError.$new("expected kwargs");return null==(padding=$kwargs.$$smap.padding)&&(padding=!0),str=encode(string).replace(/\+/g,"-").replace(/\//g,"_"),$truthy(padding)||(str=str.$delete("=")),str},$Base64_urlsafe_encode64$6.$$arity=-2),nil&&"urlsafe_encode64"}($nesting[0],$nesting)};
