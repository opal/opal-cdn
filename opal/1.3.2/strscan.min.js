Opal.modules.strscan=function(Opal){Opal.top;var $nesting=[],nil=Opal.nil,$$=(Opal.$$$,Opal.$$),$klass=Opal.klass,$alias=Opal.alias,$truthy=Opal.truthy,$send=Opal.send;return Opal.add_stubs(["$attr_reader","$anchor","$empty?","$===","$to_s","$coerce_to!","$scan_until","$length","$size","$rest","$pos=","$-","$private"]),function($base,$super,$parent_nesting){var $StringScanner_initialize$1,$StringScanner_beginning_of_line$ques$2,$StringScanner_scan$3,$StringScanner_scan_until$4,$StringScanner_$$$5,$StringScanner_check$6,$StringScanner_check_until$7,$StringScanner_peek$8,$StringScanner_eos$ques$9,$StringScanner_exist$ques$10,$StringScanner_skip$11,$StringScanner_skip_until$12,$StringScanner_get_byte$13,$StringScanner_match$ques$14,$StringScanner_pos$eq$15,$StringScanner_matched_size$16,$StringScanner_post_match$17,$StringScanner_pre_match$18,$StringScanner_reset$19,$StringScanner_rest$20,$StringScanner_rest$ques$21,$StringScanner_rest_size$22,$StringScanner_terminate$23,$StringScanner_unscan$24,$StringScanner_anchor$25,self=$klass($base,null,"StringScanner"),$nesting=[self].concat($parent_nesting);return self.$$prototype.pos=self.$$prototype.string=self.$$prototype.working=self.$$prototype.matched=self.$$prototype.prev_pos=self.$$prototype.match=nil,self.$attr_reader("pos"),self.$attr_reader("matched"),Opal.def(self,"$initialize",$StringScanner_initialize$1=function(string){return this.string=string,this.pos=0,this.matched=nil,this.working=string,this.match=[]},$StringScanner_initialize$1.$$arity=1),self.$attr_reader("string"),Opal.def(self,"$beginning_of_line?",$StringScanner_beginning_of_line$ques$2=function(){return 0===this.pos||"\n"===this.string.charAt(this.pos-1)},$StringScanner_beginning_of_line$ques$2.$$arity=0),$alias(self,"bol?","beginning_of_line?"),Opal.def(self,"$scan",$StringScanner_scan$3=function(pattern){var result=(pattern=this.$anchor(pattern)).exec(this.working);return null==result?this.matched=nil:"object"==typeof result?(this.prev_pos=this.pos,this.pos+=result[0].length,this.working=this.working.substring(result[0].length),this.matched=result[0],this.match=result,result[0]):"string"==typeof result?(this.pos+=result.length,this.working=this.working.substring(result.length),result):nil},$StringScanner_scan$3.$$arity=1),Opal.def(self,"$scan_until",$StringScanner_scan_until$4=function(pattern){pattern=this.$anchor(pattern);for(var result,pos=this.pos,working=this.working;;){if(result=pattern.exec(working),pos+=1,working=working.substr(1),null!=result)return this.matched=this.string.substr(this.pos,pos-this.pos-1+result[0].length),this.match=result,this.prev_pos=pos-1,this.pos=pos,this.working=working.substr(result[0].length),this.matched;if(0===working.length)return this.match=[],this.matched=nil}},$StringScanner_scan_until$4.$$arity=1),Opal.def(self,"$[]",$StringScanner_$$$5=function(idx){var $case;if($truthy(this.match["$empty?"]()))return nil;$case=idx,$$($nesting,"Symbol")["$==="]($case)?idx=idx.$to_s():$$($nesting,"String")["$==="]($case)||(idx=$$($nesting,"Opal")["$coerce_to!"](idx,$$($nesting,"Integer"),"to_int"));var match=this.match;return idx<0&&(idx+=match.length),idx<0||idx>=match.length||null==match[idx]?nil:match[idx]},$StringScanner_$$$5.$$arity=1),Opal.def(self,"$check",$StringScanner_check$6=function(pattern){var result=(pattern=this.$anchor(pattern)).exec(this.working);return this.matched=null==result?nil:result[0]},$StringScanner_check$6.$$arity=1),Opal.def(self,"$check_until",$StringScanner_check_until$7=function(pattern){var prev_pos=this.prev_pos,pos=this.pos,result=this.$scan_until(pattern);return result!==nil&&(this.matched=result.substr(-1),this.working=this.string.substr(pos)),this.prev_pos=prev_pos,this.pos=pos,result},$StringScanner_check_until$7.$$arity=1),Opal.def(self,"$peek",$StringScanner_peek$8=function(length){return this.working.substring(0,length)},$StringScanner_peek$8.$$arity=1),Opal.def(self,"$eos?",$StringScanner_eos$ques$9=function(){return 0===this.working.length},$StringScanner_eos$ques$9.$$arity=0),Opal.def(self,"$exist?",$StringScanner_exist$ques$10=function(pattern){var result=pattern.exec(this.working);return null==result?nil:0==result.index?0:result.index+1},$StringScanner_exist$ques$10.$$arity=1),Opal.def(self,"$skip",$StringScanner_skip$11=function(pattern){var result=(pattern=this.$anchor(pattern)).exec(this.working);if(null==result)return this.match=[],this.matched=nil;var match_str=result[0],match_len=match_str.length;return this.matched=match_str,this.match=result,this.prev_pos=this.pos,this.pos+=match_len,this.working=this.working.substring(match_len),match_len},$StringScanner_skip$11.$$arity=1),Opal.def(self,"$skip_until",$StringScanner_skip_until$12=function(pattern){var result=this.$scan_until(pattern);return result===nil?nil:(this.matched=result.substr(-1),result.length)},$StringScanner_skip_until$12.$$arity=1),Opal.def(self,"$get_byte",$StringScanner_get_byte$13=function(){var result=nil;return this.pos<this.string.length?(this.prev_pos=this.pos,this.pos+=1,result=this.matched=this.working.substring(0,1),this.working=this.working.substring(1)):this.matched=nil,result},$StringScanner_get_byte$13.$$arity=0),$alias(self,"getch","get_byte"),Opal.def(self,"$match?",$StringScanner_match$ques$14=function(pattern){var result=(pattern=this.$anchor(pattern)).exec(this.working);return null==result?nil:(this.prev_pos=this.pos,result[0].length)},$StringScanner_match$ques$14.$$arity=1),Opal.def(self,"$pos=",$StringScanner_pos$eq$15=function(pos){return pos<0&&(pos+=this.string.$length()),this.pos=pos,this.working=this.string.slice(pos)},$StringScanner_pos$eq$15.$$arity=1),Opal.def(self,"$matched_size",$StringScanner_matched_size$16=function(){return this.matched===nil?nil:this.matched.length},$StringScanner_matched_size$16.$$arity=0),Opal.def(self,"$post_match",$StringScanner_post_match$17=function(){return this.matched===nil?nil:this.string.substr(this.pos)},$StringScanner_post_match$17.$$arity=0),Opal.def(self,"$pre_match",$StringScanner_pre_match$18=function(){return this.matched===nil?nil:this.string.substr(0,this.prev_pos)},$StringScanner_pre_match$18.$$arity=0),Opal.def(self,"$reset",$StringScanner_reset$19=function(){return this.working=this.string,this.matched=nil,this.pos=0},$StringScanner_reset$19.$$arity=0),Opal.def(self,"$rest",$StringScanner_rest$20=function(){return this.working},$StringScanner_rest$20.$$arity=0),Opal.def(self,"$rest?",$StringScanner_rest$ques$21=function(){return 0!==this.working.length},$StringScanner_rest$ques$21.$$arity=0),Opal.def(self,"$rest_size",$StringScanner_rest_size$22=function(){return this.$rest().$size()},$StringScanner_rest_size$22.$$arity=0),Opal.def(self,"$terminate",$StringScanner_terminate$23=function(){var $writer,lhs,rhs;return this.match=nil,$writer=[this.string.$length()],$send(this,"pos=",Opal.to_a($writer)),$writer[(lhs=$writer.length,rhs=1,"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs))]},$StringScanner_terminate$23.$$arity=0),Opal.def(self,"$unscan",$StringScanner_unscan$24=function(){return this.pos=this.prev_pos,this.prev_pos=nil,this.match=nil,this},$StringScanner_unscan$24.$$arity=0),self.$private(),Opal.def(self,"$anchor",$StringScanner_anchor$25=function(pattern){var flags=pattern.toString().match(/\/([^\/]+)$/);return flags=flags?flags[1]:void 0,new RegExp("^(?:"+pattern.source+")",flags)},$StringScanner_anchor$25.$$arity=1),nil&&"anchor"}($nesting[0],0,$nesting)};
