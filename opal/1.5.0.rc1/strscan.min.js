Opal.modules.strscan=function(Opal){var $nesting=[],nil=Opal.nil,$klass=Opal.klass,$def=Opal.def,$truthy=Opal.truthy,$eqeqeq=Opal.eqeqeq,$Opal=Opal.Opal,$return_ivar=Opal.return_ivar,$send=Opal.send,$alias=Opal.alias;return Opal.add_stubs("attr_reader,anchor,empty?,===,to_s,coerce_to!,scan_until,length,size,rest,pos=,beginning_of_line?,get_byte,private"),function($base,$super,$parent_nesting){var self=$klass($base,null,"StringScanner"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting),$proto=self.$$prototype;return $proto.pos=$proto.string=$proto.working=$proto.matched=$proto.prev_pos=$proto.match=nil,self.$attr_reader("pos","matched"),$def(self,"$initialize",(function(string){return this.string=string,this.pos=0,this.matched=nil,this.working=string,this.match=[]}),1),self.$attr_reader("string"),$def(self,"$beginning_of_line?",(function(){return 0===this.pos||"\n"===this.string.charAt(this.pos-1)}),0),$def(self,"$scan",(function(pattern){var result=(pattern=this.$anchor(pattern)).exec(this.working);return null==result?this.matched=nil:"object"==typeof result?(this.prev_pos=this.pos,this.pos+=result[0].length,this.working=this.working.substring(result[0].length),this.matched=result[0],this.match=result,result[0]):"string"==typeof result?(this.pos+=result.length,this.working=this.working.substring(result.length),result):nil}),1),$def(self,"$scan_until",(function(pattern){pattern=this.$anchor(pattern);for(var result,pos=this.pos,working=this.working;;){if(result=pattern.exec(working),pos+=1,working=working.substr(1),null!=result)return this.matched=this.string.substr(this.pos,pos-this.pos-1+result[0].length),this.match=result,this.prev_pos=pos-1,this.pos=pos,this.working=working.substr(result[0].length),this.matched;if(0===working.length)return this.match=[],this.matched=nil}}),1),$def(self,"$[]",(function(idx){var $ret_or_1;if($truthy(this.match["$empty?"]()))return nil;$eqeqeq($$("Symbol"),$ret_or_1=idx)?idx=idx.$to_s():$eqeqeq($$("String"),$ret_or_1)||(idx=$Opal["$coerce_to!"](idx,$$("Integer"),"to_int"));var match=this.match;return idx<0&&(idx+=match.length),idx<0||idx>=match.length||null==match[idx]?nil:match[idx]}),1),$def(self,"$check",(function(pattern){var result=(pattern=this.$anchor(pattern)).exec(this.working);return this.matched=null==result?nil:result[0]}),1),$def(self,"$check_until",(function(pattern){var prev_pos=this.prev_pos,pos=this.pos,result=this.$scan_until(pattern);return result!==nil&&(this.matched=result.substr(-1),this.working=this.string.substr(pos)),this.prev_pos=prev_pos,this.pos=pos,result}),1),$def(self,"$peek",(function(length){return this.working.substring(0,length)}),1),$def(self,"$eos?",(function(){return 0===this.working.length}),0),$def(self,"$exist?",(function(pattern){var result=pattern.exec(this.working);return null==result?nil:0==result.index?0:result.index+1}),1),$def(self,"$skip",(function(pattern){var result=(pattern=this.$anchor(pattern)).exec(this.working);if(null==result)return this.match=[],this.matched=nil;var match_str=result[0],match_len=match_str.length;return this.matched=match_str,this.match=result,this.prev_pos=this.pos,this.pos+=match_len,this.working=this.working.substring(match_len),match_len}),1),$def(self,"$skip_until",(function(pattern){var result=this.$scan_until(pattern);return result===nil?nil:(this.matched=result.substr(-1),result.length)}),1),$def(self,"$get_byte",(function(){var result=nil;return this.pos<this.string.length?(this.prev_pos=this.pos,this.pos+=1,result=this.matched=this.working.substring(0,1),this.working=this.working.substring(1)):this.matched=nil,result}),0),$def(self,"$match?",(function(pattern){var result=(pattern=this.$anchor(pattern)).exec(this.working);return null==result?nil:(this.prev_pos=this.pos,result[0].length)}),1),$def(self,"$pos=",(function(pos){return pos<0&&(pos+=this.string.$length()),this.pos=pos,this.working=this.string.slice(pos)}),1),$def(self,"$matched_size",(function(){return this.matched===nil?nil:this.matched.length}),0),$def(self,"$post_match",(function(){return this.matched===nil?nil:this.string.substr(this.pos)}),0),$def(self,"$pre_match",(function(){return this.matched===nil?nil:this.string.substr(0,this.prev_pos)}),0),$def(self,"$reset",(function(){return this.working=this.string,this.matched=nil,this.pos=0}),0),$def(self,"$rest",$return_ivar("working"),0),$def(self,"$rest?",(function(){return 0!==this.working.length}),0),$def(self,"$rest_size",(function(){return this.$rest().$size()}),0),$def(self,"$terminate",(function(){var $a;return this.match=nil,$a=[this.string.$length()],$send(this,"pos=",$a),$a[$a.length-1]}),0),$def(self,"$unscan",(function(){return this.pos=this.prev_pos,this.prev_pos=nil,this.match=nil,this}),0),$alias(self,"bol?","beginning_of_line?"),$alias(self,"getch","get_byte"),self.$private(),$def(self,"$anchor",(function(pattern){var flags=pattern.toString().match(/\/([^\/]+)$/);return flags=flags?flags[1]:void 0,new RegExp("^(?:"+pattern.source+")",flags)}),1)}($nesting[0],0,$nesting)};
