Opal.modules["matrix/lup_decomposition"]=function(Opal){var $klass=Opal.klass,$send=Opal.send,$truthy=Opal.truthy,$rb_gt=Opal.rb_gt,$eqeq=Opal.eqeq,$def=Opal.def,$rb_le=Opal.rb_le,$thrower=Opal.thrower,$neqeq=Opal.neqeq,$rb_times=Opal.rb_times,$rb_plus=Opal.rb_plus,$rb_minus=Opal.rb_minus,$to_a=Opal.to_a,$rb_lt=Opal.rb_lt,$nesting=[],nil=Opal.nil,$$$=Opal.$$$;return Opal.add_stubs("include,build,min,>,[],==,<=,new,each_with_index,[]=,send,l,u,p,alias_method,attr_reader,times,!=,Raise,*,singular?,is_a?,row_count,column_count,map,to_a,row,upto,+,-,downto,quo,convert_to_array,size,values_at,elements,raise,class,abs,-@,<"),function($base,$super,$parent_nesting){var $nesting=[$klass($base,null,"Matrix")].concat($parent_nesting);return function($base,$super,$parent_nesting){var self=$klass($base,null,"LUPDecomposition"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting),$proto=self.$$prototype;return $proto.row_count=$proto.column_count=$proto.pivots=$proto.pivot_sign=nil,self.$include($$$($$("Matrix"),"ConversionHelper")),$def(self,"$l",(function(){return $send($$("Matrix"),"build",[this.row_count,[this.column_count,this.row_count].$min()],(function $$1(i,j){var self=null==$$1.$$s?this:$$1.$$s;return null==self.lu&&(self.lu=nil),null==i&&(i=nil),null==j&&(j=nil),$truthy($rb_gt(i,j))?self.lu["$[]"](i)["$[]"](j):$eqeq(i,j)?1:0}),{$$arity:2,$$s:this})}),0),$def(self,"$u",(function(){return $send($$("Matrix"),"build",[[this.column_count,this.row_count].$min(),this.column_count],(function $$2(i,j){var self=null==$$2.$$s?this:$$2.$$s;return null==self.lu&&(self.lu=nil),null==i&&(i=nil),null==j&&(j=nil),$truthy($rb_le(i,j))?self.lu["$[]"](i)["$[]"](j):0}),{$$arity:2,$$s:this})}),0),$def(self,"$p",(function(){var rows=nil;return rows=$send($$("Array"),"new",[this.row_count],(function $$3(){var self=null==$$3.$$s?this:$$3.$$s;return null==self.row_count&&(self.row_count=nil),$$("Array").$new(self.row_count,0)}),{$$arity:0,$$s:this}),$send(this.pivots,"each_with_index",[],(function(p,i){var $a;return null==p&&(p=nil),null==i&&(i=nil),$a=[p,1],$send(rows["$[]"](i),"[]=",$a),$a[$a.length-1]}),2),$$("Matrix").$send("new",rows,this.row_count)}),0),$def(self,"$to_ary",(function(){return[this.$l(),this.$u(),this.$p()]}),0),self.$alias_method("to_a","to_ary"),self.$attr_reader("pivots"),$def(self,"$singular?",(function(){try{var $t_return=$thrower("return");return $send(this.column_count,"times",[],(function $$6(j){var self=null==$$6.$$s?this:$$6.$$s;if(null==self.lu&&(self.lu=nil),null==j&&(j=nil),!$eqeq(self.lu["$[]"](j)["$[]"](j),0))return nil;$t_return.$throw(!0)}),{$$arity:1,$$s:this,$$ret:$t_return}),!1}catch($e){if($e===$t_return)return $e.$v;throw $e}}),0),$def(self,"$det",(function(){var d=nil;return $neqeq(this.row_count,this.column_count)&&$$("Matrix").$Raise($$$($$("Matrix"),"ErrDimensionMismatch")),d=this.pivot_sign,$send(this.column_count,"times",[],(function $$7(j){var self=null==$$7.$$s?this:$$7.$$s;return null==self.lu&&(self.lu=nil),null==j&&(j=nil),d=$rb_times(d,self.lu["$[]"](j)["$[]"](j))}),{$$arity:1,$$s:this}),d}),0),self.$alias_method("determinant","det"),$def(self,"$solve",(function(b){var nx=nil,m=nil;return $truthy(this["$singular?"]())&&$$("Matrix").$Raise($$$($$("Matrix"),"ErrNotRegular"),"Matrix is singular."),$truthy(b["$is_a?"]($$("Matrix")))?($neqeq(b.$row_count(),this.row_count)&&$$("Matrix").$Raise($$$($$("Matrix"),"ErrDimensionMismatch")),nx=b.$column_count(),m=$send(this.pivots,"map",[],(function(row){return null==row&&(row=nil),b.$row(row).$to_a()}),1),$send(this.column_count,"times",[],(function $$9(k){var self=null==$$9.$$s?this:$$9.$$s;return null==self.column_count&&(self.column_count=nil),null==k&&(k=nil),$send($rb_plus(k,1),"upto",[$rb_minus(self.column_count,1)],(function $$10(i){return null==i&&(i=nil),$send(nx,"times",[],(function $$11(j){var $a,self=null==$$11.$$s?this:$$11.$$s,$binary_op_recvr_tmp_3=nil;return null==self.lu&&(self.lu=nil),null==j&&(j=nil),$binary_op_recvr_tmp_3=m["$[]"](i),$a=[j,$rb_minus($binary_op_recvr_tmp_3["$[]"](j),$rb_times(m["$[]"](k)["$[]"](j),self.lu["$[]"](i)["$[]"](k)))],$send($binary_op_recvr_tmp_3,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:null==$$10.$$s?this:$$10.$$s})}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:this}),$send($rb_minus(this.column_count,1),"downto",[0],(function $$12(k){var self=null==$$12.$$s?this:$$12.$$s;return null==k&&(k=nil),$send(nx,"times",[],(function $$13(j){var $a,self=null==$$13.$$s?this:$$13.$$s;return null==self.lu&&(self.lu=nil),null==j&&(j=nil),$a=[j,m["$[]"](k)["$[]"](j).$quo(self.lu["$[]"](k)["$[]"](k))],$send(m["$[]"](k),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}),$send(k,"times",[],(function $$14(i){return null==i&&(i=nil),$send(nx,"times",[],(function $$15(j){var $a,self=null==$$15.$$s?this:$$15.$$s,$binary_op_recvr_tmp_4=nil;return null==self.lu&&(self.lu=nil),null==j&&(j=nil),$binary_op_recvr_tmp_4=m["$[]"](i),$a=[j,$rb_minus($binary_op_recvr_tmp_4["$[]"](j),$rb_times(m["$[]"](k)["$[]"](j),self.lu["$[]"](i)["$[]"](k)))],$send($binary_op_recvr_tmp_4,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:null==$$14.$$s?this:$$14.$$s})}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:this}),$$("Matrix").$send("new",m,nx)):(b=this.$convert_to_array(b),$neqeq(b.$size(),this.row_count)&&$$("Matrix").$Raise($$$($$("Matrix"),"ErrDimensionMismatch")),m=$send(b,"values_at",$to_a(this.pivots)),$send(this.column_count,"times",[],(function $$16(k){var self=null==$$16.$$s?this:$$16.$$s;return null==self.column_count&&(self.column_count=nil),null==k&&(k=nil),$send($rb_plus(k,1),"upto",[$rb_minus(self.column_count,1)],(function $$17(i){var $a,self=null==$$17.$$s?this:$$17.$$s;return null==self.lu&&(self.lu=nil),null==i&&(i=nil),$a=[i,$rb_minus(m["$[]"](i),$rb_times(m["$[]"](k),self.lu["$[]"](i)["$[]"](k)))],$send(m,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:this}),$send($rb_minus(this.column_count,1),"downto",[0],(function $$18(k){var self=null==$$18.$$s?this:$$18.$$s;return null==self.lu&&(self.lu=nil),null==k&&(k=nil),m["$[]="](k,m["$[]"](k).$quo(self.lu["$[]"](k)["$[]"](k))),$send(k,"times",[],(function $$19(i){var $a,self=null==$$19.$$s?this:$$19.$$s;return null==self.lu&&(self.lu=nil),null==i&&(i=nil),$a=[i,$rb_minus(m["$[]"](i),$rb_times(m["$[]"](k),self.lu["$[]"](i)["$[]"](k)))],$send(m,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:this}),$$("Vector").$elements(m,!1))}),1),$def(self,"$initialize",(function(a){var lu_col_j=nil;return $truthy(a["$is_a?"]($$("Matrix")))||this.$raise($$("TypeError"),"Expected Matrix but got "+a.$class()),this.lu=a.$to_a(),this.row_count=a.$row_count(),this.column_count=a.$column_count(),this.pivots=$$("Array").$new(this.row_count),$send(this.row_count,"times",[],(function $$20(i){var $a,self=null==$$20.$$s?this:$$20.$$s;return null==self.pivots&&(self.pivots=nil),null==i&&(i=nil),$a=[i,i],$send(self.pivots,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:this}),this.pivot_sign=1,lu_col_j=$$("Array").$new(this.row_count),$send(this.column_count,"times",[],(function $$21(j){var self=null==$$21.$$s?this:$$21.$$s,p=nil,k=nil;return null==self.row_count&&(self.row_count=nil),null==self.column_count&&(self.column_count=nil),null==self.pivots&&(self.pivots=nil),null==self.pivot_sign&&(self.pivot_sign=nil),null==self.lu&&(self.lu=nil),null==j&&(j=nil),$send(self.row_count,"times",[],(function $$22(i){var $a,self=null==$$22.$$s?this:$$22.$$s;return null==self.lu&&(self.lu=nil),null==i&&(i=nil),$a=[i,self.lu["$[]"](i)["$[]"](j)],$send(lu_col_j,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}),$send(self.row_count,"times",[],(function $$23(i){var $a,$b,kmax,self=null==$$23.$$s?this:$$23.$$s,lu_row_i=nil,s=nil;return null==self.lu&&(self.lu=nil),null==i&&(i=nil),lu_row_i=self.lu["$[]"](i),kmax=[i,j].$min(),s=0,$send(kmax,"times",[],(function(k){return null==k&&(k=nil),s=$rb_plus(s,$rb_times(lu_row_i["$[]"](k),lu_col_j["$[]"](k)))}),1),$a=[j,($b=[i,$rb_minus(lu_col_j["$[]"](i),s)],$send(lu_col_j,"[]=",$b),$b[$b.length-1])],$send(lu_row_i,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}),p=j,$send($rb_plus(j,1),"upto",[$rb_minus(self.row_count,1)],(function(i){return null==i&&(i=nil),$truthy($rb_gt(lu_col_j["$[]"](i).$abs(),lu_col_j["$[]"](p).$abs()))?p=i:nil}),1),$neqeq(p,j)&&($send(self.column_count,"times",[],(function $$26(k){var $a,t,self=null==$$26.$$s?this:$$26.$$s;return null==self.lu&&(self.lu=nil),null==k&&(k=nil),t=self.lu["$[]"](p)["$[]"](k),self.lu["$[]"](p)["$[]="](k,self.lu["$[]"](j)["$[]"](k)),$a=[k,t],$send(self.lu["$[]"](j),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}),k=self.pivots["$[]"](p),self.pivots["$[]="](p,self.pivots["$[]"](j)),self.pivots["$[]="](j,k),self.pivot_sign=self.pivot_sign["$-@"]()),$truthy($rb_lt(j,self.row_count))&&$neqeq(self.lu["$[]"](j)["$[]"](j),0)?$send($rb_plus(j,1),"upto",[$rb_minus(self.row_count,1)],(function $$27(i){var $a,self=null==$$27.$$s?this:$$27.$$s;return null==self.lu&&(self.lu=nil),null==i&&(i=nil),$a=[j,self.lu["$[]"](i)["$[]"](j).$quo(self.lu["$[]"](j)["$[]"](j))],$send(self.lu["$[]"](i),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}):nil}),{$$arity:1,$$s:this})}),1)}($nesting[0],0,$nesting)}($nesting[0],0,$nesting)},Opal.modules.e2mmap=function(Opal){var $module=Opal.module,$const_set=Opal.const_set,$send2=Opal.send2,$find_super=Opal.find_super,$truthy=Opal.truthy,$rb_lt=Opal.rb_lt,$defs=Opal.defs,$send=Opal.send,$slice=Opal.slice,$to_a=Opal.to_a,$def=Opal.def,$alias=Opal.alias,$hash2=Opal.hash2,$gvars=Opal.gvars,$regexp=Opal.regexp,$thrower=Opal.thrower,$nesting=[],nil=Opal.nil;return Opal.add_stubs("<,bind,module_eval,Raise,class,extend,def_e2message,def_exception,instance_eval,[]=,new,const_defined?,remove_const,const_set,e2mm_message,nil?,caller,=~,[],quote,shift,raise,sprintf,Fail,inspect,each,ancestors"),function($base,$parent_nesting){var self=$module($base,"Exception2MessageMapper"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);return $const_set($nesting[0],"E2MM",$$("Exception2MessageMapper")),$defs($$("E2MM"),"$extend_object",(function $$extend_object(cl){var $yield=$$extend_object.$$p||nil;return $$extend_object.$$p=null,$send2(this,$find_super(this,"extend_object",$$extend_object,!1,!0),"extend_object",[cl],$yield),$truthy($rb_lt(cl,$$("E2MM")))?nil:cl.$bind(this)}),1),$def(self,"$bind",(function(cl){return $send(this,"module_eval",[],(function $$1(){var self=null==$$1.$$s?this:$$1.$$s;return $def(self,"$Raise",(function($a,$b){var $post_args,err,rest,self=this;return($post_args=$slice.call(arguments)).length>0&&(err=$post_args.shift()),null==err&&(err=nil),rest=$post_args,$send($$("Exception2MessageMapper"),"Raise",[self.$class(),err].concat($to_a(rest)))}),-1),$alias(self,"Fail","Raise"),function(self,$parent_nesting){Opal.udef(self,"$included")}(Opal.get_singleton_class(self)),$defs(self,"$included",(function(mod){return mod.$extend($$("Exception2MessageMapper"))}),1)}),{$$arity:0,$$s:this})}),1),$def(self,"$Raise",(function($a,$b){var $post_args,err,rest,self=this;return($post_args=$slice.call(arguments)).length>0&&(err=$post_args.shift()),null==err&&(err=nil),rest=$post_args,$send($$("E2MM"),"Raise",[self,err].concat($to_a(rest)))}),-1),$alias(self,"Fail","Raise"),$alias(self,"fail","Raise"),$def(self,"$def_e2message",(function(c,m){return $$("E2MM").$def_e2message(this,c,m)}),2),$def(self,"$def_exception",(function(n,m,s){return null==s&&(s=$$("StandardError")),$$("E2MM").$def_exception(this,n,m,s)}),-3),self.MessageMap=$hash2([],{}),$defs($$("E2MM"),"$def_e2message",(function(k,c,m){return $send($$("E2MM"),"instance_eval",[],(function $$2(){var $a,self=null==$$2.$$s?this:$$2.$$s;return null==self.MessageMap&&(self.MessageMap=nil),$a=[[k,c],m],$send(self.MessageMap,"[]=",$a),$a[$a.length-1]}),{$$arity:0,$$s:this}),c}),3),$defs($$("E2MM"),"$def_exception",(function(k,n,m,s){var e;return null==s&&(s=$$("StandardError")),e=$$("Class").$new(s),$send($$("E2MM"),"instance_eval",[],(function $$3(){var $a,self=null==$$3.$$s?this:$$3.$$s;return null==self.MessageMap&&(self.MessageMap=nil),$a=[[k,e],m],$send(self.MessageMap,"[]=",$a),$a[$a.length-1]}),{$$arity:0,$$s:this}),$truthy(k["$const_defined?"](n,!1))&&$send(k,"module_eval",[],(function $$4(){return(null==$$4.$$s?this:$$4.$$s).$remove_const(n)}),{$$arity:0,$$s:this}),k.$const_set(n,e)}),-4),$defs($$("E2MM"),"$Raise",(function($a,$b,$c){var $post_args,klass,err,rest,self=this,form=nil,b=nil;return null==$gvars["@"]&&($gvars["@"]=nil),($post_args=$slice.call(arguments)).length>0&&(klass=$post_args.shift()),null==klass&&(klass=$$("E2MM")),$post_args.length>0&&(err=$post_args.shift()),null==err&&(err=nil),rest=$post_args,$truthy(form=self.$e2mm_message(klass,err))?(b=$truthy($gvars["@"]["$nil?"]())?self.$caller(1):$gvars["@"],$truthy(b["$[]"](0)["$=~"]($regexp(["^",$$("Regexp").$quote("./e2mmap.rb"),":"])))&&b.$shift(),self.$raise(err,$send(self,"sprintf",[form].concat($to_a(rest))),b)):$$("E2MM").$Fail($$("E2MM"),$$("ErrNotRegisteredException"),err.$inspect())}),-1),function(self,$parent_nesting){$alias(self,"Fail","Raise")}(Opal.get_singleton_class($$("E2MM"))),$defs($$("E2MM"),"$e2mm_message",(function(klass,exp){try{var $t_return=$thrower("return");return $send(klass.$ancestors(),"each",[],(function $$5(c){var mes,self=null==$$5.$$s?this:$$5.$$s;if(null==self.MessageMap&&(self.MessageMap=nil),null==c&&(c=nil),!$truthy(mes=self.MessageMap["$[]"]([c,exp])))return nil;$t_return.$throw(mes)}),{$$arity:1,$$s:this,$$ret:$t_return}),nil}catch($e){if($e===$t_return)return $e.$v;throw $e}}),2),function(self,$parent_nesting){$alias(self,"message","e2mm_message")}(Opal.get_singleton_class(self)),$$("E2MM").$def_exception($$("E2MM"),"ErrNotRegisteredException","not registered exception(%s)")}($nesting[0],$nesting)},Opal.modules["matrix/eigenvalue_decomposition"]=function(Opal){var $klass=Opal.klass,$truthy=Opal.truthy,$send=Opal.send,$def=Opal.def,$alias=Opal.alias,$eqeq=Opal.eqeq,$to_a=Opal.to_a,$rb_gt=Opal.rb_gt,$rb_plus=Opal.rb_plus,$rb_minus=Opal.rb_minus,$rb_divide=Opal.rb_divide,$rb_times=Opal.rb_times,$neqeq=Opal.neqeq,$rb_lt=Opal.rb_lt,$rb_le=Opal.rb_le,$rb_ge=Opal.rb_ge,$to_ary=Opal.to_ary,$nesting=[],nil=Opal.nil,$$$=Opal.$$$;return Opal.add_stubs("is_a?,raise,class,row_count,new,symmetric?,to_a,tridiagonalize,diagonalize,reduce_to_hessenberg,hessenberg_to_real_schur,send,transpose,build_eigenvectors,eigenvector_matrix,inverse,eigenvector_matrix_inv,dup,each_with_index,==,[]=,Complex,[],map,diagonal,eigenvalues,eigenvalue_matrix,v,d,v_inv,alias_method,private,>,+,-,-@,abs,/,*,times,downto,sqrt,upto,!=,max,<,<=,hypot,>=,min,cdiv"),function($base,$super,$parent_nesting){var $nesting=[$klass($base,null,"Matrix")].concat($parent_nesting);return function($base,$super,$parent_nesting){var self=$klass($base,null,"EigenvalueDecomposition"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting),$proto=self.$$prototype;return $proto.size=$proto.symmetric=$proto.d=$proto.e=$proto.v=$proto.h=nil,$def(self,"$initialize",(function(a){return $truthy(a["$is_a?"]($$("Matrix")))||this.$raise($$("TypeError"),"Expected Matrix but got "+a.$class()),this.size=a.$row_count(),this.d=$$("Array").$new(this.size,0),this.e=$$("Array").$new(this.size,0),$truthy(this.symmetric=a["$symmetric?"]())?(this.v=a.$to_a(),this.$tridiagonalize(),this.$diagonalize()):(this.v=$send($$("Array"),"new",[this.size],(function $$1(){var self=null==$$1.$$s?this:$$1.$$s;return null==self.size&&(self.size=nil),$$("Array").$new(self.size,0)}),{$$arity:0,$$s:this}),this.h=a.$to_a(),this.ort=$$("Array").$new(this.size,0),this.$reduce_to_hessenberg(),this.$hessenberg_to_real_schur())}),1),$def(self,"$eigenvector_matrix",(function(){return $$("Matrix").$send("new",this.$build_eigenvectors().$transpose())}),0),$alias(self,"v","eigenvector_matrix"),$def(self,"$eigenvector_matrix_inv",(function(){var r=nil;return r=$$("Matrix").$send("new",this.$build_eigenvectors()),$truthy(this.symmetric)||(r=r.$transpose().$inverse()),r}),0),$alias(self,"v_inv","eigenvector_matrix_inv"),$def(self,"$eigenvalues",(function(){var values=nil;return values=this.d.$dup(),$send(this.e,"each_with_index",[],(function $$2(imag,i){var $a,self=null==$$2.$$s?this:$$2.$$s;return null==imag&&(imag=nil),null==i&&(i=nil),$eqeq(imag,0)?nil:($a=[i,self.$Complex(values["$[]"](i),imag)],$send(values,"[]=",$a),$a[$a.length-1])}),{$$arity:2,$$s:this}),values}),0),$def(self,"$eigenvectors",(function(){return $send(this.$build_eigenvectors(),"map",[],(function(ev){return null==ev&&(ev=nil),$$("Vector").$send("new",ev)}),1)}),0),$def(self,"$eigenvalue_matrix",(function(){return $send($$("Matrix"),"diagonal",$to_a(this.$eigenvalues()))}),0),$alias(self,"d","eigenvalue_matrix"),$def(self,"$to_ary",(function(){return[this.$v(),this.$d(),this.$v_inv()]}),0),self.$alias_method("to_a","to_ary"),self.$private(),$def(self,"$build_eigenvectors",(function(){return $send(this.e.$each_with_index(),"map",[],(function $$4(imag,i){var self=null==$$4.$$s?this:$$4.$$s;return null==self.size&&(self.size=nil),null==imag&&(imag=nil),null==i&&(i=nil),$eqeq(imag,0)?$send($$("Array"),"new",[self.size],(function $$5(j){var self=null==$$5.$$s?this:$$5.$$s;return null==self.v&&(self.v=nil),null==j&&(j=nil),self.v["$[]"](j)["$[]"](i)}),{$$arity:1,$$s:self}):$truthy($rb_gt(imag,0))?$send($$("Array"),"new",[self.size],(function $$6(j){var self=null==$$6.$$s?this:$$6.$$s;return null==self.v&&(self.v=nil),null==j&&(j=nil),self.$Complex(self.v["$[]"](j)["$[]"](i),self.v["$[]"](j)["$[]"]($rb_plus(i,1)))}),{$$arity:1,$$s:self}):$send($$("Array"),"new",[self.size],(function $$7(j){var self=null==$$7.$$s?this:$$7.$$s;return null==self.v&&(self.v=nil),null==j&&(j=nil),self.$Complex(self.v["$[]"](j)["$[]"]($rb_minus(i,1)),self.v["$[]"](j)["$[]"](i)["$-@"]())}),{$$arity:1,$$s:self})}),{$$arity:2,$$s:this})}),0),$def(self,"$cdiv",(function(xr,xi,yr,yi){var r=nil,d=nil;return $truthy($rb_gt(yr.$abs(),yi.$abs()))?(r=$rb_divide(yi,yr),d=$rb_plus(yr,$rb_times(r,yi)),[$rb_divide($rb_plus(xr,$rb_times(r,xi)),d),$rb_divide($rb_minus(xi,$rb_times(r,xr)),d)]):(r=$rb_divide(yr,yi),d=$rb_plus(yi,$rb_times(r,yr)),[$rb_divide($rb_plus($rb_times(r,xr),xi),d),$rb_divide($rb_minus($rb_times(r,xi),xr),d)])}),4),$def(self,"$tridiagonalize",(function(){var $a;return $send(this.size,"times",[],(function $$8(j){var $a,self=null==$$8.$$s?this:$$8.$$s;return null==self.v&&(self.v=nil),null==self.size&&(self.size=nil),null==self.d&&(self.d=nil),null==j&&(j=nil),$a=[j,self.v["$[]"]($rb_minus(self.size,1))["$[]"](j)],$send(self.d,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:this}),$send($rb_minus(this.size,1),"downto",[$rb_plus(0,1)],(function $$9(i){var $a,self=null==$$9.$$s?this:$$9.$$s,scale=nil,h=nil,f=nil,g=nil,hh=nil;return null==self.e&&(self.e=nil),null==self.d&&(self.d=nil),null==i&&(i=nil),scale=0,h=0,$send(i,"times",[],(function $$10(k){var self=null==$$10.$$s?this:$$10.$$s;return null==self.d&&(self.d=nil),null==k&&(k=nil),scale=$rb_plus(scale,self.d["$[]"](k).$abs())}),{$$arity:1,$$s:self}),$eqeq(scale,0)?(self.e["$[]="](i,self.d["$[]"]($rb_minus(i,1))),$send(i,"times",[],(function $$11(j){var $a,self=null==$$11.$$s?this:$$11.$$s;return null==self.d&&(self.d=nil),null==self.v&&(self.v=nil),null==j&&(j=nil),self.d["$[]="](j,self.v["$[]"]($rb_minus(i,1))["$[]"](j)),self.v["$[]"](i)["$[]="](j,0),$a=[i,0],$send(self.v["$[]"](j),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self})):($send(i,"times",[],(function $$12(k){var self=null==$$12.$$s?this:$$12.$$s;return null==self.d&&(self.d=nil),null==k&&(k=nil),self.d["$[]="](k,$rb_divide(self.d["$[]"](k),scale)),h=$rb_plus(h,$rb_times(self.d["$[]"](k),self.d["$[]"](k)))}),{$$arity:1,$$s:self}),f=self.d["$[]"]($rb_minus(i,1)),g=$$("Math").$sqrt(h),$truthy($rb_gt(f,0))&&(g=g["$-@"]()),self.e["$[]="](i,$rb_times(scale,g)),h=$rb_minus(h,$rb_times(f,g)),self.d["$[]="]($rb_minus(i,1),$rb_minus(f,g)),$send(i,"times",[],(function $$13(j){var $a,self=null==$$13.$$s?this:$$13.$$s;return null==self.e&&(self.e=nil),null==j&&(j=nil),$a=[j,0],$send(self.e,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}),$send(i,"times",[],(function $$14(j){var $a,self=null==$$14.$$s?this:$$14.$$s;return null==self.d&&(self.d=nil),null==self.v&&(self.v=nil),null==self.e&&(self.e=nil),null==j&&(j=nil),f=self.d["$[]"](j),self.v["$[]"](j)["$[]="](i,f),g=$rb_plus(self.e["$[]"](j),$rb_times(self.v["$[]"](j)["$[]"](j),f)),$send($rb_plus(j,1),"upto",[$rb_minus(i,1)],(function $$15(k){var $a,self=null==$$15.$$s?this:$$15.$$s;return null==self.v&&(self.v=nil),null==self.d&&(self.d=nil),null==self.e&&(self.e=nil),null==k&&(k=nil),g=$rb_plus(g,$rb_times(self.v["$[]"](k)["$[]"](j),self.d["$[]"](k))),$a=[k,$rb_plus(self.e["$[]"](k),$rb_times(self.v["$[]"](k)["$[]"](j),f))],$send(self.e,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}),$a=[j,g],$send(self.e,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}),f=0,$send(i,"times",[],(function $$16(j){var self=null==$$16.$$s?this:$$16.$$s;return null==self.e&&(self.e=nil),null==self.d&&(self.d=nil),null==j&&(j=nil),self.e["$[]="](j,$rb_divide(self.e["$[]"](j),h)),f=$rb_plus(f,$rb_times(self.e["$[]"](j),self.d["$[]"](j)))}),{$$arity:1,$$s:self}),hh=$rb_divide(f,$rb_plus(h,h)),$send(i,"times",[],(function $$17(j){var $a,self=null==$$17.$$s?this:$$17.$$s;return null==self.e&&(self.e=nil),null==self.d&&(self.d=nil),null==j&&(j=nil),$a=[j,$rb_minus(self.e["$[]"](j),$rb_times(hh,self.d["$[]"](j)))],$send(self.e,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}),$send(i,"times",[],(function $$18(j){var $a,self=null==$$18.$$s?this:$$18.$$s;return null==self.d&&(self.d=nil),null==self.e&&(self.e=nil),null==self.v&&(self.v=nil),null==j&&(j=nil),f=self.d["$[]"](j),g=self.e["$[]"](j),$send(j,"upto",[$rb_minus(i,1)],(function $$19(k){var $a,self=null==$$19.$$s?this:$$19.$$s,$binary_op_recvr_tmp_5=nil;return null==self.v&&(self.v=nil),null==self.e&&(self.e=nil),null==self.d&&(self.d=nil),null==k&&(k=nil),$binary_op_recvr_tmp_5=self.v["$[]"](k),$a=[j,$rb_minus($binary_op_recvr_tmp_5["$[]"](j),$rb_plus($rb_times(f,self.e["$[]"](k)),$rb_times(g,self.d["$[]"](k))))],$send($binary_op_recvr_tmp_5,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}),self.d["$[]="](j,self.v["$[]"]($rb_minus(i,1))["$[]"](j)),$a=[j,0],$send(self.v["$[]"](i),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self})),$a=[i,h],$send(self.d,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:this}),$send(0,"upto",[$rb_minus($rb_minus(this.size,1),1)],(function $$20(i){var h,self=null==$$20.$$s?this:$$20.$$s;return null==self.v&&(self.v=nil),null==self.size&&(self.size=nil),null==self.d&&(self.d=nil),null==i&&(i=nil),self.v["$[]"]($rb_minus(self.size,1))["$[]="](i,self.v["$[]"](i)["$[]"](i)),self.v["$[]"](i)["$[]="](i,1),h=self.d["$[]"]($rb_plus(i,1)),$neqeq(h,0)&&($send(0,"upto",[i],(function $$21(k){var $a,self=null==$$21.$$s?this:$$21.$$s;return null==self.v&&(self.v=nil),null==self.d&&(self.d=nil),null==k&&(k=nil),$a=[k,$rb_divide(self.v["$[]"](k)["$[]"]($rb_plus(i,1)),h)],$send(self.d,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}),$send(0,"upto",[i],(function $$22(j){var self=null==$$22.$$s?this:$$22.$$s,g=nil;return null==j&&(j=nil),g=0,$send(0,"upto",[i],(function $$23(k){var self=null==$$23.$$s?this:$$23.$$s;return null==self.v&&(self.v=nil),null==k&&(k=nil),g=$rb_plus(g,$rb_times(self.v["$[]"](k)["$[]"]($rb_plus(i,1)),self.v["$[]"](k)["$[]"](j)))}),{$$arity:1,$$s:self}),$send(0,"upto",[i],(function $$24(k){var $a,self=null==$$24.$$s?this:$$24.$$s,$binary_op_recvr_tmp_6=nil;return null==self.v&&(self.v=nil),null==self.d&&(self.d=nil),null==k&&(k=nil),$binary_op_recvr_tmp_6=self.v["$[]"](k),$a=[j,$rb_minus($binary_op_recvr_tmp_6["$[]"](j),$rb_times(g,self.d["$[]"](k)))],$send($binary_op_recvr_tmp_6,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:self})),$send(0,"upto",[i],(function $$25(k){var $a,self=null==$$25.$$s?this:$$25.$$s;return null==self.v&&(self.v=nil),null==k&&(k=nil),$a=[$rb_plus(i,1),0],$send(self.v["$[]"](k),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:this}),$send(this.size,"times",[],(function $$26(j){var $a,self=null==$$26.$$s?this:$$26.$$s;return null==self.d&&(self.d=nil),null==self.v&&(self.v=nil),null==self.size&&(self.size=nil),null==j&&(j=nil),self.d["$[]="](j,self.v["$[]"]($rb_minus(self.size,1))["$[]"](j)),$a=[j,0],$send(self.v["$[]"]($rb_minus(self.size,1)),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:this}),this.v["$[]"]($rb_minus(this.size,1))["$[]="]($rb_minus(this.size,1),1),$a=[0,0],$send(this.e,"[]=",$a),$a[$a.length-1]}),0),$def(self,"$diagonalize",(function(){var eps,f=nil,tst1=nil;return $send(1,"upto",[$rb_minus(this.size,1)],(function $$27(i){var $a,self=null==$$27.$$s?this:$$27.$$s;return null==self.e&&(self.e=nil),null==i&&(i=nil),$a=[$rb_minus(i,1),self.e["$[]"](i)],$send(self.e,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:this}),this.e["$[]="]($rb_minus(this.size,1),0),f=0,tst1=0,eps=$$$($$("Float"),"EPSILON"),$send(this.size,"times",[],(function $$28(l){var $a,self=null==$$28.$$s?this:$$28.$$s,m=nil,iter=nil,g=nil,p=nil,r=nil,dl1=nil,h=nil,c=nil,c2=nil,c3=nil,el1=nil,s=nil,s2=nil;for(null==self.d&&(self.d=nil),null==self.e&&(self.e=nil),null==self.size&&(self.size=nil),null==l&&(l=nil),tst1=[tst1,$rb_plus(self.d["$[]"](l).$abs(),self.e["$[]"](l).$abs())].$max(),m=l;$truthy($rb_lt(m,self.size))&&!$truthy($rb_le(self.e["$[]"](m).$abs(),$rb_times(eps,tst1)));)m=$rb_plus(m,1);if($truthy($rb_gt(m,l))){iter=0;do{iter=$rb_plus(iter,1),g=self.d["$[]"](l),p=$rb_divide($rb_minus(self.d["$[]"]($rb_plus(l,1)),g),$rb_times(2,self.e["$[]"](l))),r=$$("Math").$hypot(p,1),$truthy($rb_lt(p,0))&&(r=r["$-@"]()),self.d["$[]="](l,$rb_divide(self.e["$[]"](l),$rb_plus(p,r))),self.d["$[]="]($rb_plus(l,1),$rb_times(self.e["$[]"](l),$rb_plus(p,r))),dl1=self.d["$[]"]($rb_plus(l,1)),h=$rb_minus(g,self.d["$[]"](l)),$send($rb_plus(l,2),"upto",[$rb_minus(self.size,1)],(function $$29(i){var $a,self=null==$$29.$$s?this:$$29.$$s;return null==self.d&&(self.d=nil),null==i&&(i=nil),$a=[i,$rb_minus(self.d["$[]"](i),h)],$send(self.d,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}),f=$rb_plus(f,h),p=self.d["$[]"](m),c2=c=1,c3=c,el1=self.e["$[]"]($rb_plus(l,1)),s=0,s2=0,$send($rb_minus(m,1),"downto",[l],(function $$30(i){var self=null==$$30.$$s?this:$$30.$$s;return null==self.e&&(self.e=nil),null==self.d&&(self.d=nil),null==self.size&&(self.size=nil),null==i&&(i=nil),c3=c2,c2=c,s2=s,g=$rb_times(c,self.e["$[]"](i)),h=$rb_times(c,p),r=$$("Math").$hypot(p,self.e["$[]"](i)),self.e["$[]="]($rb_plus(i,1),$rb_times(s,r)),s=$rb_divide(self.e["$[]"](i),r),c=$rb_divide(p,r),p=$rb_minus($rb_times(c,self.d["$[]"](i)),$rb_times(s,g)),self.d["$[]="]($rb_plus(i,1),$rb_plus(h,$rb_times(s,$rb_plus($rb_times(c,g),$rb_times(s,self.d["$[]"](i)))))),$send(self.size,"times",[],(function $$31(k){var $a,self=null==$$31.$$s?this:$$31.$$s;return null==self.v&&(self.v=nil),null==k&&(k=nil),h=self.v["$[]"](k)["$[]"]($rb_plus(i,1)),self.v["$[]"](k)["$[]="]($rb_plus(i,1),$rb_plus($rb_times(s,self.v["$[]"](k)["$[]"](i)),$rb_times(c,h))),$a=[i,$rb_minus($rb_times(c,self.v["$[]"](k)["$[]"](i)),$rb_times(s,h))],$send(self.v["$[]"](k),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:self}),p=$rb_divide($rb_times($rb_times($rb_times($rb_times(s["$-@"](),s2),c3),el1),self.e["$[]"](l)),dl1),self.e["$[]="](l,$rb_times(s,p)),self.d["$[]="](l,$rb_times(c,p))}while($truthy($rb_gt(self.e["$[]"](l).$abs(),$rb_times(eps,tst1))))}return self.d["$[]="](l,$rb_plus(self.d["$[]"](l),f)),$a=[l,0],$send(self.e,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:this}),$send(0,"upto",[$rb_minus(this.size,2)],(function $$32(i){var self=null==$$32.$$s?this:$$32.$$s,k=nil,p=nil;return null==self.d&&(self.d=nil),null==self.size&&(self.size=nil),null==i&&(i=nil),k=i,p=self.d["$[]"](i),$send($rb_plus(i,1),"upto",[$rb_minus(self.size,1)],(function $$33(j){var self=null==$$33.$$s?this:$$33.$$s;return null==self.d&&(self.d=nil),null==j&&(j=nil),$truthy($rb_lt(self.d["$[]"](j),p))?(k=j,p=self.d["$[]"](j)):nil}),{$$arity:1,$$s:self}),$neqeq(k,i)?(self.d["$[]="](k,self.d["$[]"](i)),self.d["$[]="](i,p),$send(self.size,"times",[],(function $$34(j){var $a,self=null==$$34.$$s?this:$$34.$$s;return null==self.v&&(self.v=nil),null==j&&(j=nil),p=self.v["$[]"](j)["$[]"](i),self.v["$[]"](j)["$[]="](i,self.v["$[]"](j)["$[]"](k)),$a=[k,p],$send(self.v["$[]"](j),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self})):nil}),{$$arity:1,$$s:this})}),0),$def(self,"$reduce_to_hessenberg",(function(){var high;return 0,high=$rb_minus(this.size,1),$send($rb_plus(0,1),"upto",[$rb_minus(high,1)],(function $$35(m){var $a,self=null==$$35.$$s?this:$$35.$$s,scale=nil,h=nil,g=nil;return null==self.ort&&(self.ort=nil),null==self.size&&(self.size=nil),null==self.h&&(self.h=nil),null==m&&(m=nil),scale=0,$send(m,"upto",[high],(function $$36(i){var self=null==$$36.$$s?this:$$36.$$s;return null==self.h&&(self.h=nil),null==i&&(i=nil),scale=$rb_plus(scale,self.h["$[]"](i)["$[]"]($rb_minus(m,1)).$abs())}),{$$arity:1,$$s:self}),$neqeq(scale,0)?(h=0,$send(high,"downto",[m],(function $$37(i){var self=null==$$37.$$s?this:$$37.$$s;return null==self.ort&&(self.ort=nil),null==self.h&&(self.h=nil),null==i&&(i=nil),self.ort["$[]="](i,$rb_divide(self.h["$[]"](i)["$[]"]($rb_minus(m,1)),scale)),h=$rb_plus(h,$rb_times(self.ort["$[]"](i),self.ort["$[]"](i)))}),{$$arity:1,$$s:self}),g=$$("Math").$sqrt(h),$truthy($rb_gt(self.ort["$[]"](m),0))&&(g=g["$-@"]()),h=$rb_minus(h,$rb_times(self.ort["$[]"](m),g)),self.ort["$[]="](m,$rb_minus(self.ort["$[]"](m),g)),$send(m,"upto",[$rb_minus(self.size,1)],(function $$38(j){var self=null==$$38.$$s?this:$$38.$$s,f=nil;return null==j&&(j=nil),f=0,$send(high,"downto",[m],(function $$39(i){var self=null==$$39.$$s?this:$$39.$$s;return null==self.ort&&(self.ort=nil),null==self.h&&(self.h=nil),null==i&&(i=nil),f=$rb_plus(f,$rb_times(self.ort["$[]"](i),self.h["$[]"](i)["$[]"](j)))}),{$$arity:1,$$s:self}),f=$rb_divide(f,h),$send(m,"upto",[high],(function $$40(i){var $a,self=null==$$40.$$s?this:$$40.$$s,$binary_op_recvr_tmp_7=nil;return null==self.h&&(self.h=nil),null==self.ort&&(self.ort=nil),null==i&&(i=nil),$binary_op_recvr_tmp_7=self.h["$[]"](i),$a=[j,$rb_minus($binary_op_recvr_tmp_7["$[]"](j),$rb_times(f,self.ort["$[]"](i)))],$send($binary_op_recvr_tmp_7,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:self}),$send(0,"upto",[high],(function $$41(i){var self=null==$$41.$$s?this:$$41.$$s,f=nil;return null==i&&(i=nil),f=0,$send(high,"downto",[m],(function $$42(j){var self=null==$$42.$$s?this:$$42.$$s;return null==self.ort&&(self.ort=nil),null==self.h&&(self.h=nil),null==j&&(j=nil),f=$rb_plus(f,$rb_times(self.ort["$[]"](j),self.h["$[]"](i)["$[]"](j)))}),{$$arity:1,$$s:self}),f=$rb_divide(f,h),$send(m,"upto",[high],(function $$43(j){var $a,self=null==$$43.$$s?this:$$43.$$s,$binary_op_recvr_tmp_8=nil;return null==self.h&&(self.h=nil),null==self.ort&&(self.ort=nil),null==j&&(j=nil),$binary_op_recvr_tmp_8=self.h["$[]"](i),$a=[j,$rb_minus($binary_op_recvr_tmp_8["$[]"](j),$rb_times(f,self.ort["$[]"](j)))],$send($binary_op_recvr_tmp_8,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:self}),self.ort["$[]="](m,$rb_times(scale,self.ort["$[]"](m))),$a=[$rb_minus(m,1),$rb_times(scale,g)],$send(self.h["$[]"](m),"[]=",$a),$a[$a.length-1]):nil}),{$$arity:1,$$s:this}),$send(this.size,"times",[],(function $$44(i){var self=null==$$44.$$s?this:$$44.$$s;return null==self.size&&(self.size=nil),null==i&&(i=nil),$send(self.size,"times",[],(function $$45(j){var $a,self=null==$$45.$$s?this:$$45.$$s;return null==self.v&&(self.v=nil),null==j&&(j=nil),$a=[j,$eqeq(i,j)?1:0],$send(self.v["$[]"](i),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:this}),$send($rb_minus(high,1),"downto",[$rb_plus(0,1)],(function $$46(m){var self=null==$$46.$$s?this:$$46.$$s;return null==self.h&&(self.h=nil),null==m&&(m=nil),$neqeq(self.h["$[]"](m)["$[]"]($rb_minus(m,1)),0)?($send($rb_plus(m,1),"upto",[high],(function $$47(i){var $a,self=null==$$47.$$s?this:$$47.$$s;return null==self.h&&(self.h=nil),null==self.ort&&(self.ort=nil),null==i&&(i=nil),$a=[i,self.h["$[]"](i)["$[]"]($rb_minus(m,1))],$send(self.ort,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}),$send(m,"upto",[high],(function $$48(j){var self=null==$$48.$$s?this:$$48.$$s,g=nil;return null==self.ort&&(self.ort=nil),null==self.h&&(self.h=nil),null==j&&(j=nil),g=0,$send(m,"upto",[high],(function $$49(i){var self=null==$$49.$$s?this:$$49.$$s;return null==self.ort&&(self.ort=nil),null==self.v&&(self.v=nil),null==i&&(i=nil),g=$rb_plus(g,$rb_times(self.ort["$[]"](i),self.v["$[]"](i)["$[]"](j)))}),{$$arity:1,$$s:self}),g=$rb_divide($rb_divide(g,self.ort["$[]"](m)),self.h["$[]"](m)["$[]"]($rb_minus(m,1))),$send(m,"upto",[high],(function $$50(i){var $a,self=null==$$50.$$s?this:$$50.$$s,$binary_op_recvr_tmp_9=nil;return null==self.v&&(self.v=nil),null==self.ort&&(self.ort=nil),null==i&&(i=nil),$binary_op_recvr_tmp_9=self.v["$[]"](i),$a=[j,$rb_plus($binary_op_recvr_tmp_9["$[]"](j),$rb_times(g,self.ort["$[]"](i)))],$send($binary_op_recvr_tmp_9,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:self})):nil}),{$$arity:1,$$s:this})}),0),$def(self,"$hessenberg_to_real_schur",(function(){var nn,eps,n=nil,high=nil,exshift=nil,p=nil,q=nil,r=nil,s=nil,z=nil,norm=nil,iter=nil,l=nil,w=nil,x=nil,y=nil,m=nil;for(nn=this.size,n=$rb_minus(nn,1),0,high=$rb_minus(nn,1),eps=$$$($$("Float"),"EPSILON"),exshift=0,p=q=r=s=z=0,norm=0,$send(nn,"times",[],(function $$51(i){var self=null==$$51.$$s?this:$$51.$$s;return null==self.d&&(self.d=nil),null==self.h&&(self.h=nil),null==self.e&&(self.e=nil),null==i&&(i=nil),($truthy($rb_lt(i,0))||$truthy($rb_gt(i,high)))&&(self.d["$[]="](i,self.h["$[]"](i)["$[]"](i)),self.e["$[]="](i,0)),$send([$rb_minus(i,1),0].$max(),"upto",[$rb_minus(nn,1)],(function $$52(j){var self=null==$$52.$$s?this:$$52.$$s;return null==self.h&&(self.h=nil),null==j&&(j=nil),norm=$rb_plus(norm,self.h["$[]"](i)["$[]"](j).$abs())}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:this}),iter=0;$truthy($rb_ge(n,0));){for(l=n;$truthy($rb_gt(l,0))&&(s=$rb_plus(this.h["$[]"]($rb_minus(l,1))["$[]"]($rb_minus(l,1)).$abs(),this.h["$[]"](l)["$[]"](l).$abs()),$eqeq(s,0)&&(s=norm),!$truthy($rb_lt(this.h["$[]"](l)["$[]"]($rb_minus(l,1)).$abs(),$rb_times(eps,s))));)l=$rb_minus(l,1);if($eqeq(l,n))this.h["$[]"](n)["$[]="](n,$rb_plus(this.h["$[]"](n)["$[]"](n),exshift)),this.d["$[]="](n,this.h["$[]"](n)["$[]"](n)),this.e["$[]="](n,0),n=$rb_minus(n,1),iter=0;else if($eqeq(l,$rb_minus(n,1)))w=$rb_times(this.h["$[]"](n)["$[]"]($rb_minus(n,1)),this.h["$[]"]($rb_minus(n,1))["$[]"](n)),p=$rb_divide($rb_minus(this.h["$[]"]($rb_minus(n,1))["$[]"]($rb_minus(n,1)),this.h["$[]"](n)["$[]"](n)),2),q=$rb_plus($rb_times(p,p),w),z=$$("Math").$sqrt(q.$abs()),this.h["$[]"](n)["$[]="](n,$rb_plus(this.h["$[]"](n)["$[]"](n),exshift)),this.h["$[]"]($rb_minus(n,1))["$[]="]($rb_minus(n,1),$rb_plus(this.h["$[]"]($rb_minus(n,1))["$[]"]($rb_minus(n,1)),exshift)),x=this.h["$[]"](n)["$[]"](n),$truthy($rb_ge(q,0))?(z=$truthy($rb_ge(p,0))?$rb_plus(p,z):$rb_minus(p,z),this.d["$[]="]($rb_minus(n,1),$rb_plus(x,z)),this.d["$[]="](n,this.d["$[]"]($rb_minus(n,1))),$neqeq(z,0)&&this.d["$[]="](n,$rb_minus(x,$rb_divide(w,z))),this.e["$[]="]($rb_minus(n,1),0),this.e["$[]="](n,0),x=this.h["$[]"](n)["$[]"]($rb_minus(n,1)),s=$rb_plus(x.$abs(),z.$abs()),p=$rb_divide(x,s),q=$rb_divide(z,s),r=$$("Math").$sqrt($rb_plus($rb_times(p,p),$rb_times(q,q))),p=$rb_divide(p,r),q=$rb_divide(q,r),$send($rb_minus(n,1),"upto",[$rb_minus(nn,1)],(function $$53(j){var $a,self=null==$$53.$$s?this:$$53.$$s;return null==self.h&&(self.h=nil),null==j&&(j=nil),z=self.h["$[]"]($rb_minus(n,1))["$[]"](j),self.h["$[]"]($rb_minus(n,1))["$[]="](j,$rb_plus($rb_times(q,z),$rb_times(p,self.h["$[]"](n)["$[]"](j)))),$a=[j,$rb_minus($rb_times(q,self.h["$[]"](n)["$[]"](j)),$rb_times(p,z))],$send(self.h["$[]"](n),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:this}),$send(0,"upto",[n],(function $$54(i){var $a,self=null==$$54.$$s?this:$$54.$$s;return null==self.h&&(self.h=nil),null==i&&(i=nil),z=self.h["$[]"](i)["$[]"]($rb_minus(n,1)),self.h["$[]"](i)["$[]="]($rb_minus(n,1),$rb_plus($rb_times(q,z),$rb_times(p,self.h["$[]"](i)["$[]"](n)))),$a=[n,$rb_minus($rb_times(q,self.h["$[]"](i)["$[]"](n)),$rb_times(p,z))],$send(self.h["$[]"](i),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:this}),$send(0,"upto",[high],(function $$55(i){var $a,self=null==$$55.$$s?this:$$55.$$s;return null==self.v&&(self.v=nil),null==i&&(i=nil),z=self.v["$[]"](i)["$[]"]($rb_minus(n,1)),self.v["$[]"](i)["$[]="]($rb_minus(n,1),$rb_plus($rb_times(q,z),$rb_times(p,self.v["$[]"](i)["$[]"](n)))),$a=[n,$rb_minus($rb_times(q,self.v["$[]"](i)["$[]"](n)),$rb_times(p,z))],$send(self.v["$[]"](i),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:this})):(this.d["$[]="]($rb_minus(n,1),$rb_plus(x,p)),this.d["$[]="](n,$rb_plus(x,p)),this.e["$[]="]($rb_minus(n,1),z),this.e["$[]="](n,z["$-@"]())),n=$rb_minus(n,2),iter=0;else{for(x=this.h["$[]"](n)["$[]"](n),y=0,w=0,$truthy($rb_lt(l,n))&&(y=this.h["$[]"]($rb_minus(n,1))["$[]"]($rb_minus(n,1)),w=$rb_times(this.h["$[]"](n)["$[]"]($rb_minus(n,1)),this.h["$[]"]($rb_minus(n,1))["$[]"](n))),$eqeq(iter,10)&&(exshift=$rb_plus(exshift,x),$send(0,"upto",[n],(function $$56(i){var $a,self=null==$$56.$$s?this:$$56.$$s,$binary_op_recvr_tmp_10=nil;return null==self.h&&(self.h=nil),null==i&&(i=nil),$binary_op_recvr_tmp_10=self.h["$[]"](i),$a=[i,$rb_minus($binary_op_recvr_tmp_10["$[]"](i),x)],$send($binary_op_recvr_tmp_10,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:this}),s=$rb_plus(this.h["$[]"](n)["$[]"]($rb_minus(n,1)).$abs(),this.h["$[]"]($rb_minus(n,1))["$[]"]($rb_minus(n,2)).$abs()),x=y=$rb_times(.75,s),w=$rb_times($rb_times(-.4375,s),s)),$eqeq(iter,30)&&(s=$rb_divide($rb_minus(y,x),2),s=$rb_times(s,$rb_plus(s,w)),$truthy($rb_gt(s,0))&&(s=$$("Math").$sqrt(s),$truthy($rb_lt(y,x))&&(s=s["$-@"]()),s=$rb_minus(x,$rb_divide(w,$rb_plus($rb_divide($rb_minus(y,x),2),s))),$send(0,"upto",[n],(function $$57(i){var $a,self=null==$$57.$$s?this:$$57.$$s,$binary_op_recvr_tmp_11=nil;return null==self.h&&(self.h=nil),null==i&&(i=nil),$binary_op_recvr_tmp_11=self.h["$[]"](i),$a=[i,$rb_minus($binary_op_recvr_tmp_11["$[]"](i),s)],$send($binary_op_recvr_tmp_11,"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:this}),exshift=$rb_plus(exshift,s),x=y=w=.964)),iter=$rb_plus(iter,1),m=$rb_minus(n,2);$truthy($rb_ge(m,l))&&(z=this.h["$[]"](m)["$[]"](m),r=$rb_minus(x,z),s=$rb_minus(y,z),p=$rb_plus($rb_divide($rb_minus($rb_times(r,s),w),this.h["$[]"]($rb_plus(m,1))["$[]"](m)),this.h["$[]"](m)["$[]"]($rb_plus(m,1))),q=$rb_minus($rb_minus($rb_minus(this.h["$[]"]($rb_plus(m,1))["$[]"]($rb_plus(m,1)),z),r),s),r=this.h["$[]"]($rb_plus(m,2))["$[]"]($rb_plus(m,1)),s=$rb_plus($rb_plus(p.$abs(),q.$abs()),r.$abs()),p=$rb_divide(p,s),q=$rb_divide(q,s),r=$rb_divide(r,s),!$eqeq(m,l))&&!$truthy($rb_lt($rb_times(this.h["$[]"](m)["$[]"]($rb_minus(m,1)).$abs(),$rb_plus(q.$abs(),r.$abs())),$rb_times(eps,$rb_times(p.$abs(),$rb_plus($rb_plus(this.h["$[]"]($rb_minus(m,1))["$[]"]($rb_minus(m,1)).$abs(),z.$abs()),this.h["$[]"]($rb_plus(m,1))["$[]"]($rb_plus(m,1)).$abs())))));)m=$rb_minus(m,1);$send($rb_plus(m,2),"upto",[n],(function $$58(i){var $a,self=null==$$58.$$s?this:$$58.$$s;return null==self.h&&(self.h=nil),null==i&&(i=nil),self.h["$[]"](i)["$[]="]($rb_minus(i,2),0),$truthy($rb_gt(i,$rb_plus(m,2)))?($a=[$rb_minus(i,3),0],$send(self.h["$[]"](i),"[]=",$a),$a[$a.length-1]):nil}),{$$arity:1,$$s:this}),$send(m,"upto",[$rb_minus(n,1)],(function $$59(k){var notlast,self=null==$$59.$$s?this:$$59.$$s;if(null==self.h&&(self.h=nil),null==k&&(k=nil),notlast=k["$!="]($rb_minus(n,1)),$neqeq(k,m)){if(p=self.h["$[]"](k)["$[]"]($rb_minus(k,1)),q=self.h["$[]"]($rb_plus(k,1))["$[]"]($rb_minus(k,1)),r=$truthy(notlast)?self.h["$[]"]($rb_plus(k,2))["$[]"]($rb_minus(k,1)):0,x=$rb_plus($rb_plus(p.$abs(),q.$abs()),r.$abs()),$eqeq(x,0))return nil;p=$rb_divide(p,x),q=$rb_divide(q,x),r=$rb_divide(r,x)}return s=$$("Math").$sqrt($rb_plus($rb_plus($rb_times(p,p),$rb_times(q,q)),$rb_times(r,r))),$truthy($rb_lt(p,0))&&(s=s["$-@"]()),$neqeq(s,0)?($neqeq(k,m)?self.h["$[]"](k)["$[]="]($rb_minus(k,1),$rb_times(s["$-@"](),x)):$neqeq(l,m)&&self.h["$[]"](k)["$[]="]($rb_minus(k,1),self.h["$[]"](k)["$[]"]($rb_minus(k,1))["$-@"]()),p=$rb_plus(p,s),x=$rb_divide(p,s),y=$rb_divide(q,s),z=$rb_divide(r,s),q=$rb_divide(q,p),r=$rb_divide(r,p),$send(k,"upto",[$rb_minus(nn,1)],(function $$60(j){var $a,self=null==$$60.$$s?this:$$60.$$s;return null==self.h&&(self.h=nil),null==j&&(j=nil),p=$rb_plus(self.h["$[]"](k)["$[]"](j),$rb_times(q,self.h["$[]"]($rb_plus(k,1))["$[]"](j))),$truthy(notlast)&&(p=$rb_plus(p,$rb_times(r,self.h["$[]"]($rb_plus(k,2))["$[]"](j))),self.h["$[]"]($rb_plus(k,2))["$[]="](j,$rb_minus(self.h["$[]"]($rb_plus(k,2))["$[]"](j),$rb_times(p,z)))),self.h["$[]"](k)["$[]="](j,$rb_minus(self.h["$[]"](k)["$[]"](j),$rb_times(p,x))),$a=[j,$rb_minus(self.h["$[]"]($rb_plus(k,1))["$[]"](j),$rb_times(p,y))],$send(self.h["$[]"]($rb_plus(k,1)),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}),$send(0,"upto",[[n,$rb_plus(k,3)].$min()],(function $$61(i){var $a,self=null==$$61.$$s?this:$$61.$$s;return null==self.h&&(self.h=nil),null==i&&(i=nil),p=$rb_plus($rb_times(x,self.h["$[]"](i)["$[]"](k)),$rb_times(y,self.h["$[]"](i)["$[]"]($rb_plus(k,1)))),$truthy(notlast)&&(p=$rb_plus(p,$rb_times(z,self.h["$[]"](i)["$[]"]($rb_plus(k,2)))),self.h["$[]"](i)["$[]="]($rb_plus(k,2),$rb_minus(self.h["$[]"](i)["$[]"]($rb_plus(k,2)),$rb_times(p,r)))),self.h["$[]"](i)["$[]="](k,$rb_minus(self.h["$[]"](i)["$[]"](k),p)),$a=[$rb_plus(k,1),$rb_minus(self.h["$[]"](i)["$[]"]($rb_plus(k,1)),$rb_times(p,q))],$send(self.h["$[]"](i),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}),$send(0,"upto",[high],(function $$62(i){var $a,self=null==$$62.$$s?this:$$62.$$s;return null==self.v&&(self.v=nil),null==i&&(i=nil),p=$rb_plus($rb_times(x,self.v["$[]"](i)["$[]"](k)),$rb_times(y,self.v["$[]"](i)["$[]"]($rb_plus(k,1)))),$truthy(notlast)&&(p=$rb_plus(p,$rb_times(z,self.v["$[]"](i)["$[]"]($rb_plus(k,2)))),self.v["$[]"](i)["$[]="]($rb_plus(k,2),$rb_minus(self.v["$[]"](i)["$[]"]($rb_plus(k,2)),$rb_times(p,r)))),self.v["$[]"](i)["$[]="](k,$rb_minus(self.v["$[]"](i)["$[]"](k),p)),$a=[$rb_plus(k,1),$rb_minus(self.v["$[]"](i)["$[]"]($rb_plus(k,1)),$rb_times(p,q))],$send(self.v["$[]"](i),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self})):nil}),{$$arity:1,$$s:this})}}return $eqeq(norm,0)?nil:($send($rb_minus(nn,1),"downto",[0],(function $$63(k){var $a,$b,self=null==$$63.$$s?this:$$63.$$s,cdivr=nil,cdivi=nil;return null==self.d&&(self.d=nil),null==self.e&&(self.e=nil),null==self.h&&(self.h=nil),null==k&&(k=nil),p=self.d["$[]"](k),q=self.e["$[]"](k),$eqeq(q,0)?(l=k,self.h["$[]"](k)["$[]="](k,1),$send($rb_minus(k,1),"downto",[0],(function $$64(i){var self=null==$$64.$$s?this:$$64.$$s,t=nil;return null==self.h&&(self.h=nil),null==self.e&&(self.e=nil),null==self.d&&(self.d=nil),null==i&&(i=nil),w=$rb_minus(self.h["$[]"](i)["$[]"](i),p),r=0,$send(l,"upto",[k],(function $$65(j){var self=null==$$65.$$s?this:$$65.$$s;return null==self.h&&(self.h=nil),null==j&&(j=nil),r=$rb_plus(r,$rb_times(self.h["$[]"](i)["$[]"](j),self.h["$[]"](j)["$[]"](k)))}),{$$arity:1,$$s:self}),$truthy($rb_lt(self.e["$[]"](i),0))?(z=w,s=r):(l=i,$eqeq(self.e["$[]"](i),0)?$neqeq(w,0)?self.h["$[]"](i)["$[]="](k,$rb_divide(r["$-@"](),w)):self.h["$[]"](i)["$[]="](k,$rb_divide(r["$-@"](),$rb_times(eps,norm))):(x=self.h["$[]"](i)["$[]"]($rb_plus(i,1)),y=self.h["$[]"]($rb_plus(i,1))["$[]"](i),q=$rb_plus($rb_times($rb_minus(self.d["$[]"](i),p),$rb_minus(self.d["$[]"](i),p)),$rb_times(self.e["$[]"](i),self.e["$[]"](i))),t=$rb_divide($rb_minus($rb_times(x,s),$rb_times(z,r)),q),self.h["$[]"](i)["$[]="](k,t),$truthy($rb_gt(x.$abs(),z.$abs()))?self.h["$[]"]($rb_plus(i,1))["$[]="](k,$rb_divide($rb_minus(r["$-@"](),$rb_times(w,t)),x)):self.h["$[]"]($rb_plus(i,1))["$[]="](k,$rb_divide($rb_minus(s["$-@"](),$rb_times(y,t)),z))),t=self.h["$[]"](i)["$[]"](k).$abs(),$truthy($rb_gt($rb_times($rb_times(eps,t),t),1))?$send(i,"upto",[k],(function $$66(j){var $a,self=null==$$66.$$s?this:$$66.$$s;return null==self.h&&(self.h=nil),null==j&&(j=nil),$a=[k,$rb_divide(self.h["$[]"](j)["$[]"](k),t)],$send(self.h["$[]"](j),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}):nil)}),{$$arity:1,$$s:self})):$truthy($rb_lt(q,0))?(l=$rb_minus(n,1),$truthy($rb_gt(self.h["$[]"](n)["$[]"]($rb_minus(n,1)).$abs(),self.h["$[]"]($rb_minus(n,1))["$[]"](n).$abs()))?(self.h["$[]"]($rb_minus(n,1))["$[]="]($rb_minus(n,1),$rb_divide(q,self.h["$[]"](n)["$[]"]($rb_minus(n,1)))),self.h["$[]"]($rb_minus(n,1))["$[]="](n,$rb_divide($rb_minus(self.h["$[]"](n)["$[]"](n),p)["$-@"](),self.h["$[]"](n)["$[]"]($rb_minus(n,1))))):($b=self.$cdiv(0,self.h["$[]"]($rb_minus(n,1))["$[]"](n)["$-@"](),$rb_minus(self.h["$[]"]($rb_minus(n,1))["$[]"]($rb_minus(n,1)),p),q),$a=$to_ary($b),cdivr=null==$a[0]?nil:$a[0],cdivi=null==$a[1]?nil:$a[1],self.h["$[]"]($rb_minus(n,1))["$[]="]($rb_minus(n,1),cdivr),self.h["$[]"]($rb_minus(n,1))["$[]="](n,cdivi)),self.h["$[]"](n)["$[]="]($rb_minus(n,1),0),self.h["$[]"](n)["$[]="](n,1),$send($rb_minus(n,2),"downto",[0],(function $$67(i){var $c,$d,self=null==$$67.$$s?this:$$67.$$s,ra=nil,sa=nil,vr=nil,vi=nil,t=nil;return null==self.h&&(self.h=nil),null==self.e&&(self.e=nil),null==self.d&&(self.d=nil),null==i&&(i=nil),ra=0,sa=0,$send(l,"upto",[n],(function $$68(j){var self=null==$$68.$$s?this:$$68.$$s;return null==self.h&&(self.h=nil),null==j&&(j=nil),ra=$rb_plus(ra,$rb_times(self.h["$[]"](i)["$[]"](j),self.h["$[]"](j)["$[]"]($rb_minus(n,1)))),sa=$rb_plus(sa,$rb_times(self.h["$[]"](i)["$[]"](j),self.h["$[]"](j)["$[]"](n)))}),{$$arity:1,$$s:self}),w=$rb_minus(self.h["$[]"](i)["$[]"](i),p),$truthy($rb_lt(self.e["$[]"](i),0))?(z=w,r=ra,s=sa):(l=i,$eqeq(self.e["$[]"](i),0)?($d=self.$cdiv(ra["$-@"](),sa["$-@"](),w,q),$c=$to_ary($d),cdivr=null==$c[0]?nil:$c[0],cdivi=null==$c[1]?nil:$c[1],self.h["$[]"](i)["$[]="]($rb_minus(n,1),cdivr),self.h["$[]"](i)["$[]="](n,cdivi)):(x=self.h["$[]"](i)["$[]"]($rb_plus(i,1)),y=self.h["$[]"]($rb_plus(i,1))["$[]"](i),vr=$rb_minus($rb_plus($rb_times($rb_minus(self.d["$[]"](i),p),$rb_minus(self.d["$[]"](i),p)),$rb_times(self.e["$[]"](i),self.e["$[]"](i))),$rb_times(q,q)),vi=$rb_times($rb_times($rb_minus(self.d["$[]"](i),p),2),q),$eqeq(vr,0)&&$eqeq(vi,0)&&(vr=$rb_times($rb_times(eps,norm),$rb_plus($rb_plus($rb_plus($rb_plus(w.$abs(),q.$abs()),x.$abs()),y.$abs()),z.$abs()))),$d=self.$cdiv($rb_plus($rb_minus($rb_times(x,r),$rb_times(z,ra)),$rb_times(q,sa)),$rb_minus($rb_minus($rb_times(x,s),$rb_times(z,sa)),$rb_times(q,ra)),vr,vi),$c=$to_ary($d),cdivr=null==$c[0]?nil:$c[0],cdivi=null==$c[1]?nil:$c[1],self.h["$[]"](i)["$[]="]($rb_minus(n,1),cdivr),self.h["$[]"](i)["$[]="](n,cdivi),$truthy($rb_gt(x.$abs(),$rb_plus(z.$abs(),q.$abs())))?(self.h["$[]"]($rb_plus(i,1))["$[]="]($rb_minus(n,1),$rb_divide($rb_plus($rb_minus(ra["$-@"](),$rb_times(w,self.h["$[]"](i)["$[]"]($rb_minus(n,1)))),$rb_times(q,self.h["$[]"](i)["$[]"](n))),x)),self.h["$[]"]($rb_plus(i,1))["$[]="](n,$rb_divide($rb_minus($rb_minus(sa["$-@"](),$rb_times(w,self.h["$[]"](i)["$[]"](n))),$rb_times(q,self.h["$[]"](i)["$[]"]($rb_minus(n,1)))),x))):($d=self.$cdiv($rb_minus(r["$-@"](),$rb_times(y,self.h["$[]"](i)["$[]"]($rb_minus(n,1)))),$rb_minus(s["$-@"](),$rb_times(y,self.h["$[]"](i)["$[]"](n))),z,q),$c=$to_ary($d),cdivr=null==$c[0]?nil:$c[0],cdivi=null==$c[1]?nil:$c[1],self.h["$[]"]($rb_plus(i,1))["$[]="]($rb_minus(n,1),cdivr),self.h["$[]"]($rb_plus(i,1))["$[]="](n,cdivi))),t=[self.h["$[]"](i)["$[]"]($rb_minus(n,1)).$abs(),self.h["$[]"](i)["$[]"](n).$abs()].$max(),$truthy($rb_gt($rb_times($rb_times(eps,t),t),1))?$send(i,"upto",[n],(function $$69(j){var $e,self=null==$$69.$$s?this:$$69.$$s;return null==self.h&&(self.h=nil),null==j&&(j=nil),self.h["$[]"](j)["$[]="]($rb_minus(n,1),$rb_divide(self.h["$[]"](j)["$[]"]($rb_minus(n,1)),t)),$e=[n,$rb_divide(self.h["$[]"](j)["$[]"](n),t)],$send(self.h["$[]"](j),"[]=",$e),$e[$e.length-1]}),{$$arity:1,$$s:self}):nil)}),{$$arity:1,$$s:self})):nil}),{$$arity:1,$$s:this}),$send(nn,"times",[],(function $$70(i){var self=null==$$70.$$s?this:$$70.$$s;return null==i&&(i=nil),$truthy($rb_lt(i,0))||$truthy($rb_gt(i,high))?$send(i,"upto",[$rb_minus(nn,1)],(function $$71(j){var $a,self=null==$$71.$$s?this:$$71.$$s;return null==self.h&&(self.h=nil),null==self.v&&(self.v=nil),null==j&&(j=nil),$a=[j,self.h["$[]"](i)["$[]"](j)],$send(self.v["$[]"](i),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:self}):nil}),{$$arity:1,$$s:this}),$send($rb_minus(nn,1),"downto",[0],(function $$72(j){return null==j&&(j=nil),$send(0,"upto",[high],(function $$73(i){var $a,self=null==$$73.$$s?this:$$73.$$s;return null==self.v&&(self.v=nil),null==i&&(i=nil),z=0,$send(0,"upto",[[j,high].$min()],(function $$74(k){var self=null==$$74.$$s?this:$$74.$$s;return null==self.v&&(self.v=nil),null==self.h&&(self.h=nil),null==k&&(k=nil),z=$rb_plus(z,$rb_times(self.v["$[]"](i)["$[]"](k),self.h["$[]"](k)["$[]"](j)))}),{$$arity:1,$$s:self}),$a=[j,z],$send(self.v["$[]"](i),"[]=",$a),$a[$a.length-1]}),{$$arity:1,$$s:null==$$72.$$s?this:$$72.$$s})}),{$$arity:1,$$s:this}))}),0)}($nesting[0],0,$nesting)}($nesting[0],0,$nesting)},Opal.queue((function(Opal){var $module=Opal.module,$klass=Opal.klass,$slice=Opal.slice,$defs=Opal.defs,$send=Opal.send,$truthy=Opal.truthy,$eqeq=Opal.eqeq,$rb_lt=Opal.rb_lt,$to_a=Opal.to_a,$alias=Opal.alias,$neqeq=Opal.neqeq,$rb_times=Opal.rb_times,$rb_plus=Opal.rb_plus,$def=Opal.def,$thrower=Opal.thrower,$rb_ge=Opal.rb_ge,$rb_minus=Opal.rb_minus,$const_set=Opal.const_set,$hash2=Opal.hash2,$rb_gt=Opal.rb_gt,$to_ary=Opal.to_ary,$rb_le=Opal.rb_le,$ensure_kwargs=Opal.ensure_kwargs,$not=Opal.not,$eqeqeq=Opal.eqeqeq,$rb_divide=Opal.rb_divide,$return_self=Opal.return_self,$assign_ivar=Opal.assign_ivar,$get_kwarg=Opal.get_kwarg,self=Opal.top,$nesting=[],nil=Opal.nil,$$$=Opal.$$$;return Opal.add_stubs("require,extend,def_e2message,def_exception,include,autoload,private_class_method,attr_reader,protected,rows,convert_to_array,map!,size,[],each,==,raise,new,transpose,coerce_to_int,<,to_enum,empty,[]=,diagonal,scalar,identity,!=,*,coerce_to_matrix,map,send,to_proc,column_count,concat,row_count,each_with_index,+,empty?,method,first,Raise,combine,class,private,fetch,alias_method,elements,-@,>=,times,collect,new_matrix,-,upto,min,inspect,freeze,>,include?,last,pop,end,exclude_end?,<=,to_a,delete_at,square?,determinant,first_minor,**,build,cofactor,!,inject,with_index,all?,conj,singular?,===,eql?,hash,column_vector,column,apply_through_coercion,/,inverse,I,abs,quo,loop,zero?,>>,eigensystem,+@,determinant_bareiss,find,warn,determinant_e,hstack,rank,round,trace,vstack,lup,conjugate,imaginary,real,imag,rect,row,join,to_s,dup,to_ary,message,is_a?,coerce,length,public_send,kind_of?,respond_to?,__send__,coerce_to,count,independent?,collect2,each2,basis,laplace_expansion,sqrt,abs2,magnitude,acos,inner_product,row_vector"),self.$require("e2mmap.rb"),function($base,$parent_nesting){var self=$module($base,"ExceptionForMatrix"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);self.$extend($$("Exception2MessageMapper")),self.$def_e2message($$("TypeError"),"wrong argument type %s (expected %s)"),self.$def_e2message($$("ArgumentError"),"Wrong # of arguments(%d for %d)"),self.$def_exception("ErrDimensionMismatch","#{self.name} dimension mismatch"),self.$def_exception("ErrNotRegular","Not Regular Matrix"),self.$def_exception("ErrOperationNotDefined","Operation(%s) can\\'t be defined: %s op %s"),self.$def_exception("ErrOperationNotImplemented","Sorry, Operation(%s) not implemented: %s op %s")}($nesting[0],$nesting),function($base,$super,$parent_nesting){var self=$klass($base,null,"Matrix"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);self.$$prototype.rows=nil,self.$include($$("Enumerable")),self.$include($$("ExceptionForMatrix")),self.$autoload("EigenvalueDecomposition","matrix/eigenvalue_decomposition"),self.$autoload("LUPDecomposition","matrix/lup_decomposition"),self.$private_class_method("new"),self.$attr_reader("rows"),self.$protected("rows"),$defs($$("Matrix"),"$[]",(function($a){var rows,self=this;return rows=$slice.call(arguments),self.$rows(rows,!1)}),-1),$defs($$("Matrix"),"$rows",(function(rows,copy){var size,$ret_or_1;return null==copy&&(copy=!0),rows=this.$convert_to_array(rows,copy),$send(rows,"map!",[],(function $$2(row){return null==row&&(row=nil),(null==$$2.$$s?this:$$2.$$s).$convert_to_array(row,copy)}),{$$arity:1,$$s:this}),size=($truthy($ret_or_1=rows["$[]"](0))?$ret_or_1:[]).$size(),$send(rows,"each",[],(function $$3(row){var self=null==$$3.$$s?this:$$3.$$s;return null==row&&(row=nil),$eqeq(row.$size(),size)?nil:self.$raise($$("ErrDimensionMismatch"),"row size differs ("+row.$size()+" should be "+size+")")}),{$$arity:1,$$s:this}),this.$new(rows,size)}),-2),$defs($$("Matrix"),"$columns",(function(columns){return this.$rows(columns,!1).$transpose()}),1),$defs($$("Matrix"),"$build",(function $$build(row_count,column_count){var rows,$yield=$$build.$$p||nil;return $$build.$$p=null,null==column_count&&(column_count=row_count),row_count=$$("CoercionHelper").$coerce_to_int(row_count),column_count=$$("CoercionHelper").$coerce_to_int(column_count),($truthy($rb_lt(row_count,0))||$truthy($rb_lt(column_count,0)))&&this.$raise($$("ArgumentError")),$yield===nil?this.$to_enum("build",row_count,column_count):(rows=$send($$("Array"),"new",[row_count],(function(i){return null==i&&(i=nil),$send($$("Array"),"new",[column_count],(function(j){return null==j&&(j=nil),Opal.yieldX($yield,[i,j])}),1)}),1),this.$new(rows,column_count))}),-2),$defs($$("Matrix"),"$diagonal",(function($a){var $post_args,values,self=this,size=nil,rows=nil;return $post_args=$slice.call(arguments),size=(values=$post_args).$size(),$eqeq(size,0)?$$("Matrix").$empty():(rows=$send($$("Array"),"new",[size],(function(j){var row=nil;return null==j&&(j=nil),(row=$$("Array").$new(size,0))["$[]="](j,values["$[]"](j)),row}),1),self.$new(rows))}),-1),$defs($$("Matrix"),"$scalar",(function(n,value){return $send(this,"diagonal",$to_a($$("Array").$new(n,value)))}),2),$defs($$("Matrix"),"$identity",(function(n){return this.$scalar(n,1)}),1),function(self,$parent_nesting){$alias(self,"unit","identity"),$alias(self,"I","identity")}(Opal.get_singleton_class($$("Matrix"))),$defs($$("Matrix"),"$zero",(function(row_count,column_count){var rows;return null==column_count&&(column_count=row_count),rows=$send($$("Array"),"new",[row_count],(function(){return $$("Array").$new(column_count,0)}),0),this.$new(rows,column_count)}),-2),$defs($$("Matrix"),"$row_vector",(function(row){return row=this.$convert_to_array(row),this.$new([row])}),1),$defs($$("Matrix"),"$column_vector",(function(column){return column=this.$convert_to_array(column),this.$new([column].$transpose(),1)}),1),$defs($$("Matrix"),"$empty",(function(row_count,column_count){return null==row_count&&(row_count=0),null==column_count&&(column_count=0),$neqeq(column_count,0)&&$neqeq(row_count,0)&&this.$raise($$("ArgumentError"),"One size must be 0"),($truthy($rb_lt(column_count,0))||$truthy($rb_lt(row_count,0)))&&this.$raise($$("ArgumentError"),"Negative size"),this.$new($rb_times([[]],row_count),column_count)}),-1),$defs($$("Matrix"),"$vstack",(function(x,$a){var matrices,self=this,result=nil;return matrices=$slice.call(arguments,1),x=$$("CoercionHelper").$coerce_to_matrix(x),result=$send(x.$send("rows"),"map",[],"dup".$to_proc()),$send(matrices,"each",[],(function $$8(m){var self=null==$$8.$$s?this:$$8.$$s;return null==m&&(m=nil),m=$$("CoercionHelper").$coerce_to_matrix(m),$neqeq(m.$column_count(),x.$column_count())&&self.$raise($$("ErrDimensionMismatch"),"The given matrices must have "+x.$column_count()+" columns, but one has "+m.$column_count()),result.$concat(m.$send("rows"))}),{$$arity:1,$$s:self}),self.$new(result,x.$column_count())}),-2),$defs($$("Matrix"),"$hstack",(function(x,$a){var matrices,self=this,result=nil,total_column_count=nil;return matrices=$slice.call(arguments,1),x=$$("CoercionHelper").$coerce_to_matrix(x),result=$send(x.$send("rows"),"map",[],"dup".$to_proc()),total_column_count=x.$column_count(),$send(matrices,"each",[],(function $$9(m){var self=null==$$9.$$s?this:$$9.$$s;return null==m&&(m=nil),m=$$("CoercionHelper").$coerce_to_matrix(m),$neqeq(m.$row_count(),x.$row_count())&&self.$raise($$("ErrDimensionMismatch"),"The given matrices must have "+x.$row_count()+" rows, but one has "+m.$row_count()),$send(result,"each_with_index",[],(function(row,i){return null==row&&(row=nil),null==i&&(i=nil),row.$concat(m.$send("rows")["$[]"](i))}),2),total_column_count=$rb_plus(total_column_count,m.$column_count())}),{$$arity:1,$$s:self}),self.$new(result,total_column_count)}),-2),$defs($$("Matrix"),"$combine",(function $$combine($a){var $post_args,matrices,$yield=$$combine.$$p||nil,self=this,x=nil,rows=nil;return $$combine.$$p=null,$post_args=$slice.call(arguments),matrices=$post_args,$yield===nil?$send(self,"to_enum",["combine"].concat($to_a(matrices))):$truthy(matrices["$empty?"]())?$$("Matrix").$empty():($send(matrices,"map!",[],$$("CoercionHelper").$method("coerce_to_matrix").$to_proc()),x=matrices.$first(),$send(matrices,"each",[],(function(m){return null==m&&(m=nil),$eqeq(x.$row_count(),m.$row_count())&&$eqeq(x.$column_count(),m.$column_count())?nil:$$("Matrix").$Raise($$("ErrDimensionMismatch"))}),1),rows=$send($$("Array"),"new",[x.$row_count()],(function(i){return null==i&&(i=nil),$send($$("Array"),"new",[x.$column_count()],(function(j){return null==j&&(j=nil),Opal.yield1($yield,$send(matrices,"map",[],(function(m){return null==m&&(m=nil),m["$[]"](i,j)}),1))}),1)}),1),self.$new(rows,x.$column_count()))}),-1),$def(self,"$combine",(function $$combine($a){var matrices,block=$$combine.$$p||nil,self=this;return $$combine.$$p=null,matrices=$slice.call(arguments),$send($$("Matrix"),"combine",[self].concat($to_a(matrices)),block.$to_proc())}),-1),$def(self,"$initialize",(function(rows,column_count){return null==column_count&&(column_count=rows["$[]"](0).$size()),this.rows=rows,this.column_count=column_count}),-2),$def(self,"$new_matrix",(function(rows,column_count){return null==column_count&&(column_count=rows["$[]"](0).$size()),this.$class().$send("new",rows,column_count)}),-2),self.$private("new_matrix"),$def(self,"$[]",(function(i,j){try{var $t_return=$thrower("return");return $send(this.rows,"fetch",[i],(function(){$t_return.$throw()}),{$$arity:0,$$ret:$t_return})["$[]"](j)}catch($e){if($e===$t_return)return $e.$v;throw $e}}),2),$alias(self,"element","[]"),$alias(self,"component","[]"),$def(self,"$[]=",(function(i,j,v){var $a;return $a=[j,v],$send(this.rows["$[]"](i),"[]=",$a),$a[$a.length-1]}),3),$alias(self,"set_element","[]="),$alias(self,"set_component","[]="),self.$private("[]=","set_element","set_component"),$def(self,"$row_count",(function(){return this.rows.$size()}),0),self.$alias_method("row_size","row_count"),self.$attr_reader("column_count"),self.$alias_method("column_size","column_count"),$def(self,"$row",(function $$row(i){try{var $t_return=$thrower("return"),block=$$row.$$p||nil;return $$row.$$p=null,block!==nil?($send($send(this.rows,"fetch",[i],(function $$18(){var self=null==$$18.$$s?this:$$18.$$s;$t_return.$throw(self)}),{$$arity:0,$$s:this,$$ret:$t_return}),"each",[],block.$to_proc()),this):$$("Vector").$elements($send(this.rows,"fetch",[i],(function(){$t_return.$throw()}),{$$arity:0,$$ret:$t_return}))}catch($e){if($e===$t_return)return $e.$v;throw $e}}),1),$def(self,"$column",(function $$column(j){var $yield=$$column.$$p||nil,col=nil;return $$column.$$p=null,$yield!==nil?($truthy($rb_ge(j,this.$column_count()))||$truthy($rb_lt(j,this.$column_count()["$-@"]()))||$send(this.$row_count(),"times",[],(function $$20(i){var self=null==$$20.$$s?this:$$20.$$s;return null==self.rows&&(self.rows=nil),null==i&&(i=nil),Opal.yield1($yield,self.rows["$[]"](i)["$[]"](j))}),{$$arity:1,$$s:this}),this):$truthy($rb_ge(j,this.$column_count()))||$truthy($rb_lt(j,this.$column_count()["$-@"]()))?nil:(col=$send($$("Array"),"new",[this.$row_count()],(function $$21(i){var self=null==$$21.$$s?this:$$21.$$s;return null==self.rows&&(self.rows=nil),null==i&&(i=nil),self.rows["$[]"](i)["$[]"](j)}),{$$arity:1,$$s:this}),$$("Vector").$elements(col,!1))}),1),$def(self,"$collect",(function $$collect(){var rows,block=$$collect.$$p||nil;return $$collect.$$p=null,block===nil?this.$to_enum("collect"):(rows=$send(this.rows,"collect",[],(function(row){return null==row&&(row=nil),$send(row,"collect",[],block.$to_proc())}),1),this.$new_matrix(rows,this.$column_count()))}),0),$alias(self,"map","collect"),$def(self,"$each",(function $$each(which){try{var $t_return=$thrower("return"),$yield=$$each.$$p||nil,last=nil,block=nil;if($$each.$$p=null,null==which&&(which="all"),$yield===nil)return this.$to_enum("each",which);switch(last=$rb_minus(this.$column_count(),1),which){case"all":block=$$("Proc").$new(),$send(this.rows,"each",[],(function(row){return null==row&&(row=nil),$send(row,"each",[],block.$to_proc())}),1);break;case"diagonal":$send(this.rows,"each_with_index",[],(function $$24(row,row_index){var self=null==$$24.$$s?this:$$24.$$s;return null==row&&(row=nil),null==row_index&&(row_index=nil),Opal.yield1($yield,$send(row,"fetch",[row_index],(function $$25(){var self=null==$$25.$$s?this:$$25.$$s;$t_return.$throw(self)}),{$$arity:0,$$s:self,$$ret:$t_return}))}),{$$arity:2,$$s:this});break;case"off_diagonal":$send(this.rows,"each_with_index",[],(function $$26(row,row_index){return null==row&&(row=nil),null==row_index&&(row_index=nil),$send((null==$$26.$$s?this:$$26.$$s).$column_count(),"times",[],(function(col_index){return null==col_index&&(col_index=nil),$eqeq(row_index,col_index)?nil:Opal.yield1($yield,row["$[]"](col_index))}),1)}),{$$arity:2,$$s:this});break;case"lower":$send(this.rows,"each_with_index",[],(function(row,row_index){return null==row&&(row=nil),null==row_index&&(row_index=nil),$send(0,"upto",[[row_index,last].$min()],(function(col_index){return null==col_index&&(col_index=nil),Opal.yield1($yield,row["$[]"](col_index))}),1)}),2);break;case"strict_lower":$send(this.rows,"each_with_index",[],(function $$30(row,row_index){return null==row&&(row=nil),null==row_index&&(row_index=nil),$send([row_index,(null==$$30.$$s?this:$$30.$$s).$column_count()].$min(),"times",[],(function(col_index){return null==col_index&&(col_index=nil),Opal.yield1($yield,row["$[]"](col_index))}),1)}),{$$arity:2,$$s:this});break;case"strict_upper":$send(this.rows,"each_with_index",[],(function(row,row_index){return null==row&&(row=nil),null==row_index&&(row_index=nil),$send($rb_plus(row_index,1),"upto",[last],(function(col_index){return null==col_index&&(col_index=nil),Opal.yield1($yield,row["$[]"](col_index))}),1)}),2);break;case"upper":$send(this.rows,"each_with_index",[],(function(row,row_index){return null==row&&(row=nil),null==row_index&&(row_index=nil),$send(row_index,"upto",[last],(function(col_index){return null==col_index&&(col_index=nil),Opal.yield1($yield,row["$[]"](col_index))}),1)}),2);break;default:this.$raise($$("ArgumentError"),"expected "+which.$inspect()+" to be one of :all, :diagonal, :off_diagonal, :lower, :strict_lower, :strict_upper or :upper")}return this}catch($e){if($e===$t_return)return $e.$v;throw $e}}),-1),$def(self,"$each_with_index",(function $$each_with_index(which){try{var $t_return=$thrower("return"),$yield=$$each_with_index.$$p||nil,last=nil;if($$each_with_index.$$p=null,null==which&&(which="all"),$yield===nil)return this.$to_enum("each_with_index",which);switch(last=$rb_minus(this.$column_count(),1),which){case"all":$send(this.rows,"each_with_index",[],(function(row,row_index){return null==row&&(row=nil),null==row_index&&(row_index=nil),$send(row,"each_with_index",[],(function(e,col_index){return null==e&&(e=nil),null==col_index&&(col_index=nil),Opal.yieldX($yield,[e,row_index,col_index])}),2)}),2);break;case"diagonal":$send(this.rows,"each_with_index",[],(function $$38(row,row_index){var self=null==$$38.$$s?this:$$38.$$s;return null==row&&(row=nil),null==row_index&&(row_index=nil),Opal.yieldX($yield,[$send(row,"fetch",[row_index],(function $$39(){var self=null==$$39.$$s?this:$$39.$$s;$t_return.$throw(self)}),{$$arity:0,$$s:self,$$ret:$t_return}),row_index,row_index])}),{$$arity:2,$$s:this});break;case"off_diagonal":$send(this.rows,"each_with_index",[],(function $$40(row,row_index){return null==row&&(row=nil),null==row_index&&(row_index=nil),$send((null==$$40.$$s?this:$$40.$$s).$column_count(),"times",[],(function(col_index){return null==col_index&&(col_index=nil),$eqeq(row_index,col_index)?nil:Opal.yieldX($yield,[row["$[]"](col_index),row_index,col_index])}),1)}),{$$arity:2,$$s:this});break;case"lower":$send(this.rows,"each_with_index",[],(function(row,row_index){return null==row&&(row=nil),null==row_index&&(row_index=nil),$send(0,"upto",[[row_index,last].$min()],(function(col_index){return null==col_index&&(col_index=nil),Opal.yieldX($yield,[row["$[]"](col_index),row_index,col_index])}),1)}),2);break;case"strict_lower":$send(this.rows,"each_with_index",[],(function $$44(row,row_index){return null==row&&(row=nil),null==row_index&&(row_index=nil),$send([row_index,(null==$$44.$$s?this:$$44.$$s).$column_count()].$min(),"times",[],(function(col_index){return null==col_index&&(col_index=nil),Opal.yieldX($yield,[row["$[]"](col_index),row_index,col_index])}),1)}),{$$arity:2,$$s:this});break;case"strict_upper":$send(this.rows,"each_with_index",[],(function(row,row_index){return null==row&&(row=nil),null==row_index&&(row_index=nil),$send($rb_plus(row_index,1),"upto",[last],(function(col_index){return null==col_index&&(col_index=nil),Opal.yieldX($yield,[row["$[]"](col_index),row_index,col_index])}),1)}),2);break;case"upper":$send(this.rows,"each_with_index",[],(function(row,row_index){return null==row&&(row=nil),null==row_index&&(row_index=nil),$send(row_index,"upto",[last],(function(col_index){return null==col_index&&(col_index=nil),Opal.yieldX($yield,[row["$[]"](col_index),row_index,col_index])}),1)}),2);break;default:this.$raise($$("ArgumentError"),"expected "+which.$inspect()+" to be one of :all, :diagonal, :off_diagonal, :lower, :strict_lower, :strict_upper or :upper")}return this}catch($e){if($e===$t_return)return $e.$v;throw $e}}),-1),$const_set($nesting[0],"SELECTORS",$hash2(["all","diagonal","off_diagonal","lower","strict_lower","strict_upper","upper"],{all:!0,diagonal:!0,off_diagonal:!0,lower:!0,strict_lower:!0,strict_upper:!0,upper:!0}).$freeze()),$def(self,"$index",(function $$index($a){try{var $post_args,args,$t_return=$thrower("return"),$yield=$$index.$$p||nil,self=this,which=nil,value=nil;return $$index.$$p=null,$post_args=$slice.call(arguments),$truthy($rb_gt((args=$post_args).$size(),2))&&self.$raise($$("ArgumentError"),"wrong number of arguments("+args.$size()+" for 0-2)"),which=$eqeq(args.$size(),2)||$truthy($$("SELECTORS")["$include?"](args.$last()))?args.$pop():"all",$yield!==nil||$eqeq(args.$size(),1)?($eqeq(args.$size(),1)?(value=args.$first(),$send(self,"each_with_index",[which],(function(e,row_index,col_index){if(null==e&&(e=nil),null==row_index&&(row_index=nil),null==col_index&&(col_index=nil),!$eqeq(e,value))return nil;$t_return.$throw([row_index,col_index])}),{$$arity:3,$$ret:$t_return})):$send(self,"each_with_index",[which],(function(e,row_index,col_index){if(null==e&&(e=nil),null==row_index&&(row_index=nil),null==col_index&&(col_index=nil),!$truthy(Opal.yield1($yield,e)))return nil;$t_return.$throw([row_index,col_index])}),{$$arity:3,$$ret:$t_return}),nil):$send(self,"to_enum",["find_index",which].concat($to_a(args)))}catch($e){if($e===$t_return)return $e.$v;throw $e}}),-1),self.$alias_method("find_index","index"),$def(self,"$minor",(function($a){var param,$b,self=this,row_range=nil,col_range=nil,from_row=nil,to_row=nil,size_row=nil,from_col=nil,to_col=nil,size_col=nil,rows=nil;switch((param=$slice.call(arguments)).$size()){case 2:row_range=null==($b=$to_ary(param))[0]?nil:$b[0],col_range=null==$b[1]?nil:$b[1],from_row=row_range.$first(),$truthy($rb_lt(from_row,0))&&(from_row=$rb_plus(from_row,self.$row_count())),to_row=row_range.$end(),$truthy($rb_lt(to_row,0))&&(to_row=$rb_plus(to_row,self.$row_count())),$truthy(row_range["$exclude_end?"]())||(to_row=$rb_plus(to_row,1)),size_row=$rb_minus(to_row,from_row),from_col=col_range.$first(),$truthy($rb_lt(from_col,0))&&(from_col=$rb_plus(from_col,self.$column_count())),to_col=col_range.$end(),$truthy($rb_lt(to_col,0))&&(to_col=$rb_plus(to_col,self.$column_count())),$truthy(col_range["$exclude_end?"]())||(to_col=$rb_plus(to_col,1)),size_col=$rb_minus(to_col,from_col);break;case 4:if(from_row=null==($b=$to_ary(param))[0]?nil:$b[0],size_row=null==$b[1]?nil:$b[1],from_col=null==$b[2]?nil:$b[2],size_col=null==$b[3]?nil:$b[3],$truthy($rb_lt(size_row,0))||$truthy($rb_lt(size_col,0)))return nil;$truthy($rb_lt(from_row,0))&&(from_row=$rb_plus(from_row,self.$row_count())),$truthy($rb_lt(from_col,0))&&(from_col=$rb_plus(from_col,self.$column_count()));break;default:self.$raise($$("ArgumentError"),param.$inspect())}return $truthy($rb_gt(from_row,self.$row_count()))||$truthy($rb_gt(from_col,self.$column_count()))||$truthy($rb_lt(from_row,0))||$truthy($rb_lt(from_col,0))?nil:(rows=$send(self.rows["$[]"](from_row,size_row),"collect",[],(function(row){return null==row&&(row=nil),row["$[]"](from_col,size_col)}),1),self.$new_matrix(rows,[$rb_minus(self.$column_count(),from_col),size_col].$min()))}),-1),$def(self,"$first_minor",(function(row,column){var arrays=nil;return $truthy(this["$empty?"]())&&this.$raise($$("RuntimeError"),"first_minor of empty matrix is not defined"),$rb_le(0,row)&&$truthy($rb_lt(row,this.$row_count()))||this.$raise($$("ArgumentError"),"invalid row ("+row.$inspect()+" for 0.."+$rb_minus(this.$row_count(),1)+")"),$rb_le(0,column)&&$truthy($rb_lt(column,this.$column_count()))||this.$raise($$("ArgumentError"),"invalid column ("+column.$inspect()+" for 0.."+$rb_minus(this.$column_count(),1)+")"),(arrays=this.$to_a()).$delete_at(row),$send(arrays,"each",[],(function(array){return null==array&&(array=nil),array.$delete_at(column)}),1),this.$new_matrix(arrays,$rb_minus(this.$column_count(),1))}),2),$def(self,"$cofactor",(function(row,column){var det_of_minor;return $truthy(this["$empty?"]())&&this.$raise($$("RuntimeError"),"cofactor of empty matrix is not defined"),$truthy(this["$square?"]())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),det_of_minor=this.$first_minor(row,column).$determinant(),$rb_times(det_of_minor,(-1)["$**"]($rb_plus(row,column)))}),2),$def(self,"$adjugate",(function(){return $truthy(this["$square?"]())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),$send($$("Matrix"),"build",[this.$row_count(),this.$column_count()],(function $$54(row,column){return null==row&&(row=nil),null==column&&(column=nil),(null==$$54.$$s?this:$$54.$$s).$cofactor(column,row)}),{$$arity:2,$$s:this})}),0),$def(self,"$laplace_expansion",(function($kwargs){var row,column,$ret_or_1,num=nil;return $kwargs=$ensure_kwargs($kwargs),null==(row=$kwargs.$$smap.row)&&(row=nil),null==(column=$kwargs.$$smap.column)&&(column=nil),num=$truthy($ret_or_1=row)?$ret_or_1:column,($not(num)||$truthy(row)&&$truthy(column))&&this.$raise($$("ArgumentError"),"exactly one the row or column arguments must be specified"),$truthy(this["$square?"]())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),$truthy(this["$empty?"]())&&this.$raise($$("RuntimeError"),"laplace_expansion of empty matrix is not defined"),$rb_le(0,num)&&$truthy($rb_lt(num,this.$row_count()))||this.$raise($$("ArgumentError"),"invalid num ("+num.$inspect()+" for 0.."+$rb_minus(this.$row_count(),1)+")"),$send(this.$send($truthy(row)?"row":"column",num).$map(),"with_index",[],(function $$55(e,k){return null==e&&(e=nil),null==k&&(k=nil),$rb_times(e,$send(null==$$55.$$s?this:$$55.$$s,"cofactor",$to_a($truthy(row)?[num,k]:[k,num])))}),{$$arity:2,$$s:this}).$inject("+")}),-1),self.$alias_method("cofactor_expansion","laplace_expansion"),$def(self,"$diagonal?",(function(){return $truthy(this["$square?"]())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),$send(this.$each("off_diagonal"),"all?",[],"zero?".$to_proc())}),0),$def(self,"$empty?",(function(){var $ret_or_1;return $truthy($ret_or_1=this.$column_count()["$=="](0))?$ret_or_1:this.$row_count()["$=="](0)}),0),$def(self,"$hermitian?",(function(){return $truthy(this["$square?"]())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),$send(this.$each_with_index("upper"),"all?",[],(function $$59(e,row,col){var self=null==$$59.$$s?this:$$59.$$s;return null==e&&(e=nil),null==row&&(row=nil),null==col&&(col=nil),e["$=="](self.$rows()["$[]"](col)["$[]"](row).$conj())}),{$$arity:3,$$s:this})}),0),$def(self,"$lower_triangular?",(function(){return $send(this.$each("strict_upper"),"all?",[],"zero?".$to_proc())}),0),$def(self,"$normal?",(function(){try{var $t_return=$thrower("return");return $truthy(this["$square?"]())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),$send(this.$rows(),"each_with_index",[],(function $$62(row_i,i){var self=null==$$62.$$s?this:$$62.$$s;return null==row_i&&(row_i=nil),null==i&&(i=nil),$send(self.$rows(),"each_with_index",[],(function $$63(row_j,j){var s=nil;if(null==row_j&&(row_j=nil),null==j&&(j=nil),s=0,$send((null==$$63.$$s?this:$$63.$$s).$rows(),"each_with_index",[],(function(row_k,k){return null==row_k&&(row_k=nil),null==k&&(k=nil),s=$rb_plus(s,$rb_minus($rb_times(row_i["$[]"](k),row_j["$[]"](k).$conj()),$rb_times(row_k["$[]"](i).$conj(),row_k["$[]"](j))))}),2),$eqeq(s,0))return nil;$t_return.$throw(!1)}),{$$arity:2,$$s:self,$$ret:$t_return})}),{$$arity:2,$$s:this}),!0}catch($e){if($e===$t_return)return $e.$v;throw $e}}),0),$def(self,"$orthogonal?",(function(){try{var $t_return=$thrower("return");return $truthy(this["$square?"]())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),$send(this.$rows(),"each_with_index",[],(function $$66(row,i){var self=null==$$66.$$s?this:$$66.$$s;return null==row&&(row=nil),null==i&&(i=nil),$send(self.$column_count(),"times",[],(function $$67(j){var self=null==$$67.$$s?this:$$67.$$s,s=nil;if(null==j&&(j=nil),s=0,$send(self.$row_count(),"times",[],(function $$68(k){var self=null==$$68.$$s?this:$$68.$$s;return null==k&&(k=nil),s=$rb_plus(s,$rb_times(row["$[]"](k),self.$rows()["$[]"](k)["$[]"](j)))}),{$$arity:1,$$s:self}),$eqeq(s,$eqeq(i,j)?1:0))return nil;$t_return.$throw(!1)}),{$$arity:1,$$s:self,$$ret:$t_return})}),{$$arity:2,$$s:this}),!0}catch($e){if($e===$t_return)return $e.$v;throw $e}}),0),$def(self,"$permutation?",(function(){try{var $t_return=$thrower("return"),cols=nil;return $truthy(this["$square?"]())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),cols=$$("Array").$new(this.$column_count()),$send(this.$rows(),"each_with_index",[],(function(row,i){var found=nil;if(null==row&&(row=nil),null==i&&(i=nil),found=!1,$send(row,"each_with_index",[],(function(e,j){var $a;return null==e&&(e=nil),null==j&&(j=nil),$eqeq(e,1)?(($truthy(found)||$truthy(cols["$[]"](j)))&&$t_return.$throw(!1),$send(cols,"[]=",$a=[j,!0]),found=$a[$a.length-1]):$neqeq(e,0)?void $t_return.$throw(!1):nil}),{$$arity:2,$$ret:$t_return}),$truthy(found))return nil;$t_return.$throw(!1)}),{$$arity:2,$$ret:$t_return}),!0}catch($e){if($e===$t_return)return $e.$v;throw $e}}),0),$def(self,"$real?",(function(){return $send(this,"all?",[],"real?".$to_proc())}),0),$def(self,"$regular?",(function(){return this["$singular?"]()["$!"]()}),0),$def(self,"$singular?",(function(){return this.$determinant()["$=="](0)}),0),$def(self,"$square?",(function(){return this.$column_count()["$=="](this.$row_count())}),0),$def(self,"$symmetric?",(function(){try{var $t_return=$thrower("return");return $truthy(this["$square?"]())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),$send(this,"each_with_index",["strict_upper"],(function $$77(e,row,col){if(null==e&&(e=nil),null==row&&(row=nil),null==col&&(col=nil),!$neqeq(e,(null==$$77.$$s?this:$$77.$$s).$rows()["$[]"](col)["$[]"](row)))return nil;$t_return.$throw(!1)}),{$$arity:3,$$s:this,$$ret:$t_return}),!0}catch($e){if($e===$t_return)return $e.$v;throw $e}}),0),$def(self,"$antisymmetric?",(function(){try{var $t_return=$thrower("return");return $truthy(this["$square?"]())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),$send(this,"each_with_index",["upper"],(function $$79(e,row,col){if(null==e&&(e=nil),null==row&&(row=nil),null==col&&(col=nil),$eqeq(e,(null==$$79.$$s?this:$$79.$$s).$rows()["$[]"](col)["$[]"](row)["$-@"]()))return nil;$t_return.$throw(!1)}),{$$arity:3,$$s:this,$$ret:$t_return}),!0}catch($e){if($e===$t_return)return $e.$v;throw $e}}),0),$def(self,"$unitary?",(function(){try{var $t_return=$thrower("return");return $truthy(this["$square?"]())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),$send(this.$rows(),"each_with_index",[],(function $$81(row,i){var self=null==$$81.$$s?this:$$81.$$s;return null==row&&(row=nil),null==i&&(i=nil),$send(self.$column_count(),"times",[],(function $$82(j){var self=null==$$82.$$s?this:$$82.$$s,s=nil;if(null==j&&(j=nil),s=0,$send(self.$row_count(),"times",[],(function $$83(k){var self=null==$$83.$$s?this:$$83.$$s;return null==k&&(k=nil),s=$rb_plus(s,$rb_times(row["$[]"](k).$conj(),self.$rows()["$[]"](k)["$[]"](j)))}),{$$arity:1,$$s:self}),$eqeq(s,$eqeq(i,j)?1:0))return nil;$t_return.$throw(!1)}),{$$arity:1,$$s:self,$$ret:$t_return})}),{$$arity:2,$$s:this}),!0}catch($e){if($e===$t_return)return $e.$v;throw $e}}),0),$def(self,"$upper_triangular?",(function(){return $send(this.$each("strict_lower"),"all?",[],"zero?".$to_proc())}),0),$def(self,"$zero?",(function(){return $send(this,"all?",[],"zero?".$to_proc())}),0),$def(self,"$==",(function(other){return!(!$eqeqeq($$("Matrix"),other)||!$eqeq(this.$column_count(),other.$column_count()))&&this.$rows()["$=="](other.$rows())}),1),$def(self,"$eql?",(function(other){return!(!$eqeqeq($$("Matrix"),other)||!$eqeq(this.$column_count(),other.$column_count()))&&this.$rows()["$eql?"](other.$rows())}),1),$def(self,"$clone",(function(){return this.$new_matrix($send(this.rows,"map",[],"dup".$to_proc()),this.$column_count())}),0),$def(self,"$hash",(function(){return this.rows.$hash()}),0),$def(self,"$*",(function(m){var $ret_or_1,rows=nil;return $eqeqeq($$("Numeric"),$ret_or_1=m)?(rows=$send(this.rows,"collect",[],(function(row){return null==row&&(row=nil),$send(row,"collect",[],(function(e){return null==e&&(e=nil),$rb_times(e,m)}),1)}),1),this.$new_matrix(rows,this.$column_count())):$eqeqeq($$("Vector"),$ret_or_1)?(m=this.$class().$column_vector(m),$rb_times(this,m).$column(0)):$eqeqeq($$("Matrix"),$ret_or_1)?($neqeq(this.$column_count(),m.$row_count())&&$$("Matrix").$Raise($$("ErrDimensionMismatch")),rows=$send($$("Array"),"new",[this.$row_count()],(function $$91(i){var self=null==$$91.$$s?this:$$91.$$s;return null==i&&(i=nil),$send($$("Array"),"new",[m.$column_count()],(function $$92(j){var self=null==$$92.$$s?this:$$92.$$s;return null==j&&(j=nil),$send(Opal.Range.$new(0,self.$column_count(),!0),"inject",[0],(function $$93(vij,k){return null==vij&&(vij=nil),null==k&&(k=nil),$rb_plus(vij,$rb_times((null==$$93.$$s?this:$$93.$$s)["$[]"](i,k),m["$[]"](k,j)))}),{$$arity:2,$$s:self})}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:this}),this.$new_matrix(rows,m.$column_count())):this.$apply_through_coercion(m,"*")}),1),$def(self,"$+",(function(m){var $ret_or_1,rows;if($eqeqeq($$("Numeric"),$ret_or_1=m))$$("Matrix").$Raise($$("ErrOperationNotDefined"),"+",this.$class(),m.$class());else if($eqeqeq($$("Vector"),$ret_or_1))m=this.$class().$column_vector(m);else if(!$eqeqeq($$("Matrix"),$ret_or_1))return this.$apply_through_coercion(m,"+");return $eqeq(this.$row_count(),m.$row_count())&&$eqeq(this.$column_count(),m.$column_count())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),rows=$send($$("Array"),"new",[this.$row_count()],(function $$95(i){var self=null==$$95.$$s?this:$$95.$$s;return null==i&&(i=nil),$send($$("Array"),"new",[self.$column_count()],(function $$96(j){return null==j&&(j=nil),$rb_plus((null==$$96.$$s?this:$$96.$$s)["$[]"](i,j),m["$[]"](i,j))}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:this}),this.$new_matrix(rows,this.$column_count())}),1),$def(self,"$-",(function(m){var $ret_or_1,rows;if($eqeqeq($$("Numeric"),$ret_or_1=m))$$("Matrix").$Raise($$("ErrOperationNotDefined"),"-",this.$class(),m.$class());else if($eqeqeq($$("Vector"),$ret_or_1))m=this.$class().$column_vector(m);else if(!$eqeqeq($$("Matrix"),$ret_or_1))return this.$apply_through_coercion(m,"-");return $eqeq(this.$row_count(),m.$row_count())&&$eqeq(this.$column_count(),m.$column_count())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),rows=$send($$("Array"),"new",[this.$row_count()],(function $$98(i){var self=null==$$98.$$s?this:$$98.$$s;return null==i&&(i=nil),$send($$("Array"),"new",[self.$column_count()],(function $$99(j){return null==j&&(j=nil),$rb_minus((null==$$99.$$s?this:$$99.$$s)["$[]"](i,j),m["$[]"](i,j))}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:this}),this.$new_matrix(rows,this.$column_count())}),1),$def(self,"$/",(function(other){var $ret_or_1,rows=nil;return $eqeqeq($$("Numeric"),$ret_or_1=other)?(rows=$send(this.rows,"collect",[],(function(row){return null==row&&(row=nil),$send(row,"collect",[],(function(e){return null==e&&(e=nil),$rb_divide(e,other)}),1)}),1),this.$new_matrix(rows,this.$column_count())):$eqeqeq($$("Matrix"),$ret_or_1)?$rb_times(this,other.$inverse()):this.$apply_through_coercion(other,"/")}),1),$def(self,"$hadamard_product",(function(m){return $send(this,"combine",[m],(function(a,b){return null==a&&(a=nil),null==b&&(b=nil),$rb_times(a,b)}),2)}),1),self.$alias_method("entrywise_product","hadamard_product"),$def(self,"$inverse",(function(){return $truthy(this["$square?"]())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),this.$class().$I(this.$row_count()).$send("inverse_from",this)}),0),$alias(self,"inv","inverse"),$def(self,"$inverse_from",(function(src){var last,a=nil;return last=$rb_minus(this.$row_count(),1),a=src.$to_a(),$send(0,"upto",[last],(function $$104(k){var $a,$b,self=null==$$104.$$s?this:$$104.$$s,i=nil,akk=nil;return null==self.rows&&(self.rows=nil),null==k&&(k=nil),i=k,akk=a["$[]"](k)["$[]"](k).$abs(),$send($rb_plus(k,1),"upto",[last],(function(j){var v;return null==j&&(j=nil),v=a["$[]"](j)["$[]"](k).$abs(),$truthy($rb_gt(v,akk))?(i=j,akk=v):nil}),1),$eqeq(akk,0)&&$$("Matrix").$Raise($$("ErrNotRegular")),$neqeq(i,k)&&($a=[a["$[]"](k),a["$[]"](i)],$b=[i,$a[0]],$send(a,"[]=",$b),$b[$b.length-1],$b=[k,$a[1]],$send(a,"[]=",$b),$b[$b.length-1],$a=[self.rows["$[]"](k),self.rows["$[]"](i)],$b=[i,$a[0]],$send(self.rows,"[]=",$b),$b[$b.length-1],$b=[k,$a[1]],$send(self.rows,"[]=",$b),$b[$b.length-1]),akk=a["$[]"](k)["$[]"](k),$send(0,"upto",[last],(function $$106(ii){var q,self=null==$$106.$$s?this:$$106.$$s;return null==ii&&(ii=nil),$eqeq(ii,k)?nil:(q=a["$[]"](ii)["$[]"](k).$quo(akk),a["$[]"](ii)["$[]="](k,0),$send($rb_plus(k,1),"upto",[last],(function(j){var $c,$binary_op_recvr_tmp_1=nil;return null==j&&(j=nil),$binary_op_recvr_tmp_1=a["$[]"](ii),$c=[j,$rb_minus($binary_op_recvr_tmp_1["$[]"](j),$rb_times(a["$[]"](k)["$[]"](j),q))],$send($binary_op_recvr_tmp_1,"[]=",$c),$c[$c.length-1]}),1),$send(0,"upto",[last],(function $$108(j){var $c,self=null==$$108.$$s?this:$$108.$$s,$binary_op_recvr_tmp_2=nil;return null==self.rows&&(self.rows=nil),null==j&&(j=nil),$binary_op_recvr_tmp_2=self.rows["$[]"](ii),$c=[j,$rb_minus($binary_op_recvr_tmp_2["$[]"](j),$rb_times(self.rows["$[]"](k)["$[]"](j),q))],$send($binary_op_recvr_tmp_2,"[]=",$c),$c[$c.length-1]}),{$$arity:1,$$s:self}))}),{$$arity:1,$$s:self}),$send($rb_plus(k,1),"upto",[last],(function(j){var $c;return null==j&&(j=nil),$c=[j,a["$[]"](k)["$[]"](j).$quo(akk)],$send(a["$[]"](k),"[]=",$c),$c[$c.length-1]}),1),$send(0,"upto",[last],(function $$110(j){var $c,self=null==$$110.$$s?this:$$110.$$s;return null==self.rows&&(self.rows=nil),null==j&&(j=nil),$c=[j,self.rows["$[]"](k)["$[]"](j).$quo(akk)],$send(self.rows["$[]"](k),"[]=",$c),$c[$c.length-1]}),{$$arity:1,$$s:self})}),{$$arity:1,$$s:this}),this}),1),self.$private("inverse_from"),$def(self,"$**",(function(other){try{var $a,$b,$ret_or_1,$t_return=$thrower("return"),x=nil,z=nil,v=nil,d=nil,v_inv=nil;if($eqeqeq($$("Integer"),$ret_or_1=other)){if(x=this,$truthy($rb_le(other,0))){if(x=this.$inverse(),$eqeq(other,0))return this.$class().$identity(this.$column_count());other=other["$-@"]()}return z=nil,$send(this,"loop",[],(function(){return $eqeq(other["$[]"](0),1)&&(z=$truthy(z)?$rb_times(z,x):x),$truthy((other=other["$>>"](1))["$zero?"]())&&$t_return.$throw(z),x=$rb_times(x,x)}),{$$arity:0,$$ret:$t_return})}return $eqeqeq($$("Numeric"),$ret_or_1)?($b=this.$eigensystem(),v=null==($a=$to_ary($b))[0]?nil:$a[0],d=null==$a[1]?nil:$a[1],v_inv=null==$a[2]?nil:$a[2],$rb_times($rb_times(v,$send(this.$class(),"diagonal",$to_a($send(d.$each("diagonal"),"map",[],(function(e){return null==e&&(e=nil),e["$**"](other)}),1)))),v_inv)):$$("Matrix").$Raise($$("ErrOperationNotDefined"),"**",this.$class(),other.$class())}catch($e){if($e===$t_return)return $e.$v;throw $e}}),1),$def(self,"$+@",$return_self,0),$def(self,"$-@",(function(){return $send(this,"collect",[],(function(e){return null==e&&(e=nil),e["$-@"]()}),1)}),0),$def(self,"$determinant",(function(){var $a,m=nil,m0=nil,m1=nil,m2=nil,m3=nil;switch($truthy(this["$square?"]())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),m=this.rows,this.$row_count()){case 0:return 1;case 1:return m["$[]"](0)["$[]"](0)["$+@"]();case 2:return $rb_minus($rb_times(m["$[]"](0)["$[]"](0)["$+@"](),m["$[]"](1)["$[]"](1)),$rb_times(m["$[]"](0)["$[]"](1),m["$[]"](1)["$[]"](0)));case 3:return m0=null==($a=$to_ary(m))[0]?nil:$a[0],m1=null==$a[1]?nil:$a[1],m2=null==$a[2]?nil:$a[2],$rb_minus($rb_plus($rb_plus($rb_minus($rb_minus($rb_times($rb_times(m0["$[]"](0)["$+@"](),m1["$[]"](1)),m2["$[]"](2)),$rb_times($rb_times(m0["$[]"](0),m1["$[]"](2)),m2["$[]"](1))),$rb_times($rb_times(m0["$[]"](1),m1["$[]"](0)),m2["$[]"](2))),$rb_times($rb_times(m0["$[]"](1),m1["$[]"](2)),m2["$[]"](0))),$rb_times($rb_times(m0["$[]"](2),m1["$[]"](0)),m2["$[]"](1))),$rb_times($rb_times(m0["$[]"](2),m1["$[]"](1)),m2["$[]"](0)));case 4:return m0=null==($a=$to_ary(m))[0]?nil:$a[0],m1=null==$a[1]?nil:$a[1],m2=null==$a[2]?nil:$a[2],m3=null==$a[3]?nil:$a[3],$rb_plus($rb_minus($rb_minus($rb_plus($rb_plus($rb_minus($rb_minus($rb_plus($rb_plus($rb_minus($rb_minus($rb_plus($rb_plus($rb_minus($rb_minus($rb_plus($rb_plus($rb_minus($rb_minus($rb_plus($rb_plus($rb_minus($rb_minus($rb_times($rb_times($rb_times(m0["$[]"](0)["$+@"](),m1["$[]"](1)),m2["$[]"](2)),m3["$[]"](3)),$rb_times($rb_times($rb_times(m0["$[]"](0),m1["$[]"](1)),m2["$[]"](3)),m3["$[]"](2))),$rb_times($rb_times($rb_times(m0["$[]"](0),m1["$[]"](2)),m2["$[]"](1)),m3["$[]"](3))),$rb_times($rb_times($rb_times(m0["$[]"](0),m1["$[]"](2)),m2["$[]"](3)),m3["$[]"](1))),$rb_times($rb_times($rb_times(m0["$[]"](0),m1["$[]"](3)),m2["$[]"](1)),m3["$[]"](2))),$rb_times($rb_times($rb_times(m0["$[]"](0),m1["$[]"](3)),m2["$[]"](2)),m3["$[]"](1))),$rb_times($rb_times($rb_times(m0["$[]"](1),m1["$[]"](0)),m2["$[]"](2)),m3["$[]"](3))),$rb_times($rb_times($rb_times(m0["$[]"](1),m1["$[]"](0)),m2["$[]"](3)),m3["$[]"](2))),$rb_times($rb_times($rb_times(m0["$[]"](1),m1["$[]"](2)),m2["$[]"](0)),m3["$[]"](3))),$rb_times($rb_times($rb_times(m0["$[]"](1),m1["$[]"](2)),m2["$[]"](3)),m3["$[]"](0))),$rb_times($rb_times($rb_times(m0["$[]"](1),m1["$[]"](3)),m2["$[]"](0)),m3["$[]"](2))),$rb_times($rb_times($rb_times(m0["$[]"](1),m1["$[]"](3)),m2["$[]"](2)),m3["$[]"](0))),$rb_times($rb_times($rb_times(m0["$[]"](2),m1["$[]"](0)),m2["$[]"](1)),m3["$[]"](3))),$rb_times($rb_times($rb_times(m0["$[]"](2),m1["$[]"](0)),m2["$[]"](3)),m3["$[]"](1))),$rb_times($rb_times($rb_times(m0["$[]"](2),m1["$[]"](1)),m2["$[]"](0)),m3["$[]"](3))),$rb_times($rb_times($rb_times(m0["$[]"](2),m1["$[]"](1)),m2["$[]"](3)),m3["$[]"](0))),$rb_times($rb_times($rb_times(m0["$[]"](2),m1["$[]"](3)),m2["$[]"](0)),m3["$[]"](1))),$rb_times($rb_times($rb_times(m0["$[]"](2),m1["$[]"](3)),m2["$[]"](1)),m3["$[]"](0))),$rb_times($rb_times($rb_times(m0["$[]"](3),m1["$[]"](0)),m2["$[]"](1)),m3["$[]"](2))),$rb_times($rb_times($rb_times(m0["$[]"](3),m1["$[]"](0)),m2["$[]"](2)),m3["$[]"](1))),$rb_times($rb_times($rb_times(m0["$[]"](3),m1["$[]"](1)),m2["$[]"](0)),m3["$[]"](2))),$rb_times($rb_times($rb_times(m0["$[]"](3),m1["$[]"](1)),m2["$[]"](2)),m3["$[]"](0))),$rb_times($rb_times($rb_times(m0["$[]"](3),m1["$[]"](2)),m2["$[]"](0)),m3["$[]"](1))),$rb_times($rb_times($rb_times(m0["$[]"](3),m1["$[]"](2)),m2["$[]"](1)),m3["$[]"](0)));default:return this.$determinant_bareiss()}}),0),self.$alias_method("det","determinant"),$def(self,"$determinant_bareiss",(function(){try{var size,last,no_pivot,$t_return=$thrower("return"),a=nil,sign=nil,pivot=nil;return size=this.$row_count(),last=$rb_minus(size,1),a=this.$to_a(),no_pivot=$send($$("Proc"),"new",[],(function(){$t_return.$throw(0)}),{$$arity:0,$$ret:$t_return}),sign=1,pivot=1,$send(size,"times",[],(function(k){var $a,$b,previous_pivot,switch$=nil;return null==k&&(k=nil),previous_pivot=pivot,$eqeq(pivot=a["$[]"](k)["$[]"](k),0)&&(switch$=$send(Opal.Range.$new($rb_plus(k,1),size,!0),"find",[no_pivot],(function(row){return null==row&&(row=nil),a["$[]"](row)["$[]"](k)["$!="](0)}),1),$a=[a["$[]"](k),a["$[]"](switch$)],$send(a,"[]=",$b=[switch$,$a[0]]),$b[$b.length-1],$send(a,"[]=",$b=[k,$a[1]]),$b[$b.length-1],pivot=a["$[]"](k)["$[]"](k),sign=sign["$-@"]()),$send($rb_plus(k,1),"upto",[last],(function(i){var ai=nil;return null==i&&(i=nil),ai=a["$[]"](i),$send($rb_plus(k,1),"upto",[last],(function(j){var $c;return null==j&&(j=nil),$c=[j,$rb_divide($rb_minus($rb_times(pivot,ai["$[]"](j)),$rb_times(ai["$[]"](k),a["$[]"](k)["$[]"](j))),previous_pivot)],$send(ai,"[]=",$c),$c[$c.length-1]}),1)}),1)}),1),$rb_times(sign,pivot)}catch($e){if($e===$t_return)return $e.$v;throw $e}}),0),self.$private("determinant_bareiss"),$def(self,"$determinant_e",(function(){return this.$warn("Matrix#determinant_e is deprecated; use #determinant",$hash2(["uplevel"],{uplevel:1})),this.$determinant()}),0),$alias(self,"det_e","determinant_e"),$def(self,"$hstack",(function($a){var matrices,self=this;return matrices=$slice.call(arguments),$send(self.$class(),"hstack",[self].concat($to_a(matrices)))}),-1),$def(self,"$rank",(function(){var last_column,last_row,a=nil,pivot_row=nil,previous_pivot=nil;return a=this.$to_a(),last_column=$rb_minus(this.$column_count(),1),last_row=$rb_minus(this.$row_count(),1),pivot_row=0,previous_pivot=1,$send(0,"upto",[last_column],(function(k){var $a,$b,switch_row,pivot=nil;return null==k&&(k=nil),switch_row=$send(Opal.Range.$new(pivot_row,last_row,!1),"find",[],(function(row){return null==row&&(row=nil),a["$[]"](row)["$[]"](k)["$!="](0)}),1),$truthy(switch_row)?($eqeq(pivot_row,switch_row)||($a=[a["$[]"](pivot_row),a["$[]"](switch_row)],$send(a,"[]=",$b=[switch_row,$a[0]]),$b[$b.length-1],$send(a,"[]=",$b=[pivot_row,$a[1]]),$b[$b.length-1]),pivot=a["$[]"](pivot_row)["$[]"](k),$send($rb_plus(pivot_row,1),"upto",[last_row],(function(i){var ai=nil;return null==i&&(i=nil),ai=a["$[]"](i),$send($rb_plus(k,1),"upto",[last_column],(function(j){var $c;return null==j&&(j=nil),$c=[j,$rb_divide($rb_minus($rb_times(pivot,ai["$[]"](j)),$rb_times(ai["$[]"](k),a["$[]"](pivot_row)["$[]"](j))),previous_pivot)],$send(ai,"[]=",$c),$c[$c.length-1]}),1)}),1),pivot_row=$rb_plus(pivot_row,1),previous_pivot=pivot):nil}),1),pivot_row}),0),$def(self,"$rank_e",(function(){return this.$warn("Matrix#rank_e is deprecated; use #rank",$hash2(["uplevel"],{uplevel:1})),this.$rank()}),0),$def(self,"$round",(function(ndigits){return null==ndigits&&(ndigits=0),$send(this,"map",[],(function(e){return null==e&&(e=nil),e.$round(ndigits)}),1)}),-1),$def(self,"$trace",(function(){return $truthy(this["$square?"]())||$$("Matrix").$Raise($$("ErrDimensionMismatch")),$send(Opal.Range.$new(0,this.$column_count(),!0),"inject",[0],(function $$126(tr,i){var self=null==$$126.$$s?this:$$126.$$s;return null==self.rows&&(self.rows=nil),null==tr&&(tr=nil),null==i&&(i=nil),$rb_plus(tr,self.rows["$[]"](i)["$[]"](i))}),{$$arity:2,$$s:this})}),0),$alias(self,"tr","trace"),$def(self,"$transpose",(function(){return $truthy(this.$row_count()["$zero?"]())?this.$class().$empty(this.$column_count(),0):this.$new_matrix(this.rows.$transpose(),this.$row_count())}),0),$alias(self,"t","transpose"),$def(self,"$vstack",(function($a){var matrices,self=this;return matrices=$slice.call(arguments),$send(self.$class(),"vstack",[self].concat($to_a(matrices)))}),-1),$def(self,"$eigensystem",(function(){return $$("EigenvalueDecomposition").$new(this)}),0),$alias(self,"eigen","eigensystem"),$def(self,"$lup",(function(){return $$("LUPDecomposition").$new(this)}),0),$alias(self,"lup_decomposition","lup"),$def(self,"$conjugate",(function(){return $send(this,"collect",[],"conjugate".$to_proc())}),0),$alias(self,"conj","conjugate"),$def(self,"$imaginary",(function(){return $send(this,"collect",[],"imaginary".$to_proc())}),0),$alias(self,"imag","imaginary"),$def(self,"$real",(function(){return $send(this,"collect",[],"real".$to_proc())}),0),$def(self,"$rect",(function(){return[this.$real(),this.$imag()]}),0),$alias(self,"rectangular","rect"),$def(self,"$coerce",(function(other){return $eqeqeq($$("Numeric"),other)?[$$("Scalar").$new(other),this]:this.$raise($$("TypeError"),this.$class()+" can't be coerced into "+other.$class())}),1),$def(self,"$row_vectors",(function(){return $send($$("Array"),"new",[this.$row_count()],(function $$127(i){return null==i&&(i=nil),(null==$$127.$$s?this:$$127.$$s).$row(i)}),{$$arity:1,$$s:this})}),0),$def(self,"$column_vectors",(function(){return $send($$("Array"),"new",[this.$column_count()],(function $$128(i){return null==i&&(i=nil),(null==$$128.$$s?this:$$128.$$s).$column(i)}),{$$arity:1,$$s:this})}),0),$def(self,"$to_matrix",$return_self,0),$def(self,"$to_a",(function(){return $send(this.rows,"collect",[],"dup".$to_proc())}),0),$def(self,"$elements_to_f",(function(){return this.$warn("Matrix#elements_to_f is deprecated, use map(&:to_f)",$hash2(["uplevel"],{uplevel:1})),$send(this,"map",[],"to_f".$to_proc())}),0),$def(self,"$elements_to_i",(function(){return this.$warn("Matrix#elements_to_i is deprecated, use map(&:to_i)",$hash2(["uplevel"],{uplevel:1})),$send(this,"map",[],"to_i".$to_proc())}),0),$def(self,"$elements_to_r",(function(){return this.$warn("Matrix#elements_to_r is deprecated, use map(&:to_r)",$hash2(["uplevel"],{uplevel:1})),$send(this,"map",[],"to_r".$to_proc())}),0),$def(self,"$to_s",(function(){return $truthy(this["$empty?"]())?this.$class()+".empty("+this.$row_count()+", "+this.$column_count()+")":$rb_plus($rb_plus(this.$class()+"[",$send(this.rows,"collect",[],(function(row){return null==row&&(row=nil),$rb_plus($rb_plus("[",$send(row,"collect",[],(function(e){return null==e&&(e=nil),e.$to_s()}),1).$join(", ")),"]")}),1).$join(", ")),"]")}),0),$def(self,"$inspect",(function(){return $truthy(this["$empty?"]())?this.$class()+".empty("+this.$row_count()+", "+this.$column_count()+")":""+this.$class()+this.rows.$inspect()}),0),function($base,$parent_nesting){var self=$module($base,"ConversionHelper"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);$def(self,"$convert_to_array",(function(obj,copy){var $ret_or_1,converted=nil,e=nil;if(null==copy&&(copy=!1),$eqeqeq($$("Array"),$ret_or_1=obj))return $truthy(copy)?obj.$dup():obj;if($eqeqeq($$("Vector"),$ret_or_1))return obj.$to_a();try{converted=obj.$to_ary()}catch($err){if(!Opal.rescue($err,[$$("Exception")]))throw $err;e=$err;try{this.$raise($$("TypeError"),"can't convert "+obj.$class()+" into an Array ("+e.$message()+")")}finally{Opal.pop_exception()}}return $truthy(converted["$is_a?"]($$("Array")))||this.$raise($$("TypeError"),obj.$class()+"#to_ary should return an Array"),converted}),-2),self.$private("convert_to_array")}($nesting[0],$nesting),self.$extend($$("ConversionHelper")),function($base,$parent_nesting){var self=$module($base,"CoercionHelper"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);$def(self,"$apply_through_coercion",(function(obj,oper){var coercion=nil;try{return coercion=obj.$coerce(this),$truthy(coercion["$is_a?"]($$("Array")))&&$eqeq(coercion.$length(),2)||this.$raise($$("TypeError")),coercion["$[]"](0).$public_send(oper,coercion["$[]"](1))}catch($err){if(!Opal.rescue($err,[$$("StandardError")]))throw $err;try{return this.$raise($$("TypeError"),obj.$inspect()+" can't be coerced into "+this.$class())}finally{Opal.pop_exception()}}}),2),self.$private("apply_through_coercion"),$defs(self,"$coerce_to",(function(obj,cls,meth){var ret=nil,e=nil;if($truthy(obj["$kind_of?"](cls)))return obj;$truthy(obj["$respond_to?"](meth))||this.$raise($$("TypeError"),"Expected a "+cls+" but got a "+obj.$class());try{ret=obj.$__send__(meth)}catch($err){if(!Opal.rescue($err,[$$("Exception")]))throw $err;e=$err;try{this.$raise($$("TypeError"),"Coercion error: "+obj.$inspect()+"."+meth+" => "+cls+" failed:\n("+e.$message()+")")}finally{Opal.pop_exception()}}return $truthy(ret["$kind_of?"](cls))||this.$raise($$("TypeError"),"Coercion error: obj."+meth+" did NOT return a "+cls+" (was "+ret.$class()+")"),ret}),3),$defs(self,"$coerce_to_int",(function(obj){return this.$coerce_to(obj,$$("Integer"),"to_int")}),1),$defs(self,"$coerce_to_matrix",(function(obj){return this.$coerce_to(obj,$$("Matrix"),"to_matrix")}),1)}($nesting[0],$nesting),self.$include($$("CoercionHelper")),function($base,$super,$parent_nesting){var self=$klass($base,$super,"Scalar"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);self.$$prototype.value=nil,self.$include($$("ExceptionForMatrix")),self.$include($$("CoercionHelper")),$def(self,"$initialize",$assign_ivar("value"),0),$def(self,"$+",(function(other){var $ret_or_1;return $eqeqeq($$("Numeric"),$ret_or_1=other)?$$("Scalar").$new($rb_plus(this.value,other)):$eqeqeq($$("Vector"),$ret_or_1)||$eqeqeq($$("Matrix"),$ret_or_1)?$$("Scalar").$Raise($$("ErrOperationNotDefined"),"+",this.value.$class(),other.$class()):this.$apply_through_coercion(other,"+")}),1),$def(self,"$-",(function(other){var $ret_or_1;return $eqeqeq($$("Numeric"),$ret_or_1=other)?$$("Scalar").$new($rb_minus(this.value,other)):$eqeqeq($$("Vector"),$ret_or_1)||$eqeqeq($$("Matrix"),$ret_or_1)?$$("Scalar").$Raise($$("ErrOperationNotDefined"),"-",this.value.$class(),other.$class()):this.$apply_through_coercion(other,"-")}),1),$def(self,"$*",(function(other){var $ret_or_1;return $eqeqeq($$("Numeric"),$ret_or_1=other)?$$("Scalar").$new($rb_times(this.value,other)):$eqeqeq($$("Vector"),$ret_or_1)||$eqeqeq($$("Matrix"),$ret_or_1)?$send(other,"collect",[],(function $$134(e){var self=null==$$134.$$s?this:$$134.$$s;return null==self.value&&(self.value=nil),null==e&&(e=nil),$rb_times(self.value,e)}),{$$arity:1,$$s:this}):this.$apply_through_coercion(other,"*")}),1),$def(self,"$/",(function(other){var $ret_or_1;return $eqeqeq($$("Numeric"),$ret_or_1=other)?$$("Scalar").$new($rb_divide(this.value,other)):$eqeqeq($$("Vector"),$ret_or_1)?$$("Scalar").$Raise($$("ErrOperationNotDefined"),"/",this.value.$class(),other.$class()):$eqeqeq($$("Matrix"),$ret_or_1)?$rb_times(this,other.$inverse()):this.$apply_through_coercion(other,"/")}),1),$def(self,"$**",(function(other){var $ret_or_1;return $eqeqeq($$("Numeric"),$ret_or_1=other)?$$("Scalar").$new(this.value["$**"](other)):$eqeqeq($$("Vector"),$ret_or_1)?$$("Scalar").$Raise($$("ErrOperationNotDefined"),"**",this.value.$class(),other.$class()):$eqeqeq($$("Matrix"),$ret_or_1)?$$("Scalar").$Raise($$("ErrOperationNotImplemented"),"**",this.value.$class(),other.$class()):this.$apply_through_coercion(other,"**")}),1)}($nesting[0],$$("Numeric"),$nesting)}($nesting[0],0,$nesting),function($base,$super,$parent_nesting){var self=$klass($base,null,"Vector"),$nesting=[self].concat($parent_nesting),$$=Opal.$r($nesting);return self.$$prototype.elements=nil,self.$include($$("ExceptionForMatrix")),self.$include($$("Enumerable")),self.$include($$$($$("Matrix"),"CoercionHelper")),self.$extend($$$($$("Matrix"),"ConversionHelper")),self.$private_class_method("new"),self.$attr_reader("elements"),self.$protected("elements"),$defs($$("Vector"),"$[]",(function($a){var array,self=this;return array=$slice.call(arguments),self.$new(self.$convert_to_array(array,!1))}),-1),$defs($$("Vector"),"$elements",(function(array,copy){return null==copy&&(copy=!0),this.$new(this.$convert_to_array(array,copy))}),-2),$defs($$("Vector"),"$basis",(function($kwargs){var size,index,array=nil;return $kwargs=$ensure_kwargs($kwargs),size=$get_kwarg($kwargs,"size"),index=$get_kwarg($kwargs,"index"),$truthy($rb_lt(size,1))&&this.$raise($$("ArgumentError"),"invalid size ("+size+" for 1..)"),$rb_le(0,index)&&$truthy($rb_lt(index,size))||this.$raise($$("ArgumentError"),"invalid index ("+index+" for 0..."+size+")"),(array=$$("Array").$new(size,0))["$[]="](index,1),this.$new(this.$convert_to_array(array,!1))}),1),$defs($$("Vector"),"$zero",(function(size){var array;return $truthy($rb_lt(size,0))&&this.$raise($$("ArgumentError"),"invalid size ("+size+" for 0..)"),array=$$("Array").$new(size,0),this.$new(this.$convert_to_array(array,!1))}),1),$def(self,"$initialize",$assign_ivar("elements"),0),$def(self,"$[]",(function(i){return this.elements["$[]"](i)}),1),$alias(self,"element","[]"),$alias(self,"component","[]"),$def(self,"$[]=",(function(i,v){var $a;return $a=[i,v],$send(this.elements,"[]=",$a),$a[$a.length-1]}),2),$alias(self,"set_element","[]="),$alias(self,"set_component","[]="),self.$private("[]=","set_element","set_component"),$def(self,"$round",(function(ndigits){return null==ndigits&&(ndigits=0),$send(this,"map",[],(function(e){return null==e&&(e=nil),e.$round(ndigits)}),1)}),-1),$def(self,"$size",(function(){return this.elements.$size()}),0),$def(self,"$each",(function $$each(){var block=$$each.$$p||nil;return $$each.$$p=null,block===nil?this.$to_enum("each"):($send(this.elements,"each",[],block.$to_proc()),this)}),0),$def(self,"$each2",(function $$each2(v){var $yield=$$each2.$$p||nil;return $$each2.$$p=null,$truthy(v["$kind_of?"]($$("Integer")))&&this.$raise($$("TypeError"),"Integer is not like Vector"),$neqeq(this.$size(),v.$size())&&$$("Vector").$Raise($$("ErrDimensionMismatch")),$yield===nil?this.$to_enum("each2",v):($send(this.$size(),"times",[],(function $$141(i){var self=null==$$141.$$s?this:$$141.$$s;return null==self.elements&&(self.elements=nil),null==i&&(i=nil),Opal.yieldX($yield,[self.elements["$[]"](i),v["$[]"](i)])}),{$$arity:1,$$s:this}),this)}),1),$def(self,"$collect2",(function $$collect2(v){var $yield=$$collect2.$$p||nil;return $$collect2.$$p=null,$truthy(v["$kind_of?"]($$("Integer")))&&this.$raise($$("TypeError"),"Integer is not like Vector"),$neqeq(this.$size(),v.$size())&&$$("Vector").$Raise($$("ErrDimensionMismatch")),$yield===nil?this.$to_enum("collect2",v):$send($$("Array"),"new",[this.$size()],(function $$142(i){var self=null==$$142.$$s?this:$$142.$$s;return null==self.elements&&(self.elements=nil),null==i&&(i=nil),Opal.yieldX($yield,[self.elements["$[]"](i),v["$[]"](i)])}),{$$arity:1,$$s:this})}),1),$defs($$("Vector"),"$independent?",(function($a){var $post_args,vs,self=this;return $post_args=$slice.call(arguments),$send(vs=$post_args,"each",[],(function $$144(v){var self=null==$$144.$$s?this:$$144.$$s;return null==v&&(v=nil),$truthy(v["$is_a?"]($$("Vector")))||self.$raise($$("TypeError"),"expected Vector, got "+v.$class()),$eqeq(v.$size(),vs.$first().$size())?nil:$$("Vector").$Raise($$("ErrDimensionMismatch"))}),{$$arity:1,$$s:self}),!$truthy($rb_gt(vs.$count(),vs.$first().$size()))&&$send($$("Matrix"),"[]",$to_a(vs)).$rank()["$eql?"](vs.$count())}),-1),$def(self,"$independent?",(function($a){var vs,self=this;return vs=$slice.call(arguments),$send(self.$class(),"independent?",[self].concat($to_a(vs)))}),-1),$def(self,"$zero?",(function(){return $send(this,"all?",[],"zero?".$to_proc())}),0),$def(self,"$==",(function(other){return!!$eqeqeq($$("Vector"),other)&&this.elements["$=="](other.$elements())}),1),$def(self,"$eql?",(function(other){return!!$eqeqeq($$("Vector"),other)&&this.elements["$eql?"](other.$elements())}),1),$def(self,"$clone",(function(){return this.$class().$elements(this.elements)}),0),$def(self,"$hash",(function(){return this.elements.$hash()}),0),$def(self,"$*",(function(x){var $ret_or_1,els=nil;return $eqeqeq($$("Numeric"),$ret_or_1=x)?(els=$send(this.elements,"collect",[],(function(e){return null==e&&(e=nil),$rb_times(e,x)}),1),this.$class().$elements(els,!1)):$eqeqeq($$("Matrix"),$ret_or_1)?$rb_times($$("Matrix").$column_vector(this),x):$eqeqeq($$("Vector"),$ret_or_1)?$$("Vector").$Raise($$("ErrOperationNotDefined"),"*",this.$class(),x.$class()):this.$apply_through_coercion(x,"*")}),1),$def(self,"$+",(function(v){var $ret_or_1,els=nil;return $eqeqeq($$("Vector"),$ret_or_1=v)?($neqeq(this.$size(),v.$size())&&$$("Vector").$Raise($$("ErrDimensionMismatch")),els=$send(this,"collect2",[v],(function(v1,v2){return null==v1&&(v1=nil),null==v2&&(v2=nil),$rb_plus(v1,v2)}),2),this.$class().$elements(els,!1)):$eqeqeq($$("Matrix"),$ret_or_1)?$rb_plus($$("Matrix").$column_vector(this),v):this.$apply_through_coercion(v,"+")}),1),$def(self,"$-",(function(v){var $ret_or_1,els=nil;return $eqeqeq($$("Vector"),$ret_or_1=v)?($neqeq(this.$size(),v.$size())&&$$("Vector").$Raise($$("ErrDimensionMismatch")),els=$send(this,"collect2",[v],(function(v1,v2){return null==v1&&(v1=nil),null==v2&&(v2=nil),$rb_minus(v1,v2)}),2),this.$class().$elements(els,!1)):$eqeqeq($$("Matrix"),$ret_or_1)?$rb_minus($$("Matrix").$column_vector(this),v):this.$apply_through_coercion(v,"-")}),1),$def(self,"$/",(function(x){var $ret_or_1,els=nil;return $eqeqeq($$("Numeric"),$ret_or_1=x)?(els=$send(this.elements,"collect",[],(function(e){return null==e&&(e=nil),$rb_divide(e,x)}),1),this.$class().$elements(els,!1)):$eqeqeq($$("Matrix"),$ret_or_1)||$eqeqeq($$("Vector"),$ret_or_1)?$$("Vector").$Raise($$("ErrOperationNotDefined"),"/",this.$class(),x.$class()):this.$apply_through_coercion(x,"/")}),1),$def(self,"$+@",$return_self,0),$def(self,"$-@",(function(){return $send(this,"collect",[],(function(e){return null==e&&(e=nil),e["$-@"]()}),1)}),0),$def(self,"$inner_product",(function(v){var p=nil;return $neqeq(this.$size(),v.$size())&&$$("Vector").$Raise($$("ErrDimensionMismatch")),p=0,$send(this,"each2",[v],(function(v1,v2){return null==v1&&(v1=nil),null==v2&&(v2=nil),p=$rb_plus(p,$rb_times(v1,v2.$conj()))}),2),p}),1),self.$alias_method("dot","inner_product"),$def(self,"$cross_product",(function($a){var vs,self=this,v=nil,rows=nil;switch(vs=$slice.call(arguments),$truthy($rb_ge(self.$size(),2))||self.$raise($$("ErrOperationNotDefined"),"cross product is not defined on vectors of dimension "+self.$size()),$eqeq(vs.$size(),$rb_minus(self.$size(),2))||self.$raise($$("ArgumentError"),"wrong number of arguments ("+vs.$size()+" for "+$rb_minus(self.$size(),2)+")"),$send(vs,"each",[],(function $$160(v){var self=null==$$160.$$s?this:$$160.$$s;return null==v&&(v=nil),$truthy(v["$is_a?"]($$("Vector")))||self.$raise($$("TypeError"),"expected Vector, got "+v.$class()),$eqeq(v.$size(),self.$size())?nil:$$("Vector").$Raise($$("ErrDimensionMismatch"))}),{$$arity:1,$$s:self}),self.$size()){case 2:return $$("Vector")["$[]"](self.elements["$[]"](1)["$-@"](),self.elements["$[]"](0));case 3:return v=vs["$[]"](0),$$("Vector")["$[]"]($rb_minus($rb_times(v["$[]"](2),self.elements["$[]"](1)),$rb_times(v["$[]"](1),self.elements["$[]"](2))),$rb_minus($rb_times(v["$[]"](0),self.elements["$[]"](2)),$rb_times(v["$[]"](2),self.elements["$[]"](0))),$rb_minus($rb_times(v["$[]"](1),self.elements["$[]"](0)),$rb_times(v["$[]"](0),self.elements["$[]"](1))));default:return rows=[self].concat($to_a(vs)).concat([$send($$("Array"),"new",[self.$size()],(function $$161(i){var self=null==$$161.$$s?this:$$161.$$s;return null==i&&(i=nil),$$("Vector").$basis($hash2(["size","index"],{size:self.$size(),index:i}))}),{$$arity:1,$$s:self})]),$$("Matrix").$rows(rows).$laplace_expansion($hash2(["row"],{row:$rb_minus(self.$size(),1)}))}}),-1),self.$alias_method("cross","cross_product"),$def(self,"$collect",(function $$collect(){var els,block=$$collect.$$p||nil;return $$collect.$$p=null,block===nil?this.$to_enum("collect"):(els=$send(this.elements,"collect",[],block.$to_proc()),this.$class().$elements(els,!1))}),0),$alias(self,"map","collect"),$def(self,"$magnitude",(function(){return $$("Math").$sqrt($send(this.elements,"inject",[0],(function(v,e){return null==v&&(v=nil),null==e&&(e=nil),$rb_plus(v,e.$abs2())}),2))}),0),$alias(self,"r","magnitude"),$alias(self,"norm","magnitude"),$def(self,"$map2",(function $$map2(v){var els,block=$$map2.$$p||nil;return $$map2.$$p=null,block===nil?this.$to_enum("map2",v):(els=$send(this,"collect2",[v],block.$to_proc()),this.$class().$elements(els,!1))}),1),$klass($nesting[0],$$("StandardError"),"ZeroVectorError"),$def(self,"$normalize",(function(){var n;return n=this.$magnitude(),$eqeq(n,0)&&this.$raise($$("ZeroVectorError"),"Zero vectors can not be normalized"),$rb_divide(this,n)}),0),$def(self,"$angle_with",(function(v){var prod;return $truthy(v["$is_a?"]($$("Vector")))||this.$raise($$("TypeError"),"Expected a Vector, got a "+v.$class()),$neqeq(this.$size(),v.$size())&&$$("Vector").$Raise($$("ErrDimensionMismatch")),prod=$rb_times(this.$magnitude(),v.$magnitude()),$eqeq(prod,0)&&this.$raise($$("ZeroVectorError"),"Can't get angle of zero vector"),$$("Math").$acos($rb_divide(this.$inner_product(v),prod))}),1),$def(self,"$covector",(function(){return $$("Matrix").$row_vector(this)}),0),$def(self,"$to_a",(function(){return this.elements.$dup()}),0),$def(self,"$to_matrix",(function(){return $$("Matrix").$column_vector(this)}),0),$def(self,"$elements_to_f",(function(){return this.$warn("Vector#elements_to_f is deprecated",$hash2(["uplevel"],{uplevel:1})),$send(this,"map",[],"to_f".$to_proc())}),0),$def(self,"$elements_to_i",(function(){return this.$warn("Vector#elements_to_i is deprecated",$hash2(["uplevel"],{uplevel:1})),$send(this,"map",[],"to_i".$to_proc())}),0),$def(self,"$elements_to_r",(function(){return this.$warn("Vector#elements_to_r is deprecated",$hash2(["uplevel"],{uplevel:1})),$send(this,"map",[],"to_r".$to_proc())}),0),$def(self,"$coerce",(function(other){return $eqeqeq($$("Numeric"),other)?[$$$($$("Matrix"),"Scalar").$new(other),this]:this.$raise($$("TypeError"),this.$class()+" can't be coerced into "+other.$class())}),1),$def(self,"$to_s",(function(){return $rb_plus($rb_plus("Vector[",this.elements.$join(", ")),"]")}),0),$def(self,"$inspect",(function(){return $rb_plus("Vector",this.elements.$inspect())}),0)}($nesting[0],0,$nesting)}));
